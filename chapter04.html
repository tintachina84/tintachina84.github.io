<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2024-06-20T15:24:51.171876"><title>Chapter 4 - 비즈니스 로직 구현 | Infosiatec Workshop</title><script type="application/json" id="virtual-toc-data">[{"id":"4-1","level":0,"title":"4.1 서비스 디자인 개요","anchor":"#4-1"},{"id":"4-2","level":0,"title":"4.2 저장소 컴포넌트 추가","anchor":"#4-2"},{"id":"service_1","level":0,"title":"4.3 Service 컴포넌트 추가","anchor":"#service_1"},{"id":"4-4-hypermedia","level":0,"title":"4.4 Hypermedia 구현","anchor":"#4-4-hypermedia"},{"id":"4-5-hateoas-service-controller","level":0,"title":"4.5 HATEOAS와 Service를 통한 Controller 강화","anchor":"#4-5-hateoas-service-controller"},{"id":"4-6-api-etag","level":0,"title":"4.6 API에 ETag 추가하기 (필수 아님)","anchor":"#4-6-api-etag"},{"id":"4-7-api","level":0,"title":"4.7 API 테스트하기","anchor":"#4-7-api"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b267/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Chapter 4 - 비즈니스 로직 구현 | Infosiatec Workshop"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Infosiatec Workshop Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/chapter04.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Chapter 4 - 비즈니스 로직 구현 | Infosiatec Workshop"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/chapter04.html#webpage",
    "url": "writerside-documentation/chapter04.html",
    "name": "Chapter 4 - 비즈니스 로직 구현 | Infosiatec Workshop",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Infosiatec Workshop Help"
}</script><!-- End Schema.org --></head><body data-id="Chapter04" data-main-title="Chapter 4 - 비즈니스 로직 구현" data-article-props="{&quot;seeAlso&quot;:[{&quot;title&quot;:&quot;참고문헌&quot;,&quot;links&quot;:[{&quot;url&quot;:&quot;https://docs.spring.io/spring-hateoas/docs/current/reference/html/&quot;,&quot;text&quot;:&quot;Spring HATEOAS&quot;},{&quot;url&quot;:&quot;https://tools.ietf.org/html/rfc8288&quot;,&quot;text&quot;:&quot;RFC-8288 Web Linking&quot;}]}],&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs=""><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Infosiatec Workshop  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Chapter04" id="Chapter04.md">Chapter 4 - 비즈니스 로직 구현</h1><p id="-c0nkc2_292">이전 장에서 OpenAPI를 사용하여 API 사양을 정의했습니다. API Java 인터페이스 및 모델은 OpenAPI(Swagger Codegen)에 의해 생성되었습니다. 이 장에서는 비즈니스 로직과 데이터 지속성 측면에서 API 코드를 구현할 것입니다. 여기서 비즈니스 로직은 도메인 기능을 위해 작성하는 실제 코드를 의미하며, 우리의 경우에는 전자 상거래를 위해 수행되는 작업인 쇼핑 카트 체크아웃과 같은 작업을 포함합니다.</p><p id="-c0nkc2_293">구현을 위해 서비스 및 리포지토리를 작성하고 API 응답에 하이퍼미디어 및 엔티티 태그(ETags)를 추가할 것입니다. 애플리케이션 상태의 엔진으로서의 하이퍼미디어(HATEOAS)는 Spring과 Hypertext Application Language (HAL)을 사용하여 구현될 것입니다. HAL은 HATEOAS를 구현하기 위한 표준 중 하나입니다.</p><p id="-c0nkc2_294">이 장은 다음 주제를 다룹니다.</p><ul class="list _bullet" id="-c0nkc2_295"><li class="list__item" id="-c0nkc2_296"><p>서비스 디자인 개요</p></li><li class="list__item" id="-c0nkc2_297"><p>저장소 컴포넌트 추가</p></li><li class="list__item" id="-c0nkc2_298"><p>서비스 컴포넌트 추가</p></li><li class="list__item" id="-c0nkc2_299"><p>하이퍼미디어 구현</p></li><li class="list__item" id="-c0nkc2_300"><p>서비스와 HATEOAS를 이용하여 컨트롤러 강화</p></li><li class="list__item" id="-c0nkc2_301"><p>API 응답에 ETags 추가</p></li><li class="list__item" id="-c0nkc2_302"><p>API 테스트</p></li></ul><aside class="prompt" data-type="note" data-title="" id="-c0nkc2_303"><p>이 장에서는 API 테스트를 위해 Postman을 사용할 것입니다. Postman은 API를 테스트하고 문서화하는 데 사용되는 인기 있는 도구입니다.</p></aside><section class="chapter"><h2 id="4-1" data-toc="4-1">4.1 서비스 디자인 개요</h2><p id="-c0nkc2_304">우리는 프레젠테이션 레이어, 애플리케이션 레이어, 도메인 레이어 및 인프라스트럭처 레이어로 구성된 다층 아키텍처를 구현할 예정입니다. 다층 아키텍처는 도메인 주도 설계(Domain-Driven Design, DDD)라는 아키텍처 스타일에서의 기본 구성 요소입니다. 각 레이어를 간단히 살펴보겠습니다.</p><ul class="list _bullet" id="-c0nkc2_305"><li class="list__item" id="-c0nkc2_306"><p>프레젠테이션 레이어: 이 레이어는 사용자 인터페이스(UI)를 나타냅니다. 7장에서는 샘플 전자상거래 앱의 UI를 개발할 것입니다.</p></li><li class="list__item" id="-c0nkc2_307"><p>어플리케이션 레이어: 어플리케이션 레이어에는 프로그램 로직이 포함되어 있으며 어플리케이션의 전체 흐름을 유지하고 조정합니다. 이 계층에는 어플리케이션 프로그램 로직만 포함되어 있으며 비즈니스 로직은 포함되어 있지 않습니다. RESTful 웹 서비스, 비동기 API, gRPC API 및 GraphQL API가 이 계층의 일부입니다.</p></li></ul><p id="-c0nkc2_308">우리는 이미 응용 프로그램 계층의 일부인 제 3장 API 사양 및 구현에서 REST API 및 컨트롤러를 다루었습니다. 이전 장에서는 데모 목적으로 컨트롤러를 구현했습니다. 이번 장에서는 실제 데이터를 제공하기 위해 컨트롤러를 철저히 구현할 것입니다.</p><ul class="list _bullet" id="-c0nkc2_309"><li class="list__item" id="-c0nkc2_310"><p>도메인 레이어: 이 레이어에는 비즈니스 로직과 도메인 정보가 포함되어 있습니다. 주문이나 제품과 같은 비즈니스 객체의 상태를 포함하고 있으며 이러한 객체를 인프라스트럭쳐 레이어에서 읽거나 저장하는 역할을 합니다. 도메인 레이어에는 서비스와 리포지토리도 포함되어 있습니다.</p></li><li class="list__item" id="-c0nkc2_311"><p>인프라스트럭처 레이어: 인프라스트럭처 레이어는 모든 다른 레이어에 지원을 제공합니다. 데이터베이스, 메시지 브로커, 파일 시스템과의 상호 작용과 같은 통신을 담당합니다. Spring Boot는 인프라스트럭처 레이어로 작동하며 데이터베이스와 메시지 브로커와 같은 외부 및 내부 시스템과의 통신 및 상호 작용을 지원합니다.</p></li></ul><p id="-c0nkc2_312">하단에서 상단으로 접근하는 방식으로 갈겁니다. 예를 들어, @Repository -&gt; @Service -&gt; @Controller -&gt; React UI 개발 순이라 생각하면 편합니다.</p></section><section class="chapter"><h2 id="4-2" data-toc="4-2">4.2 저장소 컴포넌트 추가</h2><p id="-c0nkc2_313">@Repository 컴포넌트를 추가하기 위해 아래에서 위로 접근 방식을 사용할 것입니다. @Repository 컴포넌트를 구현하는 것부터 시작해봅시다. 이후 섹션에서 서비스를 구현하고 @Controller 컴포넌트를 적절히 개선할 것입니다. 먼저 @Repository 컴포넌트를 코딩한 다음, 생성자 주입을 사용하여 @Service 컴포넌트에서 사용할 것입니다.</p><section class="chapter"><h3 id="repository" data-toc="repository">@Repository 애너테이션</h3><p id="-c0nkc2_314">리포지토리 컴포넌트는 @Repository 주석이 표시된 Java 클래스입니다. 이는 데이터베이스와 상호 작용하기 위해 사용되는 특별한 스프링 컴포넌트입니다.</p><ul class="list _bullet" id="-c0nkc2_315"><li class="list__item" id="-c0nkc2_316"><p>H2 데이터베이스: 우리는 H2의 메모리 인스턴스를 사용할 예정이지만, 파일 기반 인스턴스도 사용하려 할 수 있습니다.</p></li><li class="list__item" id="-c0nkc2_317"><p>Hibernate (ORM): Hibernate는 JPA 구현체로, 데이터베이스와 상호 작용하기 위해 사용됩니다.</p></li><li class="list__item" id="-c0nkc2_318"><p>Flyway: 데이터베이스 마이그레이션 툴. 데이터베이스를 유지하고 롤백, 버전 업그레이드 등 데이터베이스 변경 이력을 유지하는 데 도움이 됩니다.</p></li></ul><p id="-c0nkc2_319">build.gradle 파일에 아래 의존성을 추가합니다.</p><div class="code-block" data-lang="gradle">
implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
implementation 'org.flywaydb:flyway-core'
runtimeOnly 'com.h2database:h2'
</div></section><section class="chapter"><h3 id="jpa" data-toc="jpa">데이터베이스와 JPA 구성</h3><p id="-c0nkc2_321">application.properties에 이하의 설정을 추가합니다.</p><div class="code-block" data-lang="none">
spring.datasource.name=ecomm
spring.datasource.url=jdbc:h2:mem:ecomm;DB_CLOSE_DELAY=-1;IGNORECASE=TRUE;DATABASE_TO_UPPER=false
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=
</div><p id="-c0nkc2_323">데이터소스에 H2 데이터베이스를 특정할 수 있도록 설정을 추가합니다. H2 콘솔은 H2 웹 클라이언트로 H2에서 테이블 조회, 쿼리 실행과 같은 다양한 작업을 할 수 있도록 도와줍니다. 원격 액세스 기능은 비활성 합니다.</p><div class="code-block" data-lang="none">
spring.h2.console.enabled=true
spring.h2.console.settings.web-allow-others=false
</div><p id="-c0nkc2_325">Flyway를 사용하여 데이터 마이그레이션을 관리할 예정이기 때문에 generate-ddl와 ddl-auto 옵션을 비활성화합니다.</p><div class="code-block" data-lang="none">
spring.jpa.properties.hibernate.default_schema=ecomm
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
spring.jpa.show-sql=true
spring.jpa.format_sql=true
spring.jpa.generate-ddl=false
spring.jpa.hibernate.ddl-auto=none
</div><p id="-c0nkc2_327">Flyway 옵션을 데이터베이스 설정에 맞춥니다.</p><div class="code-block" data-lang="none">
spring.flyway.url=jdbc:h2:mem:ecomm
spring.flyway.schemas=ecomm
spring.flyway.user=sa
spring.flyway.password=
</div><p id="-c0nkc2_329">스프링 어플리케이션을 실행하면 H2 데이터베이스 또한 실행됩니다. H2 콘솔은 http://localhost:8080/h2-console 에서 접근할 수 있습니다.</p></section><section class="chapter"><h3 id="-c0nkc2_330" data-toc="-c0nkc2_330">데이터베이스 및 초기 데이터 스크립트 생성</h3><p id="-c0nkc2_331">Flyway를 통한 데이터베이스 초기화 스크립트를 생성합니다. src/main/resources/db/migration 디렉토리를 생성하고 Flyway의 네이밍 컨벤션에 따라 V.  .sql 규칙을 지키는 파일을 생성합니다. 우리는 V1.0.0__init.sql 파일을 생성할 것입니다.</p><p id="-c0nkc2_334">이하의 SQL 스크립트를 추가합니다. e-commerce 애플리케이션을 위한 테이블을 생성하고 초기 데이터를 삽입합니다.</p><div class="code-collapse" data-lang="sql" data-is-expanded="false" data-synopsis="create schema if not exists ecomm;">

create schema if not exists ecomm;

create TABLE IF NOT EXISTS ecomm.product (
    id uuid NOT NULL DEFAULT random_uuid(),
    name varchar(56) NOT NULL,
    description varchar(200),
    price numeric(16, 4) DEFAULT 0 NOT NULL,
    count numeric(8, 0),
    image_url varchar(40),
    PRIMARY KEY(id)
);

create TABLE IF NOT EXISTS ecomm.tag (
    id uuid NOT NULL DEFAULT random_uuid(),
    name varchar(20),
    PRIMARY KEY(id)
);

create TABLE IF NOT EXISTS ecomm.product_tag (
    product_id uuid NOT NULL DEFAULT random_uuid(),
    tag_id uuid NOT NULL,
    FOREIGN KEY (product_id)
        REFERENCES product(id),
    FOREIGN KEY(tag_id)
        REFERENCES tag(id)
);

insert into ecomm.product values ('6d62d909-f957-430e-8689-b5129c0bb75e', 'Antifragile', 'Antifragile - Things that gains from disorder. By Nassim Nicholas Taleb', 17.15, 33, '/images/Antifragile.jpg');
insert into ecomm.product values ('a0a4f044-b040-410d-8ead-4de0446aec7e', 'Sapiens', 'Sapiens - A brief history of mankind. By Yuval Noah Harari', 7.99, 115, '/images/Sapiens.jpeg');
insert into ecomm.product values ('808a2de1-1aaa-4c25-a9b9-6612e8f29a38', 'Thinking Fast and Slow', 'Thinking Fast and Slow. By winner of Nobel Prize - Danniel Kahneman', 17.32, 738, '/images/ThinkingFast.jpeg');
insert into ecomm.product values ('510a0d7e-8e83-4193-b483-e27e09ddc34d', 'How to Fail at Almost Everything and Still Win Big', 'How to Fail at Almost Everything and Still Win Big - Kind of Story of My Life. By Scott Adams', 15.00, 820, '/images/HowToFail.jpeg');
insert into ecomm.product values ('03fef6ac-1896-4ce8-bd69-b798f85c6e0b', 'Influence', 'Influence - Psychology of Persuasion. By Robert B. Cialdini Ph.D.', 99.99, 1, '/images/Influence.jpeg');
insert into ecomm.product values ('d3588630-ad8e-49df-bbd7-3167f7efb246', 'Poor Charlie''s Almanack', 'Poor Charlie''s Almanack - Wits and Wisdom of Charles T. Munger. By Peter Kauffman', 10.99, 801, '/images/PoorCharlie.jpeg');
insert into ecomm.product values ('819e1fbf-8b7e-4f6d-811f-693534916a8b', 'Hackers &amp; Painters', 'Hackers &amp; Painters - Big Ideas from Computer Age. By Paul Graham', 14, 808, '/images/Hackers.jpg');
insert into ecomm.product values ('3395a42e-2d88-40de-b95f-e00e1502085b', 'Seeking Wisdom', 'Seeking Wisdom - From Darwin To Mungar. By Peter Bevelin',  12, 127, '/images/Seeking.jpg');
insert into ecomm.product values ('3395a43e-2d88-40de-b95f-e00e1502085b', 'Thinking In Bets', 'Thinking In Bets - Making Smarter Decision. When you don''t have all the facts. By Annie Duke', 18, 438, '/images/ThinkingIn.jpg');
insert into ecomm.product values ('837ab141-399e-4c1f-9abc-bace40296bac', 'Zero to One', 'Zero to One - Notes on Startups, Or How to build future. Peter Theil', 15, 175, '/images/ZeroToOne.jpg');

insert into ecomm.tag (id, name) values ('00000000-b5c6-4896-987c-f30f3678f601', 'book');
insert into ecomm.tag (id, name) values ('00000000-b5c6-4896-987c-f30f3678f602', 'psychology');
insert into ecomm.tag (id, name) values ('00000000-b5c6-4896-987c-f30f3678f603', 'influence');
insert into ecomm.tag (id, name) values ('00000000-b5c6-4896-987c-f30f3678f604', 'wisdom');
insert into ecomm.tag (id, name) values ('00000000-b5c6-4896-987c-f30f3678f605', 'startup');
insert into ecomm.tag (id, name) values ('00000000-b5c6-4896-987c-f30f3678f606', 'investing');
insert into ecomm.tag (id, name) values ('00000000-b5c6-4896-987c-f30f3678f607', 'lessions');
insert into ecomm.tag (id, name) values ('00000000-b5c6-4896-987c-f30f3678f608', 'history');
insert into ecomm.tag (id, name) values ('00000000-b5c6-4896-987c-f30f3678f609', 'howto');
insert into ecomm.tag (id, name) values ('00000000-b5c6-4896-987c-f30f3678f610', 'journey');
insert into ecomm.tag (id, name) values ('00000000-b5c6-4896-987c-f30f3678f611', 'decision');

insert into ecomm.product_tag values ('6d62d909-f957-430e-8689-b5129c0bb75e', '00000000-b5c6-4896-987c-f30f3678f602');
insert into ecomm.product_tag values ('6d62d909-f957-430e-8689-b5129c0bb75e', '00000000-b5c6-4896-987c-f30f3678f601');
insert into ecomm.product_tag values ('a0a4f044-b040-410d-8ead-4de0446aec7e', '00000000-b5c6-4896-987c-f30f3678f608');
insert into ecomm.product_tag values ('a0a4f044-b040-410d-8ead-4de0446aec7e', '00000000-b5c6-4896-987c-f30f3678f601');
insert into ecomm.product_tag values ('808a2de1-1aaa-4c25-a9b9-6612e8f29a38', '00000000-b5c6-4896-987c-f30f3678f602');
insert into ecomm.product_tag values ('808a2de1-1aaa-4c25-a9b9-6612e8f29a38', '00000000-b5c6-4896-987c-f30f3678f601');
insert into ecomm.product_tag values ('808a2de1-1aaa-4c25-a9b9-6612e8f29a38', '00000000-b5c6-4896-987c-f30f3678f607');
insert into ecomm.product_tag values ('808a2de1-1aaa-4c25-a9b9-6612e8f29a38', '00000000-b5c6-4896-987c-f30f3678f611');
insert into ecomm.product_tag values ('510a0d7e-8e83-4193-b483-e27e09ddc34d', '00000000-b5c6-4896-987c-f30f3678f602');
insert into ecomm.product_tag values ('510a0d7e-8e83-4193-b483-e27e09ddc34d', '00000000-b5c6-4896-987c-f30f3678f601');
insert into ecomm.product_tag values ('510a0d7e-8e83-4193-b483-e27e09ddc34d', '00000000-b5c6-4896-987c-f30f3678f610');
insert into ecomm.product_tag values ('03fef6ac-1896-4ce8-bd69-b798f85c6e0b', '00000000-b5c6-4896-987c-f30f3678f602');
insert into ecomm.product_tag values ('03fef6ac-1896-4ce8-bd69-b798f85c6e0b', '00000000-b5c6-4896-987c-f30f3678f603');
insert into ecomm.product_tag values ('d3588630-ad8e-49df-bbd7-3167f7efb246', '00000000-b5c6-4896-987c-f30f3678f604');
insert into ecomm.product_tag values ('d3588630-ad8e-49df-bbd7-3167f7efb246', '00000000-b5c6-4896-987c-f30f3678f607');
insert into ecomm.product_tag values ('819e1fbf-8b7e-4f6d-811f-693534916a8b', '00000000-b5c6-4896-987c-f30f3678f605');
insert into ecomm.product_tag values ('819e1fbf-8b7e-4f6d-811f-693534916a8b', '00000000-b5c6-4896-987c-f30f3678f606');
insert into ecomm.product_tag values ('819e1fbf-8b7e-4f6d-811f-693534916a8b', '00000000-b5c6-4896-987c-f30f3678f607');
insert into ecomm.product_tag values ('3395a42e-2d88-40de-b95f-e00e1502085b', '00000000-b5c6-4896-987c-f30f3678f604');
insert into ecomm.product_tag values ('3395a42e-2d88-40de-b95f-e00e1502085b', '00000000-b5c6-4896-987c-f30f3678f607');
insert into ecomm.product_tag values ('3395a43e-2d88-40de-b95f-e00e1502085b', '00000000-b5c6-4896-987c-f30f3678f611');
insert into ecomm.product_tag values ('3395a43e-2d88-40de-b95f-e00e1502085b', '00000000-b5c6-4896-987c-f30f3678f609');
insert into ecomm.product_tag values ('837ab141-399e-4c1f-9abc-bace40296bac', '00000000-b5c6-4896-987c-f30f3678f609');
insert into ecomm.product_tag values ('837ab141-399e-4c1f-9abc-bace40296bac', '00000000-b5c6-4896-987c-f30f3678f605');
insert into ecomm.product_tag values ('837ab141-399e-4c1f-9abc-bace40296bac', '00000000-b5c6-4896-987c-f30f3678f601');

create TABLE IF NOT EXISTS ecomm.&quot;user&quot; (
    id uuid NOT NULL DEFAULT random_uuid(),
    username varchar(16),
    password varchar(40),
    first_name varchar(16),
    last_name varchar(16),
    email varchar(24),
    phone varchar(24),
    user_status varchar(16),
    PRIMARY KEY(id)
);

create TABLE IF NOT EXISTS ecomm.address (
    id uuid NOT NULL DEFAULT random_uuid(),
    number varchar(24),
    residency varchar(32),
    street varchar(32),
    city varchar(24),
    state varchar(24),
    country varchar(24),
    pincode varchar(10),
    PRIMARY KEY(id)
);

create TABLE IF NOT EXISTS ecomm.user_address (
    user_id uuid NOT NULL DEFAULT random_uuid(),
    address_id uuid NOT NULL,
    FOREIGN KEY (user_id)
        REFERENCES ecomm.&quot;user&quot;(id),
    FOREIGN KEY(address_id)
        REFERENCES ecomm.address(id)
);

create TABLE IF NOT EXISTS ecomm.payment (
    id uuid NOT NULL DEFAULT random_uuid(),
    authorized boolean,
    message varchar(64),
    PRIMARY KEY(id)
);

create TABLE IF NOT EXISTS ecomm.card (
    id uuid NOT NULL DEFAULT random_uuid(),
    number varchar(16),
    user_id uuid NOT NULL UNIQUE,
    last_name varchar(16),
    expires varchar(5),
    cvv varchar(4),
    FOREIGN KEY(user_id)
        REFERENCES ecomm.&quot;user&quot;(id),
    PRIMARY KEY(id)
);

create TABLE IF NOT EXISTS ecomm.shipment (
    id uuid NOT NULL DEFAULT random_uuid(),
    est_delivery_date timestamp,
    carrier varchar(24),
    PRIMARY KEY(id)
);

create TABLE IF NOT EXISTS ecomm.orders (
    id uuid NOT NULL DEFAULT random_uuid(),
    customer_id uuid NOT NULL,
    address_id uuid NOT NULL,
    card_id uuid,
    order_date timestamp,
    total numeric(16, 4) DEFAULT 0 NOT NULL,
    payment_id uuid,
    shipment_id uuid,
    status varchar(24),
    PRIMARY KEY(id),
    FOREIGN KEY(customer_id)
        REFERENCES ecomm.&quot;user&quot;(id),
    FOREIGN KEY(address_id)
        REFERENCES ecomm.address(id),
    FOREIGN KEY(card_id)
        REFERENCES ecomm.card(id),
    FOREIGN KEY(payment_id)
        REFERENCES ecomm.payment(id),
    FOREIGN KEY(shipment_id)
        REFERENCES ecomm.shipment(id),
    PRIMARY KEY(id)
);

create TABLE IF NOT EXISTS ecomm.item (
    id uuid NOT NULL DEFAULT random_uuid(),
    product_id uuid NOT NULL,
    quantity numeric(8, 0),
    unit_price numeric(16, 4) NOT NULL,
    FOREIGN KEY(product_id)
        REFERENCES ecomm.product(id),
    PRIMARY KEY(id)
);

create TABLE IF NOT EXISTS ecomm.order_item (
    id uuid NOT NULL DEFAULT random_uuid(),
    order_id uuid NOT NULL,
    item_id uuid NOT NULL,
    FOREIGN KEY (order_id)
        REFERENCES ecomm.orders(id),
    FOREIGN KEY(item_id)
        REFERENCES ecomm.item(id)
);

create TABLE IF NOT EXISTS ecomm.&quot;authorization&quot; (
    id uuid NOT NULL DEFAULT random_uuid(),
    order_id uuid NOT NULL DEFAULT random_uuid(),
    authorized boolean,
    time timestamp,
    message varchar(16),
    error varchar(24),
    FOREIGN KEY (order_id)
        REFERENCES ecomm.orders(id),
    PRIMARY KEY(id)
);

create TABLE IF NOT EXISTS ecomm.cart (
    id uuid NOT NULL DEFAULT random_uuid(),
    user_id uuid NOT NULL DEFAULT random_uuid(),
    FOREIGN KEY (user_id)
        REFERENCES ecomm.&quot;user&quot;(id),
    PRIMARY KEY(id)
);

create TABLE IF NOT EXISTS ecomm.cart_item (
    cart_id uuid NOT NULL DEFAULT random_uuid(),
    item_id uuid NOT NULL DEFAULT random_uuid(),
    FOREIGN KEY (cart_id)
        REFERENCES ecomm.cart(id),
    FOREIGN KEY(item_id)
        REFERENCES ecomm.item(id)
);

insert into ecomm.&quot;user&quot; (id, username, password, first_name, last_name, email, phone, user_status) values('a1b9b31d-e73c-4112-af7c-b68530f38222', 'test', 'pwd', 'Test', 'User', 'test@user.com', '234234234', 'ACTIVE');
insert into ecomm.&quot;user&quot; (id, username, password, first_name, last_name, email, phone, user_status) values('a1b9b31d-e73c-4112-af7c-b68530f38223', 'test', 'pwd', 'Test2', 'User2', 'test2@user.com', '234234234', 'ACTIVE');
INSERT INTO ecomm.address VALUES ('a731fda1-aaad-42ea-bdbc-a27eeebe2cc0', '9I-999', 'Fraser Suites Le Claridge', 'Champs-Elysees', 'Paris', 'Île-de-France', 'France', '75008');
insert into ecomm.user_address values ('a1b9b31d-e73c-4112-af7c-b68530f38222', 'a731fda1-aaad-42ea-bdbc-a27eeebe2cc0');
INSERT INTO ecomm.card VALUES ('618ffaff-cbcd-48d4-8848-a15601e6725b', '999-999-999-999', 'a1b9b31d-e73c-4112-af7c-b68530f38222', 'User', '12/28', '0000');
insert into ecomm.cart values ('cacab31d-e73c-4112-af7c-b68530f38222', 'a1b9b31d-e73c-4112-af7c-b68530f38222');
insert into ecomm.cart values ('cacab31d-e73c-4112-af7c-b68530f38223', 'a1b9b31d-e73c-4112-af7c-b68530f38223');
insert into ecomm.item values('a7384042-e4aa-4c93-85ae-31a346dad702', '6d62d909-f957-430e-8689-b5129c0bb75e', 1, 17.15);
insert into ecomm.cart_item values ('cacab31d-e73c-4112-af7c-b68530f38222', 'a7384042-e4aa-4c93-85ae-31a346dad702');
insert into ecomm.item values('a7384042-e4aa-4c93-85ae-31a346dad703', 'd3588630-ad8e-49df-bbd7-3167f7efb246', 1, 10.99);
insert into ecomm.cart_item values ('cacab31d-e73c-4112-af7c-b68530f38222', 'a7384042-e4aa-4c93-85ae-31a346dad703');
insert into ecomm.orders(id, customer_id, address_id, card_id, order_date, total, payment_id, shipment_id, status) values ('0a59ba9f-629e-4445-8129-b9bce1985d6a','a1b9b31d-e73c-4112-af7c-b68530f38222', 'a731fda1-aaad-42ea-bdbc-a27eeebe2cc0', '618ffaff-cbcd-48d4-8848-a15601e6725b', current_timestamp, 38.14, NULL, NULL, 'CREATED');
INSERT INTO ecomm.item VALUES
  ('a7384042-e4aa-4c93-85ae-31a346dad704', '6d62d909-f957-430e-8689-b5129c0bb75e', 1, 17.15),
  ('a7384042-e4aa-4c93-85ae-31a346dad705', '3395a42e-2d88-40de-b95f-e00e1502085b', 1, 20.99);
INSERT INTO ecomm.order_item VALUES
  ('66682caa-a6d8-46ed-a173-ff822f754e1c', '0a59ba9f-629e-4445-8129-b9bce1985d6a', 'a7384042-e4aa-4c93-85ae-31a346dad704'),
  ('efeefa71-2760-412a-9ec8-0a040d90f02c', '0a59ba9f-629e-4445-8129-b9bce1985d6a', 'a7384042-e4aa-4c93-85ae-31a346dad705');

</div></section><section class="chapter"><h3 id="entity" data-toc="entity">Entity 추가</h3><p id="-c0nkc2_337">엔티티는 @Entity 주석으로 표시된 특별한 클래스입니다. 이 클래스는 데이터베이스 테이블과 매핑되며 JPA를 사용하여 데이터베이스와 상호 작용합니다. 기본적으로 엔티티의 이름이 데이터베이스 테이블의 이름이 됩니다. 그러나 @Table 애너테이션을 사용하여 테이블 이름을 지정할 수 있습니다. Cart 엔티티를 User 엔티티 및 Item 엔티티에 매핑하기 위해 1:1 및 N:M 애너테이션을 사용하고 있습니다. 하나의 User는 하나의 Cart만 소유할 수 있습니다. 그래서 1:1입니다. 그러나 하나의 카트는 여러 Item을 가질 수 있고 하나의 Item도 여러 Cart에 담길 수 있습니다. 이건 N:M입니다. N:M 관계는 언뜻 보면 테이블 두 개로 해결될 것 같지만, 실제로는 CART_ITEM이라는 중간 테이블이 필요합니다. 이 테이블은 두 테이블의 PK를 FK로 가지고 있습니다. Cart 입장에서 Item을 어떻게 관계 맺을 것인지에 대한 내용이 @ManyToMany, @JoinTable 내에 기술되는 것입니다.</p><p id="-c0nkc2_338">UserEntity에는 CartEntity와의 관계를 기술하기 위해 다음과 같은 코드가 추가됩니다.</p><div class="code-block" data-lang="java">
  @OneToOne(mappedBy = &quot;user&quot;, fetch = FetchType.LAZY, orphanRemoval = true)
  private CartEntity cart;
</div><p id="-c0nkc2_340">FetchType은 LAZY인데 사용자의 장바구니를 명시적으로 요청할 때 로드되도록 합니다. 처음부터 데이터를 로드하지 않고 실제 값이 필요할 때 로드함으로써 성능향상을 도모할 수 있습니다. orphanRemoval은 UserEntity가 삭제될 때 CartEntity도 삭제되도록 합니다.</p><section class="chapter"><h4 id="user-cart-item-er" data-toc="user-cart-item-er">User, Cart, Item의 관계에 대한 ER 다이어그램</h4><figure id="-c0nkc2_341"><img alt="er_1.png" src="images/er_1.png" title="er_1.png" width="734" height="294"></figure><p id="-c0nkc2_342"><span class="control" id="-c0nkc2_343">com.infosiatec.modern.api.entity</span> 패키지에 모든 엔티티들을 추가합시다.</p><p id="-c0nkc2_344">CartEntity.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.entity;">

package com.infosiatec.modern.api.entity;

import jakarta.persistence.CascadeType;
import jakarta.persistence.Column;
import jakarta.persistence.Entity;
import jakarta.persistence.GeneratedValue;
import jakarta.persistence.Id;
import jakarta.persistence.JoinColumn;
import jakarta.persistence.JoinTable;
import jakarta.persistence.ManyToMany;
import jakarta.persistence.OneToOne;
import jakarta.persistence.Table;
import java.util.ArrayList;
import java.util.List;
import java.util.Objects;
import java.util.UUID;

@Entity
@Table(name = &quot;cart&quot;)
public class CartEntity {

  @Id
  @GeneratedValue
  @Column(name = &quot;ID&quot;, updatable = false, nullable = false)
  private UUID id;

  @OneToOne
  @JoinColumn(name = &quot;USER_ID&quot;, referencedColumnName = &quot;ID&quot;)
  private UserEntity user;

  @ManyToMany(
      cascade = CascadeType.ALL
  )
  @JoinTable(
      name = &quot;CART_ITEM&quot;,
      joinColumns = @JoinColumn(name = &quot;CART_ID&quot;),
      inverseJoinColumns = @JoinColumn(name = &quot;ITEM_ID&quot;)
  )
  private List&lt;ItemEntity&gt; items = new ArrayList&lt;&gt;();

  public UUID getId() {
    return id;
  }

  public CartEntity setId(UUID id) {
    this.id = id;
    return this;
  }

  public UserEntity getUser() {
    return user;
  }

  public CartEntity setUser(UserEntity user) {
    this.user = user;
    return this;
  }

  public List&lt;ItemEntity&gt; getItems() {
    return items;
  }

  public CartEntity setItems(List&lt;ItemEntity&gt; items) {
    this.items = items;
    return this;
  }

  @Override
  public boolean equals(Object o) {
    if (this == o) {
      return true;
    }
    if (o == null || getClass() != o.getClass()) {
      return false;
    }
    CartEntity that = (CartEntity) o;
    return user.equals(that.user) &amp;&amp; Objects.equals(items, that.items);
  }

  @Override
  public int hashCode() {
    return Objects.hash(user, items);
  }
}

</div><p id="-c0nkc2_347">UserEntity.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.entity;">

package com.infosiatec.modern.api.entity;


import jakarta.persistence.Basic;
import jakarta.persistence.CascadeType;
import jakarta.persistence.Column;
import jakarta.persistence.Entity;
import jakarta.persistence.FetchType;
import jakarta.persistence.GeneratedValue;
import jakarta.persistence.Id;
import jakarta.persistence.JoinColumn;
import jakarta.persistence.JoinTable;
import jakarta.persistence.OneToMany;
import jakarta.persistence.OneToOne;
import jakarta.persistence.Table;
import jakarta.validation.constraints.NotNull;
import java.util.ArrayList;
import java.util.List;
import java.util.UUID;

@Entity
@Table(name = &quot;\&quot;user\&quot;&quot;)
public class UserEntity {
  @Id
  @GeneratedValue
  @Column(name = &quot;ID&quot;, updatable = false, nullable = false)
  private UUID id;

  @NotNull(message = &quot;User name is required.&quot;)
  @Basic(optional = false)
  @Column(name = &quot;USERNAME&quot;)
  private String username;

  @Column(name = &quot;PASSWORD&quot;)
  private String password;

  @Column(name = &quot;FIRST_NAME&quot;)
  private String firstName;

  @Column(name = &quot;LAST_NAME&quot;)
  private String lastName;

  @Column(name = &quot;EMAIL&quot;)
  private String email;

  @Column(name = &quot;PHONE&quot;)
  private String phone;

  @Column(name = &quot;USER_STATUS&quot;)
  private String userStatus;

  @OneToMany(cascade = CascadeType.ALL, orphanRemoval = true)
  @JoinTable(
      name = &quot;USER_ADDRESS&quot;,
      joinColumns = @JoinColumn(name = &quot;USER_ID&quot;),
      inverseJoinColumns = @JoinColumn(name = &quot;ADDRESS_ID&quot;)
  )
  private List&lt;AddressEntity&gt; addresses = new ArrayList&lt;&gt;();

  @OneToMany(mappedBy = &quot;user&quot;, fetch = FetchType.LAZY, orphanRemoval = true)
  private List&lt;CardEntity&gt; cards;

  @OneToOne(mappedBy = &quot;user&quot;, fetch = FetchType.LAZY, orphanRemoval = true)
  private CartEntity cart;

  @OneToMany(mappedBy = &quot;userEntity&quot;, fetch = FetchType.LAZY, orphanRemoval = true)
  private List&lt;OrderEntity&gt; orders;

  public UUID getId() {
    return id;
  }

  public UserEntity setId(UUID id) {
    this.id = id;
    return this;
  }

  public String getUsername() {
    return username;
  }

  public UserEntity setUsername(String username) {
    this.username = username;
    return this;
  }

  public String getPassword() {
    return password;
  }

  public UserEntity setPassword(String password) {
    this.password = password;
    return this;
  }

  public String getFirstName() {
    return firstName;
  }

  public UserEntity setFirstName(String firstName) {
    this.firstName = firstName;
    return this;
  }

  public String getLastName() {
    return lastName;
  }

  public UserEntity setLastName(String lastName) {
    this.lastName = lastName;
    return this;
  }

  public String getEmail() {
    return email;
  }

  public UserEntity setEmail(String email) {
    this.email = email;
    return this;
  }

  public String getPhone() {
    return phone;
  }

  public UserEntity setPhone(String phone) {
    this.phone = phone;
    return this;
  }

  public String getUserStatus() {
    return userStatus;
  }

  public UserEntity setUserStatus(String userStatus) {
    this.userStatus = userStatus;
    return this;
  }

  public List&lt;AddressEntity&gt; getAddresses() {
    return addresses;
  }

  public UserEntity setAddresses(
      List&lt;AddressEntity&gt; addresses) {
    this.addresses = addresses;
    return this;
  }

  public List&lt;CardEntity&gt; getCard() {
    return cards;
  }

  public UserEntity setCard(List&lt;CardEntity&gt; card) {
    this.cards = card;
    return this;
  }

  public CartEntity getCart() {
    return cart;
  }

  public UserEntity setCart(CartEntity cart) {
    this.cart = cart;
    return this;
  }

  public List&lt;OrderEntity&gt; getOrder() {
    return orders;
  }

  public UserEntity setOrder(List&lt;OrderEntity&gt; order) {
    this.orders = order;
    return this;
  }
}

</div><p id="-c0nkc2_350">ItemEntity.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.entity;">

package com.infosiatec.modern.api.entity;


import jakarta.persistence.Column;
import jakarta.persistence.Entity;
import jakarta.persistence.FetchType;
import jakarta.persistence.GeneratedValue;
import jakarta.persistence.Id;
import jakarta.persistence.JoinColumn;
import jakarta.persistence.ManyToMany;
import jakarta.persistence.ManyToOne;
import jakarta.persistence.Table;
import java.math.BigDecimal;
import java.util.List;
import java.util.Objects;
import java.util.UUID;

@Entity
@Table(name = &quot;item&quot;)
public class ItemEntity {

  @Id
  @GeneratedValue
  @Column(name = &quot;ID&quot;, updatable = false, nullable = false)
  private UUID id;

  @ManyToOne
  @JoinColumn(name = &quot;PRODUCT_ID&quot;, referencedColumnName = &quot;ID&quot;)
  private ProductEntity product;

  @Column(name = &quot;UNIT_PRICE&quot;)
  private BigDecimal price;

  @Column(name = &quot;QUANTITY&quot;)
  private int quantity;

  @ManyToMany(mappedBy = &quot;items&quot;, fetch = FetchType.LAZY)
  private List&lt;CartEntity&gt; cart;

  @ManyToMany(mappedBy = &quot;items&quot;, fetch = FetchType.LAZY)
  private List&lt;OrderEntity&gt; orders;

  public UUID getId() {
    return id;
  }

  public ItemEntity setId(UUID id) {
    this.id = id;
    return this;
  }

  public ProductEntity getProduct() {
    return product;
  }

  public ItemEntity setProduct(ProductEntity product) {
    this.product = product;
    return this;
  }

  public BigDecimal getPrice() {
    return price;
  }

  public ItemEntity setPrice(BigDecimal price) {
    this.price = price;
    return this;
  }

  public int getQuantity() {
    return quantity;
  }

  public ItemEntity setQuantity(int quantity) {
    this.quantity = quantity;
    return this;
  }

  @Override
  public boolean equals(Object o) {
    if (this == o) {
      return true;
    }
    if (o == null || getClass() != o.getClass()) {
      return false;
    }
    ItemEntity that = (ItemEntity) o;
    return quantity == that.quantity &amp;&amp; product.equals(that.product) &amp;&amp; Objects
        .equals(price, that.price);// &amp;&amp; Objects.equals(cart, that.cart);
  }

  @Override
  public int hashCode() {
    return Objects.hash(product, price, quantity);//, cart);
  }

  public List&lt;CartEntity&gt; getCart() {
    return cart;
  }

  public ItemEntity setCart(List&lt;CartEntity&gt; cart) {
    this.cart = cart;
    return this;
  }

  public List&lt;OrderEntity&gt; getOrders() {
    return orders;
  }

  public ItemEntity setOrders(List&lt;OrderEntity&gt; orders) {
    this.orders = orders;
    return this;
  }
}

</div><p id="-c0nkc2_353">ProductEntity.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.entity;">

package com.infosiatec.modern.api.entity;

import jakarta.persistence.Basic;
import jakarta.persistence.CascadeType;
import jakarta.persistence.Column;
import jakarta.persistence.Entity;
import jakarta.persistence.GeneratedValue;
import jakarta.persistence.Id;
import jakarta.persistence.JoinColumn;
import jakarta.persistence.JoinTable;
import jakarta.persistence.OneToMany;
import jakarta.persistence.Table;
import jakarta.validation.constraints.NotNull;
import java.math.BigDecimal;
import java.util.ArrayList;
import java.util.List;
import java.util.UUID;

@Entity
@Table(name = &quot;product&quot;)
public class ProductEntity {

  @Id
  @GeneratedValue
  @Column(name = &quot;ID&quot;, updatable = false, nullable = false)
  private UUID id;

  @NotNull(message = &quot;Product name is required.&quot;)
  @Basic(optional = false)
  @Column(name = &quot;NAME&quot;)
  private String name;

  @Column(name = &quot;DESCRIPTION&quot;)
  private String description;

  @Column(name = &quot;PRICE&quot;)
  private BigDecimal price;

  @Column(name = &quot;COUNT&quot;)
  private int count;

  @Column(name = &quot;IMAGE_URL&quot;)
  private String imageUrl;

  @OneToMany(cascade = CascadeType.ALL)
  @JoinTable(
      name = &quot;PRODUCT_TAG&quot;,
      joinColumns = @JoinColumn(name = &quot;PRODUCT_ID&quot;),
      inverseJoinColumns = @JoinColumn(name = &quot;TAG_ID&quot;)
  )
  private List&lt;TagEntity&gt; tags = new ArrayList&lt;&gt;();

  @OneToMany(mappedBy = &quot;product&quot;)
  private List&lt;ItemEntity&gt; items;

  public ProductEntity(UUID id, @NotNull(message = &quot;Product name is required.&quot;) String name,
      String description, BigDecimal price, int count, String imageUrl) {
    this.id = id;
    this.name = name;
    this.price = price;
    this.description = description;
    this.count = count;
    this.imageUrl = imageUrl;
  }

  public ProductEntity() {
  }

  public UUID getId() {
    return id;
  }

  public ProductEntity setId(UUID id) {
    this.id = id;
    return this;
  }

  public String getName() {
    return name;
  }

  public ProductEntity setName(String name) {
    this.name = name;
    return this;
  }

  public String getDescription() {
    return description;
  }

  public ProductEntity setDescription(String description) {
    this.description = description;
    return this;
  }

  public BigDecimal getPrice() {
    return price;
  }

  public ProductEntity setPrice(BigDecimal price) {
    this.price = price;
    return this;
  }

  public int getCount() {
    return count;
  }

  public ProductEntity setCount(int count) {
    this.count = count;
    return this;
  }

  public String getImageUrl() {
    return imageUrl;
  }

  public ProductEntity setImageUrl(String imageUrl) {
    this.imageUrl = imageUrl;
    return this;
  }

  public List&lt;TagEntity&gt; getTags() {
    return tags;
  }

  public ProductEntity setTags(List&lt;TagEntity&gt; tags) {
    this.tags = tags;
    return this;
  }

  public List&lt;ItemEntity&gt; getItem() {
    return items;
  }

  public ProductEntity setItem(List&lt;ItemEntity&gt; item) {
    this.items = item;
    return this;
  }
}

</div><p id="-c0nkc2_356">TagEntity.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.entity;">

package com.infosiatec.modern.api.entity;

import jakarta.persistence.Basic;
import jakarta.persistence.Column;
import jakarta.persistence.Entity;
import jakarta.persistence.GeneratedValue;
import jakarta.persistence.Id;
import jakarta.persistence.Table;
import jakarta.validation.constraints.NotNull;
import java.util.UUID;

@Entity
@Table(name = &quot;tag&quot;)
public class TagEntity {

  @Id
  @GeneratedValue
  @Column(name = &quot;ID&quot;, updatable = false, nullable = false)
  private UUID id;

  @NotNull(message = &quot;Product name is required.&quot;)
  @Basic(optional = false)
  @Column(name = &quot;NAME&quot;)
  private String name;

  public UUID getId() {
    return id;
  }

  public TagEntity setId(UUID id) {
    this.id = id;
    return this;
  }

  public String getName() {
    return name;
  }

  public TagEntity setName(String name) {
    this.name = name;
    return this;
  }
}

</div><p id="-c0nkc2_359">AddressEntity.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.entity;">

package com.infosiatec.modern.api.entity;

import jakarta.persistence.Column;
import jakarta.persistence.Entity;
import jakarta.persistence.FetchType;
import jakarta.persistence.GeneratedValue;
import jakarta.persistence.Id;
import jakarta.persistence.OneToMany;
import jakarta.persistence.Table;
import java.util.List;
import java.util.UUID;

@Entity
@Table(name = &quot;address&quot;)
public class AddressEntity {
  @Id
  @GeneratedValue
  @Column(name = &quot;ID&quot;, updatable = false, nullable = false)
  private UUID id;

  @Column(name = &quot;NUMBER&quot;)
  private String number;

  @Column(name = &quot;RESIDENCY&quot;)
  private String residency;

  @Column(name = &quot;STREET&quot;)
  private String street;

  @Column(name = &quot;CITY&quot;)
  private String city;

  @Column(name = &quot;STATE&quot;)
  private String state;

  @Column(name = &quot;COUNTRY&quot;)
  private String country;

  @Column(name = &quot;PINCODE&quot;)
  private String pincode;

  @OneToMany(mappedBy = &quot;addressEntity&quot;, fetch = FetchType.LAZY, orphanRemoval = true)
  private List&lt;OrderEntity&gt; orders;

  public UUID getId() {
    return id;
  }

  public AddressEntity setId(UUID id) {
    this.id = id;
    return this;
  }

  public String getNumber() {
    return number;
  }

  public AddressEntity setNumber(String number) {
    this.number = number;
    return this;
  }

  public String getResidency() {
    return residency;
  }

  public AddressEntity setResidency(String residency) {
    this.residency = residency;
    return this;
  }

  public String getStreet() {
    return street;
  }

  public AddressEntity setStreet(String street) {
    this.street = street;
    return this;
  }

  public String getCity() {
    return city;
  }

  public AddressEntity setCity(String city) {
    this.city = city;
    return this;
  }

  public String getState() {
    return state;
  }

  public AddressEntity setState(String state) {
    this.state = state;
    return this;
  }

  public String getCountry() {
    return country;
  }

  public AddressEntity setCountry(String country) {
    this.country = country;
    return this;
  }

  public String getPincode() {
    return pincode;
  }

  public AddressEntity setPincode(String pincode) {
    this.pincode = pincode;
    return this;
  }

  public List&lt;OrderEntity&gt; getOrders() {
    return orders;
  }

  public AddressEntity setOrders(List&lt;OrderEntity&gt; orders) {
    this.orders = orders;
    return this;
  }
}

</div><p id="-c0nkc2_362">CardEntity.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.entity;">

package com.infosiatec.modern.api.entity;

import jakarta.persistence.Column;
import jakarta.persistence.Entity;
import jakarta.persistence.FetchType;
import jakarta.persistence.GeneratedValue;
import jakarta.persistence.Id;
import jakarta.persistence.JoinColumn;
import jakarta.persistence.OneToMany;
import jakarta.persistence.OneToOne;
import jakarta.persistence.Table;
import java.util.List;
import java.util.UUID;

@Entity
@Table(name = &quot;card&quot;)
public class CardEntity {
  @Id
  @GeneratedValue
  @Column(name = &quot;ID&quot;, updatable = false, nullable = false)
  private UUID id;

  @Column(name = &quot;NUMBER&quot;)
  private String number;

  @Column(name = &quot;EXPIRES&quot;)
  private String expires;

  @Column(name = &quot;CVV&quot;)
  private String cvv;

  @OneToOne
  @JoinColumn(name = &quot;USER_ID&quot;, referencedColumnName = &quot;ID&quot;)
  private UserEntity user;

  @OneToMany(mappedBy = &quot;cardEntity&quot;, fetch = FetchType.LAZY, orphanRemoval = true)
  private List&lt;OrderEntity&gt; orders;

  public UUID getId() {
    return id;
  }

  public CardEntity setId(UUID id) {
    this.id = id;
    return this;
  }

  public String getNumber() {
    return number;
  }

  public CardEntity setNumber(String number) {
    this.number = number;
    return this;
  }

  public String getExpires() {
    return expires;
  }

  public CardEntity setExpires(String expires) {
    this.expires = expires;
    return this;
  }

  public String getCvv() {
    return cvv;
  }

  public CardEntity setCvv(String cvv) {
    this.cvv = cvv;
    return this;
  }

  public UserEntity getUser() {
    return user;
  }

  public CardEntity setUser(UserEntity user) {
    this.user = user;
    return this;
  }

  public List&lt;OrderEntity&gt; getOrderEntity() {
    return orders;
  }

  public CardEntity setOrderEntity(List&lt;OrderEntity&gt; orders) {
    this.orders = orders;
    return this;
  }
}

</div><p id="-c0nkc2_365">AuthorizationEntity.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.entity;">

package com.infosiatec.modern.api.entity;

import jakarta.persistence.CascadeType;
import jakarta.persistence.Column;
import jakarta.persistence.Entity;
import jakarta.persistence.GeneratedValue;
import jakarta.persistence.Id;
import jakarta.persistence.JoinColumn;
import jakarta.persistence.OneToOne;
import jakarta.persistence.Table;
import java.sql.Timestamp;
import java.util.UUID;

@Entity
@Table(name = &quot;\&quot;authorization\&quot;&quot;)
public class AuthorizationEntity {

  @Id
  @GeneratedValue
  @Column(name = &quot;ID&quot;, updatable = false, nullable = false)
  private UUID id;

  @Column(name=&quot;AUTHORIZED&quot;)
  private boolean authorized;

  @Column(name=&quot;TIME&quot;)
  private Timestamp time;

  @Column(name = &quot;MESSAGE&quot;)
  private String message;

  @Column(name = &quot;ERROR&quot;)
  private String error;

  @OneToOne(cascade = CascadeType.ALL)
  @JoinColumn(name = &quot;ORDER_ID&quot;, referencedColumnName = &quot;id&quot;)
  private OrderEntity orderEntity;

  public UUID getId() {
    return id;
  }

  public AuthorizationEntity setId(UUID id) {
    this.id = id;
    return this;
  }

  public boolean isAuthorized() {
    return authorized;
  }

  public AuthorizationEntity setAuthorized(boolean authorized) {
    this.authorized = authorized;
    return this;
  }

  public Timestamp getTime() {
    return time;
  }

  public AuthorizationEntity setTime(Timestamp time) {
    this.time = time;
    return this;
  }

  public String getMessage() {
    return message;
  }

  public AuthorizationEntity setMessage(String message) {
    this.message = message;
    return this;
  }

  public String getError() {
    return error;
  }

  public AuthorizationEntity setError(String error) {
    this.error = error;
    return this;
  }

  public OrderEntity getOrderEntity() {
    return orderEntity;
  }

  public AuthorizationEntity setOrderEntity(OrderEntity orderEntity) {
    this.orderEntity = orderEntity;
    return this;
  }
}

</div><p id="-c0nkc2_368">OrderEntity.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.entity;">

package com.infosiatec.modern.api.entity;

import com.infosiatec.modern.api.model.Order.StatusEnum;
import jakarta.persistence.CascadeType;
import jakarta.persistence.Column;
import jakarta.persistence.Entity;
import jakarta.persistence.EnumType;
import jakarta.persistence.Enumerated;
import jakarta.persistence.FetchType;
import jakarta.persistence.GeneratedValue;
import jakarta.persistence.Id;
import jakarta.persistence.JoinColumn;
import jakarta.persistence.JoinTable;
import jakarta.persistence.ManyToMany;
import jakarta.persistence.ManyToOne;
import jakarta.persistence.OneToOne;
import jakarta.persistence.Table;
import java.math.BigDecimal;
import java.sql.Timestamp;
import java.util.ArrayList;
import java.util.List;
import java.util.UUID;

@Entity
@Table(name = &quot;orders&quot;)
public class OrderEntity {
  @Id
  @GeneratedValue
  @Column(name = &quot;ID&quot;, updatable = false, nullable = false)
  private UUID id;

  @Column(name = &quot;TOTAL&quot;)
  private BigDecimal total;

  @Column(name = &quot;STATUS&quot;)
  @Enumerated(EnumType.STRING)
  private StatusEnum status;

  @ManyToOne(cascade = CascadeType.ALL, fetch = FetchType.LAZY)
  @JoinColumn(name=&quot;CUSTOMER_ID&quot;, nullable=false)
  private UserEntity userEntity;

  @ManyToOne(cascade = CascadeType.ALL, fetch = FetchType.LAZY)
  @JoinColumn(name = &quot;ADDRESS_ID&quot;, referencedColumnName = &quot;ID&quot;, insertable=false, updatable=false)
  private AddressEntity addressEntity;

  @OneToOne(cascade = CascadeType.ALL )
  @JoinColumn(name = &quot;PAYMENT_ID&quot;, referencedColumnName = &quot;ID&quot;)
  private PaymentEntity paymentEntity;

  @JoinColumn(name = &quot;SHIPMENT_ID&quot;, referencedColumnName = &quot;ID&quot;)
  @OneToOne
  private ShipmentEntity shipment;

  @ManyToOne(cascade = CascadeType.ALL, fetch = FetchType.LAZY)
  @JoinColumn(name = &quot;CARD_ID&quot;, referencedColumnName = &quot;ID&quot;)
  private CardEntity cardEntity;

  @Column(name = &quot;ORDER_DATE&quot;)
  private Timestamp orderDate;

  @ManyToMany(cascade = CascadeType.ALL, fetch = FetchType.LAZY)
  @JoinTable(
      name = &quot;ORDER_ITEM&quot;,
      joinColumns = @JoinColumn(name = &quot;ORDER_ID&quot;),
      inverseJoinColumns = @JoinColumn(name = &quot;ITEM_ID&quot;)
  )
  private List&lt;ItemEntity&gt; items = new ArrayList&lt;&gt;();

  @OneToOne(mappedBy = &quot;orderEntity&quot;)
  private AuthorizationEntity authorizationEntity;

  public UUID getId() {
    return id;
  }

  public OrderEntity setId(UUID id) {
    this.id = id;
    return this;
  }

  public BigDecimal getTotal() {
    return total;
  }

  public OrderEntity setTotal(BigDecimal total) {
    this.total = total;
    return this;
  }

  public StatusEnum getStatus() {
    return status;
  }

  public OrderEntity setStatus(StatusEnum status) {
    this.status = status;
    return this;
  }

  public UserEntity getUserEntity() {
    return userEntity;
  }

  public OrderEntity setUserEntity(UserEntity userEntity) {
    this.userEntity = userEntity;
    return this;
  }

  public AddressEntity getAddressEntity() {
    return addressEntity;
  }

  public OrderEntity setAddressEntity(AddressEntity addressEntity) {
    this.addressEntity = addressEntity;
    return this;
  }

  public PaymentEntity getPaymentEntity() {
    return paymentEntity;
  }

  public OrderEntity setPaymentEntity(PaymentEntity paymentEntity) {
    this.paymentEntity = paymentEntity;
    return this;
  }

  public ShipmentEntity getShipments() {
    return shipment;
  }

  public OrderEntity setShipments(ShipmentEntity shipment) {
    this.shipment = shipment;
    return this;
  }

  public CardEntity getCardEntity() {
    return cardEntity;
  }

  public OrderEntity setCardEntity(CardEntity cardEntity) {
    this.cardEntity = cardEntity;
    return this;
  }

  public Timestamp getOrderDate() {
    return orderDate;
  }

  public OrderEntity setOrderDate(Timestamp orderDate) {
    this.orderDate = orderDate;
    return this;
  }

  public List&lt;ItemEntity&gt; getItems() {
    return items;
  }

  public OrderEntity setItems(List&lt;ItemEntity&gt; items) {
    this.items = items;
    return this;
  }

  public AuthorizationEntity getAuthorizationEntity() {
    return authorizationEntity;
  }

  public OrderEntity setAuthorizationEntity(
      AuthorizationEntity authorizationEntity) {
    this.authorizationEntity = authorizationEntity;
    return this;
  }

  @Override
  public String toString() {
    return &quot;OrderEntity{&quot; +
        &quot;id=&quot; + id +
        &quot;, total=&quot; + total +
        &quot;, status=&quot; + status +
        &quot;, userEntity=&quot; + userEntity +
        &quot;, addressEntity=&quot; + addressEntity +
        &quot;, paymentEntity=&quot; + paymentEntity +
        &quot;, shipment=&quot; + shipment +
        &quot;, cardEntity=&quot; + cardEntity +
        &quot;, orderDate=&quot; + orderDate +
        &quot;, items=&quot; + items +
        &quot;, authorizationEntity=&quot; + authorizationEntity +
        '}';
  }
}

</div><p id="-c0nkc2_371">OrderItemEntity.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.entity;">

package com.infosiatec.modern.api.entity;

import jakarta.persistence.Column;
import jakarta.persistence.Entity;
import jakarta.persistence.GeneratedValue;
import jakarta.persistence.Id;
import jakarta.persistence.Table;
import java.util.Objects;
import java.util.UUID;

@Entity
@Table(name = &quot;order_item&quot;)
public class OrderItemEntity {

  @Id
  @GeneratedValue
  @Column(name = &quot;ID&quot;, updatable = false, nullable = false)
  private UUID id;

  @Column(name = &quot;order_id&quot;)
  private UUID orderId;

  @Column(name = &quot;item_id&quot;)
  private UUID itemId;

  public UUID getId() {
    return id;
  }

  public OrderItemEntity setId(UUID id) {
    this.id = id;
    return this;
  }

  public UUID getOrderId() {
    return orderId;
  }

  public OrderItemEntity setOrderId(UUID orderId) {
    this.orderId = orderId;
    return this;
  }

  public UUID getItemId() {
    return itemId;
  }

  public OrderItemEntity setItemId(UUID itemId) {
    this.itemId = itemId;
    return this;
  }

  @Override
  public boolean equals(Object o) {
    if (this == o) {
      return true;
    }
    if (o == null || getClass() != o.getClass()) {
      return false;
    }
    OrderItemEntity that = (OrderItemEntity) o;
    return Objects.equals(id, that.id) &amp;&amp; Objects.equals(orderId, that.orderId)
        &amp;&amp; Objects.equals(itemId, that.itemId);
  }

  @Override
  public int hashCode() {
    return Objects.hash(id, orderId, itemId);
  }

  @Override
  public String toString() {
    return &quot;OrderItemEntity{&quot; +
        &quot;id=&quot; + id +
        &quot;, orderId=&quot; + orderId +
        &quot;, itemId=&quot; + itemId +
        '}';
  }
}

</div><p id="-c0nkc2_374">PaymentEntity.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.entity;">

package com.infosiatec.modern.api.entity;

import jakarta.persistence.Column;
import jakarta.persistence.Entity;
import jakarta.persistence.GeneratedValue;
import jakarta.persistence.Id;
import jakarta.persistence.OneToOne;
import jakarta.persistence.Table;
import java.util.UUID;

@Entity
@Table(name = &quot;payment&quot;)
public class PaymentEntity {

  @Id
  @GeneratedValue
  @Column(name = &quot;ID&quot;, updatable = false, nullable = false)
  private UUID id;

  @Column(name=&quot;AUTHORIZED&quot;)
  private boolean authorized;

  @Column(name = &quot;MESSAGE&quot;)
  private String message;

  @OneToOne(mappedBy = &quot;paymentEntity&quot;)
  private OrderEntity orderEntity;

  public UUID getId() {
    return id;
  }

  public PaymentEntity setId(UUID id) {
    this.id = id;
    return this;
  }

  public boolean isAuthorized() {
    return authorized;
  }

  public PaymentEntity setAuthorized(boolean authorized) {
    this.authorized = authorized;
    return this;
  }

  public String getMessage() {
    return message;
  }

  public PaymentEntity setMessage(String message) {
    this.message = message;
    return this;
  }
}

</div><p id="-c0nkc2_377">ShipmentEntity.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.entity;">

package com.infosiatec.modern.api.entity;

import jakarta.persistence.Column;
import jakarta.persistence.Entity;
import jakarta.persistence.GeneratedValue;
import jakarta.persistence.Id;
import jakarta.persistence.Table;
import java.sql.Timestamp;
import java.util.UUID;

@Entity
@Table(name = &quot;shipment&quot;)
public class ShipmentEntity {
  @Id
  @GeneratedValue
  @Column(name = &quot;ID&quot;, updatable = false, nullable = false)
  private UUID id;

  @Column(name = &quot;EST_DELIVERY_DATE&quot;)
  private Timestamp estDeliveryDate;

  @Column(name = &quot;CARRIER&quot;)
  private String carrier;

  public UUID getId() {
    return id;
  }

  public ShipmentEntity setId(UUID id) {
    this.id = id;
    return this;
  }

  public Timestamp getEstDeliveryDate() {
    return estDeliveryDate;
  }

  public ShipmentEntity setEstDeliveryDate(Timestamp estDeliveryDate) {
    this.estDeliveryDate = estDeliveryDate;
    return this;
  }

  public String getCarrier() {
    return carrier;
  }

  public ShipmentEntity setCarrier(String carrier) {
    this.carrier = carrier;
    return this;
  }
}

</div></section></section><section class="chapter"><h3 id="repository_1" data-toc="repository_1">Repository 추가</h3><p id="-c0nkc2_380">Spring Data JPA를 사용하면 CRUD 작업을 수행하는 Repository를 추가하는 작업이 아주 간단합니다. 단순히 CrudRepository를 상속받는 것으로 save, saveAll, findById, findAll, findAllById, delete, deleteById와 같은 모든 CRUD 작업 구현을 제공합니다.</p><p id="-c0nkc2_381">CartRepository.java 를 생성해봅시다.</p><div class="code-block" data-lang="java">

package com.infosiatec.modern.api.repository;

import com.infosiatec.modern.api.entity.CartEntity;
import java.util.Optional;
import java.util.UUID;
import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.CrudRepository;
import org.springframework.data.repository.query.Param;

public interface CartRepository extends CrudRepository&lt;CartEntity, UUID&gt; {
  @Query(&quot;select c from CartEntity c join c.user u where u.id = :customerId&quot;)
  Optional&lt;CartEntity&gt; findByCustomerId(@Param(&quot;customerId&quot;) UUID customerId);
}
</div><p id="-c0nkc2_383">CartRepository 인터페이스는 <kbd class="keystroke" id="-c0nkc2_384" data-bypass="true"><span class="keystroke__value">org.springframework.data.repository</span></kbd> 패키지의 CrudRepository 부분을 확장합니다. @Query 어노테이션으로 표시된 JPA 쿼리 언어에서 지원하는 메서드를 추가할 수도 있습니다. @Query 어노테이션 내부의 쿼리는 Java Persistence Query Language (JPQL)로 작성됩니다. JPQL은 SQL과 매우 유사하지만 여기서는 실제 테이블 이름 대신 데이터베이스 테이블에 매핑된 Java 클래스 이름을 사용했습니다. 따라서 우리는 Cart 대신에 CartEntity를 테이블 이름으로 사용했습니다.</p><section class="chapter"><h4 id="jpql" data-toc="jpql">JPQL에서 컬럼 선택</h4><p id="-c0nkc2_385">열에 대해서는 데이터베이스 테이블 필드를 사용하는 대신 클래스에서 제공된 변수 이름을 사용해야 합니다. 실제 데이터베이스의 테이블명이나 컬럼명을 사용하면 매핑이 되지 않아 에러가 발생할 수 있습니다.</p><p id="-c0nkc2_386">&quot;JPQL 또는 네이티브 SQL로 내 맞춤 메소드를 추가하고 싶다면 어떻게 해야 할까?&quot;</p><p id="-c0nkc2_387">이것도 가능합니다. 주문에 대해, 이 목적을 위해 맞춤 인터페이스를 추가했습니다. 먼저, CartRepository와 유사한 OrderRepository를 살펴보겠습니다.</p><div class="code-block" data-lang="java">
@Repository
public interface OrderRepository extends CrudRepository&lt;OrderEntity, UUID&gt;, OrderRepositoryExt {
  @Query(&quot;select o from OrderEntity o join o.userEntity u where u.id = :customerId&quot;)
  public Iterable&lt;OrderEntity&gt; findByCustomerId(@Param(&quot;customerId&quot;) UUID customerId);
}
</div><p id="-c0nkc2_389">자세히 살펴보면 추가 인터페이스인 OrderRepositoryExt를 확장했습니다. 주문 리포지토리를 위한 추가 인터페이스로, 다음 코드로 구성되어 있습니다.</p><div class="code-block" data-lang="java">
public interface OrderRepositoryExt {
  Optional&lt;OrderEntity&gt; insert(NewOrder m);
}
</div><p id="-c0nkc2_391">이미 CrudRepository에는 이 목적을 위한 save() 메서드가 있습니다. 그러나 다른 save() 구현을 하고 싶은 경우엔 어떻게 해야 할까요?</p><p id="-c0nkc2_392">OrderRepositoryImpl.java를 생성하고 다음과 같이 작성해봅시다.</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.repository;">

package com.infosiatec.modern.api.repository;

import static java.util.stream.Collectors.toList;

import com.infosiatec.modern.api.entity.CartEntity;
import com.infosiatec.modern.api.entity.ItemEntity;
import com.infosiatec.modern.api.entity.OrderEntity;
import com.infosiatec.modern.api.entity.OrderItemEntity;
import com.infosiatec.modern.api.exception.ResourceNotFoundException;
import com.infosiatec.modern.api.model.NewOrder;
import com.infosiatec.modern.api.model.Order.StatusEnum;
import jakarta.persistence.EntityManager;
import jakarta.persistence.PersistenceContext;
import jakarta.transaction.Transactional;
import java.math.BigDecimal;
import java.sql.Timestamp;
import java.time.Instant;
import java.time.OffsetDateTime;
import java.time.ZoneId;
import java.time.temporal.ChronoUnit;
import java.util.List;
import java.util.Optional;
import java.util.UUID;
import java.util.stream.StreamSupport;
import org.springframework.stereotype.Repository;

@Repository
@Transactional
public class OrderRepositoryImpl implements OrderRepositoryExt {

  @PersistenceContext private final EntityManager em;

  private final ItemRepository itemRepo;
  private final CartRepository cRepo;
  private final OrderItemRepository oiRepo;

  public OrderRepositoryImpl(
      EntityManager em, ItemRepository itemRepo, CartRepository cRepo, OrderItemRepository oiRepo) {
    this.em = em;
    this.itemRepo = itemRepo;
    this.cRepo = cRepo;
    this.oiRepo = oiRepo;
  }

  // 새로운 주문을 데이터베이스에 추가하는 역할을 합니다.
  @Override
  public Optional&lt;OrderEntity&gt; insert(NewOrder m) {
    // 먼저, 고객의 장바구니에서 아이템을 찾습니다. 장바구니에 아이템이 없으면 ResourceNotFoundException을 발생시킵니다.
    Iterable&lt;ItemEntity&gt; dbItems = itemRepo.findByCustomerId(m.getCustomerId());
    List&lt;ItemEntity&gt; items = StreamSupport.stream(dbItems.spliterator(), false).toList();
    if (items.size() &lt; 1) {
      throw new ResourceNotFoundException(
          String.format(&quot;There is no item found in customer's (ID: %s) cart.&quot;, m.getCustomerId()));
    }
    // 장바구니에 있는 모든 아이템의 가격을 합산하여 주문의 총 가격을 계산합니다.
    BigDecimal total = BigDecimal.ZERO;
    for (ItemEntity i : items) {
      total = (BigDecimal.valueOf(i.getQuantity()).multiply(i.getPrice())).add(total);
    }
    // 현재 시간을 주문 시간으로 설정하고, 주문 정보를 데이터베이스에 저장합니다. 이 때, 주문 상태는 '생성됨'으로 설정됩니다.
    Timestamp orderDate = Timestamp.from(Instant.now());
    em.createNativeQuery(
            &quot;&quot;&quot;
        INSERT INTO ecomm.orders (address_id, card_id, customer_id, order_date, total, status)
         VALUES(?, ?, ?, ?, ?, ?)
        &quot;&quot;&quot;)
        .setParameter(1, m.getAddress().getId())
        .setParameter(2, m.getCard().getId())
        .setParameter(3, m.getCustomerId())
        .setParameter(4, orderDate)
        .setParameter(5, total)
        .setParameter(6, StatusEnum.CREATED.getValue())
        .executeUpdate();
    Optional&lt;CartEntity&gt; oCart = cRepo.findByCustomerId(UUID.fromString(m.getCustomerId()));
    // 고객의 장바구니를 찾아서 장바구니가 없으면 ResourceNotFoundException을 발생시킵니다.
    CartEntity cart =
        oCart.orElseThrow(
            () -&gt;
                new ResourceNotFoundException(
                    String.format(
                        &quot;Cart not found for given customer (ID: %s)&quot;, m.getCustomerId())));
    // 장바구니에 있는 모든 아이템을 삭제합니다.
    itemRepo.deleteCartItemJoinById(
        cart.getItems().stream().map(ItemEntity::getId).collect(toList()), cart.getId());
    // 방금 생성한 주문을 데이터베이스에서 찾아서,
    OrderEntity entity =
        (OrderEntity)
            em.createNativeQuery(
                    &quot;&quot;&quot;
        SELECT o.* FROM ecomm.orders o WHERE o.customer_id = ? AND o.order_date &gt;= ?
        &quot;&quot;&quot;, OrderEntity.class)
                .setParameter(1, m.getCustomerId())
                .setParameter(
                    2,
                    OffsetDateTime.ofInstant(orderDate.toInstant(), ZoneId.of(&quot;Z&quot;)) //ZoneId.of(&quot;Z&quot;)는 UTC 시간대를 나타냅니다. &quot;Z&quot;는 Zulu 시간의 약자로, 국제 표준 시간을 의미합니다.
                        .truncatedTo(ChronoUnit.MICROS))
                .getSingleResult();
    // 주문에 아이템을 추가합니다.
    oiRepo.saveAll(
        cart.getItems().stream()
            .map(i -&gt; new OrderItemEntity().setOrderId(entity.getId()).setItemId(i.getId()))
            .collect(toList()));
    // 최종적으로 생성된 주문을 반환합니다.
    return Optional.of(entity);
  }
}

</div><p id="-c0nkc2_395">이렇게 새로 insert()를 정의하면 JPQL 또는 Native SQL을 사용하여 나만의 새로운 구현이 가능합니다. 반드시 @Repository 애너테이션을 붙여서 스프링에게 이 클래스는 데이터베이스와 상호작용하는 컴포넌트임을 알려야 합니다. <br> @Transactional로 표시되어 있습니다. 이 클래스의 메소드에 의해 수행되는 트랜잭션이 스프링에 의해 관리된다는 특별한 애너테이션입니다. 커밋 및 롤백을 추가하는 모든 수동 작업을 스프링이 자동으로 처리합니다. <br> 또한 EntityManager 클래스에 @PersistenceContext를 사용하고 있습니다. 이를 통해 쿼리를 수동으로 생성하고 실행할 수 있습니다.</p><p id="-c0nkc2_398">이하는 <span id="-c0nkc2_399"><b><font style="color:#ff7f50">com.infosiatec.modern.api.repository</font></b></span> 패키지에 추가된 모든 Repository 클래스입니다.</p><p id="-c0nkc2_400">AddressRepository.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.repository;">

package com.infosiatec.modern.api.repository;

import com.infosiatec.modern.api.entity.AddressEntity;
import java.util.UUID;
import org.springframework.data.repository.CrudRepository;

public interface AddressRepository extends CrudRepository&lt;AddressEntity, UUID&gt; {
}

</div><p id="-c0nkc2_403">AuthorizationRepository.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.repository;">

package com.infosiatec.modern.api.repository;

import com.infosiatec.modern.api.entity.AuthorizationEntity;
import java.util.UUID;
import org.springframework.data.repository.CrudRepository;

public interface AuthorizationRepository extends CrudRepository&lt;AuthorizationEntity, UUID&gt; {
}

</div><p id="-c0nkc2_406">CardRepository.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.repository;">

package com.infosiatec.modern.api.repository;

import com.infosiatec.modern.api.entity.CardEntity;
import java.util.UUID;
import org.springframework.data.repository.CrudRepository;

public interface CardRepository extends CrudRepository&lt;CardEntity, UUID&gt; {
}

</div><p id="-c0nkc2_409">CartRepository.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.repository;">

package com.infosiatec.modern.api.repository;

import com.infosiatec.modern.api.entity.CartEntity;
import java.util.Optional;
import java.util.UUID;
import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.CrudRepository;
import org.springframework.data.repository.query.Param;

public interface CartRepository extends CrudRepository&lt;CartEntity, UUID&gt; {
@Query(&quot;select c from CartEntity c join c.user u where u.id = :customerId&quot;)
    Optional&lt;CartEntity&gt; findByCustomerId(@Param(&quot;customerId&quot;) UUID customerId);
}

</div><p id="-c0nkc2_412">ItemRepository.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.repository;">

package com.infosiatec.modern.api.repository;

import com.infosiatec.modern.api.entity.ItemEntity;
import java.util.List;
import java.util.UUID;
import org.springframework.data.jpa.repository.Modifying;
import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.CrudRepository;

public interface ItemRepository extends CrudRepository&lt;ItemEntity, UUID&gt; {
  @Query(
      value =
          &quot;select i.* from ecomm.cart c, ecomm.item i, ecomm.\&quot;user\&quot; u, ecomm.cart_item ci where u.id = :customerId and c.user_id=u.id and c.id=ci.cart_id and i.id=ci.item_id&quot;,
      nativeQuery = true)
  Iterable&lt;ItemEntity&gt; findByCustomerId(String customerId);

  @Modifying
  @Query(
      value = &quot;delete from ecomm.cart_item where item_id in (:ids) and cart_id = :cartId&quot;,
      nativeQuery = true)
  void deleteCartItemJoinById(List&lt;UUID&gt; ids, UUID cartId);
}

</div><p id="-c0nkc2_415">OrderItemRepository.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.repository;">

package com.infosiatec.modern.api.repository;

import com.infosiatec.modern.api.entity.OrderItemEntity;
import java.util.UUID;
import org.springframework.data.repository.CrudRepository;

public interface OrderItemRepository extends CrudRepository&lt;OrderItemEntity, UUID&gt; {
}

</div><p id="-c0nkc2_418">OrderRepository.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.repository;">

package com.infosiatec.modern.api.repository;

import com.infosiatec.modern.api.entity.OrderEntity;
import java.util.UUID;
import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.CrudRepository;
import org.springframework.data.repository.query.Param;
import org.springframework.stereotype.Repository;

@Repository
public interface OrderRepository extends CrudRepository&lt;OrderEntity, UUID&gt;, OrderRepositoryExt {

  @Query(&quot;select o from OrderEntity o join o.userEntity u where u.id = :customerId&quot;)
  Iterable&lt;OrderEntity&gt; findByCustomerId(@Param(&quot;customerId&quot;) UUID customerId);
}

</div><p id="-c0nkc2_421">OrderRepositoryExt.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.repository;">

package com.infosiatec.modern.api.repository;

import com.infosiatec.modern.api.entity.OrderEntity;
import com.infosiatec.modern.api.model.NewOrder;
import java.util.Optional;

public interface OrderRepositoryExt {
  Optional&lt;OrderEntity&gt; insert(NewOrder m);
}

</div><p id="-c0nkc2_424">OrderRepositoryImpl.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.repository;">

package com.infosiatec.modern.api.repository;

import static java.util.stream.Collectors.toList;

import com.infosiatec.modern.api.entity.CartEntity;
import com.infosiatec.modern.api.entity.ItemEntity;
import com.infosiatec.modern.api.entity.OrderEntity;
import com.infosiatec.modern.api.entity.OrderItemEntity;
import com.infosiatec.modern.api.exception.ResourceNotFoundException;
import com.infosiatec.modern.api.model.NewOrder;
import com.infosiatec.modern.api.model.Order.StatusEnum;
import jakarta.persistence.EntityManager;
import jakarta.persistence.PersistenceContext;
import jakarta.transaction.Transactional;
import java.math.BigDecimal;
import java.sql.Timestamp;
import java.time.Instant;
import java.time.OffsetDateTime;
import java.time.ZoneId;
import java.time.temporal.ChronoUnit;
import java.util.List;
import java.util.Optional;
import java.util.UUID;
import java.util.stream.StreamSupport;
import org.springframework.stereotype.Repository;

@Repository
@Transactional
public class OrderRepositoryImpl implements OrderRepositoryExt {

  @PersistenceContext private final EntityManager em;

  private final ItemRepository itemRepo;
  private final CartRepository cRepo;
  private final OrderItemRepository oiRepo;

  public OrderRepositoryImpl(
      EntityManager em, ItemRepository itemRepo, CartRepository cRepo, OrderItemRepository oiRepo) {
    this.em = em;
    this.itemRepo = itemRepo;
    this.cRepo = cRepo;
    this.oiRepo = oiRepo;
  }

  // 새로운 주문을 데이터베이스에 추가하는 역할을 합니다.
  @Override
  public Optional&lt;OrderEntity&gt; insert(NewOrder m) {
    // 먼저, 고객의 장바구니에서 아이템을 찾습니다. 장바구니에 아이템이 없으면 ResourceNotFoundException을 발생시킵니다.
    Iterable&lt;ItemEntity&gt; dbItems = itemRepo.findByCustomerId(m.getCustomerId());
    List&lt;ItemEntity&gt; items = StreamSupport.stream(dbItems.spliterator(), false).toList();
    if (items.size() &lt; 1) {
      throw new ResourceNotFoundException(
          String.format(&quot;There is no item found in customer's (ID: %s) cart.&quot;, m.getCustomerId()));
    }
    // 장바구니에 있는 모든 아이템의 가격을 합산하여 주문의 총 가격을 계산합니다.
    BigDecimal total = BigDecimal.ZERO;
    for (ItemEntity i : items) {
      total = (BigDecimal.valueOf(i.getQuantity()).multiply(i.getPrice())).add(total);
    }
    // 현재 시간을 주문 시간으로 설정하고, 주문 정보를 데이터베이스에 저장합니다. 이 때, 주문 상태는 '생성됨'으로 설정됩니다.
    Timestamp orderDate = Timestamp.from(Instant.now());
    em.createNativeQuery(
            &quot;&quot;&quot;
        INSERT INTO ecomm.orders (address_id, card_id, customer_id, order_date, total, status)
         VALUES(?, ?, ?, ?, ?, ?)
        &quot;&quot;&quot;)
        .setParameter(1, m.getAddress().getId())
        .setParameter(2, m.getCard().getId())
        .setParameter(3, m.getCustomerId())
        .setParameter(4, orderDate)
        .setParameter(5, total)
        .setParameter(6, StatusEnum.CREATED.getValue())
        .executeUpdate();
    Optional&lt;CartEntity&gt; oCart = cRepo.findByCustomerId(UUID.fromString(m.getCustomerId()));
    // 고객의 장바구니를 찾아서 장바구니가 없으면 ResourceNotFoundException을 발생시킵니다.
    CartEntity cart =
        oCart.orElseThrow(
            () -&gt;
                new ResourceNotFoundException(
                    String.format(
                        &quot;Cart not found for given customer (ID: %s)&quot;, m.getCustomerId())));
    // 장바구니에 있는 모든 아이템을 삭제합니다.
    itemRepo.deleteCartItemJoinById(
        cart.getItems().stream().map(ItemEntity::getId).collect(toList()), cart.getId());
    // 방금 생성한 주문을 데이터베이스에서 찾아서,
    OrderEntity entity =
        (OrderEntity)
            em.createNativeQuery(
                    &quot;&quot;&quot;
        SELECT o.* FROM ecomm.orders o WHERE o.customer_id = ? AND o.order_date &gt;= ?
        &quot;&quot;&quot;, OrderEntity.class)
                .setParameter(1, m.getCustomerId())
                .setParameter(
                    2,
                    OffsetDateTime.ofInstant(orderDate.toInstant(), ZoneId.of(&quot;Z&quot;)) //ZoneId.of(&quot;Z&quot;)는 UTC 시간대를 나타냅니다. &quot;Z&quot;는 Zulu 시간의 약자로, 국제 표준 시간을 의미합니다.
                        .truncatedTo(ChronoUnit.MICROS))
                .getSingleResult();
    // 주문에 아이템을 추가합니다.
    oiRepo.saveAll(
        cart.getItems().stream()
            .map(i -&gt; new OrderItemEntity().setOrderId(entity.getId()).setItemId(i.getId()))
            .collect(toList()));
    // 최종적으로 생성된 주문을 반환합니다.
    return Optional.of(entity);
  }
}

</div><p id="-c0nkc2_427">PaymentRepository.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.repository;">

package com.infosiatec.modern.api.repository;

import com.infosiatec.modern.api.entity.PaymentEntity;
import java.util.UUID;
import org.springframework.data.repository.CrudRepository;

public interface PaymentRepository extends CrudRepository&lt;PaymentEntity, UUID&gt; {
}

</div><p id="-c0nkc2_430">ProductRepository.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.repository;">

package com.infosiatec.modern.api.repository;

import com.infosiatec.modern.api.entity.ProductEntity;
import java.util.UUID;
import org.springframework.data.repository.CrudRepository;

public interface ProductRepository extends CrudRepository&lt;ProductEntity, UUID&gt; {
}

</div><p id="-c0nkc2_433">ShipmentRepository.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.repository;">

package com.infosiatec.modern.api.repository;

import com.infosiatec.modern.api.entity.ShipmentEntity;
import java.util.UUID;
import org.springframework.data.repository.CrudRepository;

public interface ShipmentRepository extends CrudRepository&lt;ShipmentEntity, UUID&gt; {
}

</div><p id="-c0nkc2_436">TagRepository.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.repository;">

package com.infosiatec.modern.api.repository;

import com.infosiatec.modern.api.entity.TagEntity;
import java.util.UUID;
import org.springframework.data.repository.CrudRepository;

public interface TagRepository extends CrudRepository&lt;TagEntity, UUID&gt; {
}

</div><p id="-c0nkc2_439">UserRepository.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.repository;">

package com.infosiatec.modern.api.repository;

import com.infosiatec.modern.api.entity.UserEntity;
import java.util.UUID;
import org.springframework.data.repository.CrudRepository;

public interface UserRepository extends CrudRepository&lt;UserEntity, UUID&gt; {
}

</div></section></section></section><section class="chapter"><h2 id="service_1" data-toc="service_1">4.3 Service 컴포넌트 추가</h2><p id="-c0nkc2_442">@Service 컴포넌트는 Controller와 Repository 사이에서 작동하는 인터페이스이며 비즈니스 로직을 추가하는 곳입니다. 컨트롤러에서 직접 Repository를 호출할 수는 있지만, Repository는 데이터 검색 및 영속성(persistence) 기능의 일부여야 하므로 좋은 방법은 아닙니다. Service 컴포넌트는 또한 데이터를 데이터베이스 및 기타 외부 응용 프로그램과 같은 다양한 소스에서 가져오는 데 사용합니다.</p><p id="-c0nkc2_443">CartService.java를 생성하고 다음과 같이 작성해봅시다.</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.service;">

package com.infosiatec.modern.api.service;

import com.infosiatec.modern.api.entity.CartEntity;
import com.infosiatec.modern.api.model.Item;
import jakarta.validation.Valid;
import java.util.List;

public interface CartService {

  List&lt;Item&gt; addCartItemsByCustomerId(String customerId, @Valid Item item);

  List&lt;Item&gt; addOrReplaceItemsByCustomerId(String customerId, @Valid Item item);

  void deleteCart(String customerId);

  void deleteItemFromCart(String customerId, String itemId);

  CartEntity getCartByCustomerId(String customerId);

  List&lt;Item&gt; getCartItemsByCustomerId(String customerId);

  Item getCartItemsByItemId(String customerId, String itemId);
}

</div><p id="-c0nkc2_446">CartServiceImpl 클래스는 @Service로 주석이 달려 있으므로 자동으로 감지되어 주입 가능합니다. CartRepository, UserRepository 및 ItemService 클래스 의존성은 생성자 주입을 사용하여 주입됩니다.</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.service;">

package com.infosiatec.modern.api.service;

import static java.util.stream.Collectors.toList;
import static org.springframework.objenesis.instantiator.util.UnsafeUtils.getUnsafe;

import com.infosiatec.modern.api.entity.CartEntity;
import com.infosiatec.modern.api.entity.ItemEntity;
import com.infosiatec.modern.api.exception.CustomerNotFoundException;
import com.infosiatec.modern.api.exception.GenericAlreadyExistsException;
import com.infosiatec.modern.api.exception.ItemNotFoundException;
import com.infosiatec.modern.api.model.Item;
import com.infosiatec.modern.api.repository.CartRepository;
import com.infosiatec.modern.api.repository.UserRepository;
import jakarta.validation.Valid;
import java.util.List;
import java.util.Objects;
import java.util.UUID;
import java.util.concurrent.atomic.AtomicBoolean;
import java.util.concurrent.atomic.AtomicReference;
import org.springframework.stereotype.Service;

@Service
public class CartServiceImpl implements CartService {

  private final CartRepository repository;
  private final UserRepository userRepo;
  private final ItemService itemService;

  public CartServiceImpl(CartRepository repository, UserRepository userRepo,
      ItemService itemService) {
    this.repository = repository;
    this.userRepo = userRepo;
    this.itemService = itemService;
  }

  @Override
  public List&lt;Item&gt; addCartItemsByCustomerId(String customerId, @Valid Item item) {
    CartEntity entity = getCartByCustomerId(customerId);
    long count = entity.getItems().stream()
        .filter(i -&gt; i.getProduct().getId().equals(UUID.fromString(item.getId()))).count();
    if (count &gt; 0) {
      throw new GenericAlreadyExistsException(
          String.format(&quot;Item with Id (%s) already exists. You can update it.&quot;, item.getId()));
    }
    entity.getItems().add(itemService.toEntity(item));
    return itemService.toModelList(repository.save(entity).getItems());
  }

  @Override
  public List&lt;Item&gt; addOrReplaceItemsByCustomerId(String customerId, @Valid Item item) {
    CartEntity entity = getCartByCustomerId(customerId);
    List&lt;ItemEntity&gt; items =
        Objects.nonNull(entity.getItems()) ? entity.getItems() : List.of();
    AtomicBoolean itemExists = new AtomicBoolean(false);
    items.forEach(i -&gt; {
      if (i.getProduct().getId().equals(UUID.fromString(item.getId()))) {
        i.setQuantity(item.getQuantity()).setPrice(i.getPrice());
        itemExists.set(true);
      }
    });
    if (!itemExists.get()) {
      items.add(itemService.toEntity(item));
    }
    return itemService.toModelList(repository.save(entity).getItems());
  }

  @Override
  public void deleteCart(String customerId) {
    // will throw the error if it doesn't exist
    CartEntity entity = getCartByCustomerId(customerId);
    repository.deleteById(entity.getId());
  }

  @Override
  public void deleteItemFromCart(String customerId, String itemId) {
    CartEntity entity = getCartByCustomerId(customerId);
    List&lt;ItemEntity&gt; updatedItems = entity.getItems().stream()
        .filter(i -&gt; !i.getProduct().getId().equals(UUID.fromString(itemId))).collect(toList());
    entity.setItems(updatedItems);
    repository.save(entity);
  }

  @Override
  public CartEntity getCartByCustomerId(String customerId) {
    CartEntity entity = repository.findByCustomerId(UUID.fromString(customerId))
        .orElse(new CartEntity());
    if (Objects.isNull(entity.getUser())) {
      entity.setUser(userRepo.findById(UUID.fromString(customerId))
          .orElseThrow(() -&gt; new CustomerNotFoundException(
              String.format(&quot; - %s&quot;, customerId))));
    }
    return entity;
  }

  @Override
  public List&lt;Item&gt; getCartItemsByCustomerId(String customerId) {
    CartEntity entity = getCartByCustomerId(customerId);
    return itemService.toModelList(entity.getItems());
  }

  @Override
  public Item getCartItemsByItemId(String customerId, String itemId) {
    CartEntity entity = getCartByCustomerId(customerId);
    AtomicReference&lt;ItemEntity&gt; itemEntity = new AtomicReference&lt;&gt;();
    entity.getItems().forEach(i -&gt; {
      if (i.getProduct().getId().equals(UUID.fromString(itemId))) {
        itemEntity.set(i);
      }
    });
    if (Objects.isNull(itemEntity.get())) {
      getUnsafe().throwException(new ItemNotFoundException(String.format(&quot; - %s&quot;, itemId)));
    }
    return itemService.toModel(itemEntity.get());
  }
}

</div><p id="-c0nkc2_449">addOrReplaceItemsByCustomerId 라는 메서드 하나만 자세히 살펴봅시다. 이 메서드는 고객 ID를 통해 장바구니를 가져옵니다. 장바구니에 이미 아이템이 있는지 확인하고, 있다면 수량과 가격을 업데이트합니다. 없으면 주어진 항목 모델에서 새 Item 엔티티를 생성한 다음 CartEntity 객체에 저장합니다. 마지막으로 업데이트된 CartEntity 객체가 데이터베이스에 저장됩니다.</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="@Override">

  @Override
  public List&lt;Item&gt; addOrReplaceItemsByCustomerId(String customerId, @Valid Item item) {
    // 고객 ID를 통해 장바구니를 가져옵니다.
    CartEntity entity = getCartByCustomerId(customerId);
    List&lt;ItemEntity&gt; items =
        Objects.nonNull(entity.getItems()) ? entity.getItems() : List.of();
    AtomicBoolean itemExists = new AtomicBoolean(false);
    // 장바구니에 이미 아이템이 있는지 확인하고, 있다면 수량과 가격을 업데이트합니다. 없으면 주어진 항목 모델에서 새 Item 엔티티를 생성한 다음 CartEntity 객체에 저장합니다.
    items.forEach(i -&gt; {
      if (i.getProduct().getId().equals(UUID.fromString(item.getId()))) {
        i.setQuantity(item.getQuantity()).setPrice(i.getPrice());
        itemExists.set(true);
      }
    });
    if (!itemExists.get()) {
      items.add(itemService.toEntity(item));
    }
    // 업데이트된 CartEntity 객체가 데이터베이스에 저장됩니다.
    return itemService.toModelList(repository.save(entity).getItems());
  }

</div><p id="-c0nkc2_452">나머지 서비스들의 코드입니다.</p><p id="-c0nkc2_453">AddressService.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.service;">

package com.infosiatec.modern.api.service;

import com.infosiatec.modern.api.entity.AddressEntity;
import com.infosiatec.modern.api.model.AddAddressReq;
import java.util.Optional;

public interface AddressService {
  Optional&lt;AddressEntity&gt; createAddress(AddAddressReq addAddressReq);

  void deleteAddressesById(String id);

  Optional&lt;AddressEntity&gt; getAddressesById(String id);

  Iterable&lt;AddressEntity&gt; getAllAddresses();
}

</div><p id="-c0nkc2_456">AddressServiceImpl.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.service;">

package com.infosiatec.modern.api.service;

import com.infosiatec.modern.api.entity.AddressEntity;
import com.infosiatec.modern.api.model.AddAddressReq;
import com.infosiatec.modern.api.repository.AddressRepository;
import java.util.Optional;
import java.util.UUID;
import org.springframework.stereotype.Service;

@Service
public class AddressServiceImpl implements AddressService {

  private final AddressRepository repository;

  public AddressServiceImpl(AddressRepository repository) {
    this.repository = repository;
  }

  @Override
  public Optional&lt;AddressEntity&gt; createAddress(AddAddressReq addAddressReq) {
    return Optional.of(repository.save(toEntity(addAddressReq)));
  }

  @Override
  public void deleteAddressesById(String id) {
    repository.deleteById(UUID.fromString(id));
  }

  @Override
  public Optional&lt;AddressEntity&gt; getAddressesById(String id) {
    return repository.findById(UUID.fromString(id));
  }

  @Override
  public Iterable&lt;AddressEntity&gt; getAllAddresses() {
    return repository.findAll();
  }

  private AddressEntity toEntity(AddAddressReq model) {
    AddressEntity entity = new AddressEntity();
    return entity.setNumber(model.getNumber()).setResidency(model.getResidency())
        .setStreet(model.getStreet()).setCity(model.getCity()).setState(model.getState())
        .setCountry(model.getCountry()).setPincode(model.getPincode());
  }
}

</div><p id="-c0nkc2_459">CardService.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.service;">

package com.infosiatec.modern.api.service;

import com.infosiatec.modern.api.entity.CardEntity;
import com.infosiatec.modern.api.model.AddCardReq;
import jakarta.validation.Valid;
import java.util.Optional;

public interface CardService {
  void deleteCardById(String id);
  Iterable&lt;CardEntity&gt; getAllCards();
  Optional&lt;CardEntity&gt; getCardById(String id);
  Optional&lt;CardEntity&gt; registerCard(@Valid AddCardReq addCardReq);
}

</div><p id="-c0nkc2_462">CardServiceImpl.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.service;">

package com.infosiatec.modern.api.service;

import com.infosiatec.modern.api.entity.CardEntity;
import com.infosiatec.modern.api.entity.UserEntity;
import com.infosiatec.modern.api.model.AddCardReq;
import com.infosiatec.modern.api.repository.CardRepository;
import com.infosiatec.modern.api.repository.UserRepository;
import jakarta.validation.Valid;
import java.util.Optional;
import java.util.UUID;
import org.springframework.stereotype.Service;

@Service
public class CardServiceImpl implements CardService {
  private final CardRepository repository;
  private final UserRepository userRepo;

  public CardServiceImpl(CardRepository repository, UserRepository userRepo) {
    this.repository = repository;
    this.userRepo = userRepo;
  }

  @Override
  public void deleteCardById(String id) {
    repository.deleteById(UUID.fromString(id));
  }

  @Override
  public Iterable&lt;CardEntity&gt; getAllCards() {
    return repository.findAll();
  }

  @Override
  public Optional&lt;CardEntity&gt; getCardById(String id) {
    return repository.findById(UUID.fromString(id));
  }

  @Override
  public Optional&lt;CardEntity&gt; registerCard(@Valid AddCardReq addCardReq) {
    // add validation to make sure that only single card exists from one user
    // else it throws DataIntegrityViolationException for user_id (unique)
    return Optional.of(repository.save(toEntity(addCardReq)));
  }

  private CardEntity toEntity(AddCardReq m) {
    CardEntity e = new CardEntity();
    Optional&lt;UserEntity&gt; user = userRepo.findById(UUID.fromString(m.getUserId()));
    user.ifPresent(e::setUser);
    return e.setNumber(m.getCardNumber()).setCvv(m.getCvv())
        .setExpires(m.getExpires());
  }
}

</div><p id="-c0nkc2_465">ItemService.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.service;">

package com.infosiatec.modern.api.service;

import com.infosiatec.modern.api.entity.ItemEntity;
import com.infosiatec.modern.api.model.Item;
import java.util.List;

public interface ItemService {

  ItemEntity toEntity(Item m);

  List&lt;ItemEntity&gt; toEntityList(List&lt;Item&gt; items);

  Item toModel(ItemEntity e);

  List&lt;Item&gt; toModelList(List&lt;ItemEntity&gt; items);
}

</div><p id="-c0nkc2_468">ItemServiceImpl.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.service;">

package com.infosiatec.modern.api.service;

import static java.util.stream.Collectors.toList;

import com.infosiatec.modern.api.entity.ItemEntity;
import com.infosiatec.modern.api.entity.ProductEntity;
import com.infosiatec.modern.api.model.Item;
import java.util.List;
import java.util.Objects;
import java.util.UUID;
import org.springframework.stereotype.Service;

@Service
public class ItemServiceImpl implements ItemService {

  @Override
  public ItemEntity toEntity(Item m) {
    ItemEntity e = new ItemEntity();
    e.setProduct(new ProductEntity().setId(UUID.fromString(m.getId())))
        .setPrice(m.getUnitPrice())
        .setQuantity(m.getQuantity());
    return e;
  }

  @Override
  public List&lt;ItemEntity&gt; toEntityList(List&lt;Item&gt; items) {
    if (Objects.isNull(items)) {
      return List.of();
    }
    return items.stream().map(this::toEntity).collect(toList());
  }

  @Override
  public Item toModel(ItemEntity e) {
    Item m = new Item();
    m.id(e.getProduct().getId().toString()).unitPrice(e.getPrice()).quantity(e.getQuantity());
    return m;
  }

  @Override
  public List&lt;Item&gt; toModelList(List&lt;ItemEntity&gt; items) {
    if (Objects.isNull(items)) {
      return List.of();
    }
    return items.stream().map(this::toModel).collect(toList());
  }
}

</div><p id="-c0nkc2_471">OrderService.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.service;">

package com.infosiatec.modern.api.service;

import com.infosiatec.modern.api.entity.OrderEntity;
import com.infosiatec.modern.api.model.NewOrder;
import jakarta.validation.Valid;
import jakarta.validation.constraints.NotNull;
import java.util.Optional;

public interface OrderService {

  Optional&lt;OrderEntity&gt; addOrder(@Valid NewOrder newOrder);
  Iterable&lt;OrderEntity&gt; getOrdersByCustomerId(@NotNull @Valid String customerId);
  Optional&lt;OrderEntity&gt; getByOrderId(String id);
}

</div><p id="-c0nkc2_474">OrderServiceImpl.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.service;">

package com.infosiatec.modern.api.service;

import com.infosiatec.modern.api.entity.OrderEntity;
import com.infosiatec.modern.api.exception.ResourceNotFoundException;
import com.infosiatec.modern.api.model.NewOrder;
import com.infosiatec.modern.api.repository.OrderRepository;
import jakarta.validation.Valid;
import jakarta.validation.constraints.NotNull;
import java.util.Objects;
import java.util.Optional;
import java.util.UUID;
import org.apache.logging.log4j.util.Strings;
import org.springframework.stereotype.Service;

@Service
public class OrderServiceImpl implements OrderService {

  private final OrderRepository repository;
  private OrderRepository userRepo;

  public OrderServiceImpl(OrderRepository repository) {
    this.repository = repository;
  }

  @Override
  public Optional&lt;OrderEntity&gt; addOrder(@Valid NewOrder newOrder) {
    if (Strings.isEmpty(newOrder.getCustomerId())) {
      throw new ResourceNotFoundException(&quot;Invalid customer id.&quot;);
    }
    if (Objects.isNull(newOrder.getAddress()) || Strings.isEmpty(newOrder.getAddress().getId())) {
      throw new ResourceNotFoundException(&quot;Invalid address id.&quot;);
    }
    if (Objects.isNull(newOrder.getCard()) || Strings.isEmpty(newOrder.getCard().getId())) {
      throw new ResourceNotFoundException(&quot;Invalid card id.&quot;);
    }
    // 1. Save Order
    return repository.insert(newOrder);
    // Ideally, here it will trigger the rest of the process
    // 2. Initiate the payment
    // 3. Once the payment is authorized, change the status to paid
    // 4. Initiate the Shipment and changed the status to Shipment Initiated or Shipped
  }

  @Override
  public Iterable&lt;OrderEntity&gt; getOrdersByCustomerId(@NotNull @Valid String customerId) {
    return repository.findByCustomerId(UUID.fromString(customerId));
  }

  @Override
  public Optional&lt;OrderEntity&gt; getByOrderId(String id) {
    return repository.findById(UUID.fromString(id));
  }
}

</div><p id="-c0nkc2_477">PaymentService.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.service;">

package com.infosiatec.modern.api.service;

import com.infosiatec.modern.api.entity.AuthorizationEntity;
import com.infosiatec.modern.api.model.PaymentReq;
import jakarta.validation.Valid;
import jakarta.validation.constraints.NotNull;
import java.util.Optional;

public interface PaymentService {

  Optional&lt;AuthorizationEntity&gt; authorize(@Valid PaymentReq paymentReq);
  Optional&lt;AuthorizationEntity&gt; getOrdersPaymentAuthorization(@NotNull String orderId);
}

</div><p id="-c0nkc2_480">PaymentServiceImpl.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.service;">

package com.infosiatec.modern.api.service;

import com.infosiatec.modern.api.entity.AuthorizationEntity;
import com.infosiatec.modern.api.entity.OrderEntity;
import com.infosiatec.modern.api.model.PaymentReq;
import com.infosiatec.modern.api.repository.OrderRepository;
import com.infosiatec.modern.api.repository.PaymentRepository;
import jakarta.validation.Valid;
import jakarta.validation.constraints.NotNull;
import java.util.Optional;
import java.util.UUID;
import org.springframework.stereotype.Service;

@Service
public class PaymentServiceImpl implements PaymentService {

  private final PaymentRepository repository;
  private final OrderRepository orderRepo;

  public PaymentServiceImpl(PaymentRepository repository, OrderRepository orderRepo) {
    this.repository = repository;
    this.orderRepo = orderRepo;
  }

  @Override
  public Optional&lt;AuthorizationEntity&gt; authorize(@Valid PaymentReq paymentReq) {
    return Optional.empty();
  }

  @Override
  public Optional&lt;AuthorizationEntity&gt; getOrdersPaymentAuthorization(@NotNull String orderId) {
    return orderRepo.findById(UUID.fromString(orderId)).map(OrderEntity::getAuthorizationEntity);
  }

  /*private AuthorizationEntity toEntity(PaymentReq m) {
    PaymentEntity e = new PaymentEntity();
    e.setAuthorized(true).setMessage()
  }*/
}

</div><p id="-c0nkc2_483">ProductService.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.service;">

package com.infosiatec.modern.api.service;

import com.infosiatec.modern.api.entity.ProductEntity;
import jakarta.validation.constraints.Min;
import jakarta.validation.constraints.NotNull;
import java.util.Optional;
import org.springframework.validation.annotation.Validated;

@Validated
public interface ProductService {
  @NotNull Iterable&lt;ProductEntity&gt; getAllProducts();
  Optional&lt;ProductEntity&gt; getProduct(@Min(value = 1L, message = &quot;Invalid product ID.&quot;) String id);
}

</div><p id="-c0nkc2_486">ProductServiceImpl.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.service;">

package com.infosiatec.modern.api.service;

import com.infosiatec.modern.api.entity.ProductEntity;
import com.infosiatec.modern.api.repository.ProductRepository;
import java.util.Optional;
import java.util.UUID;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

@Service
@Transactional
public class ProductServiceImpl implements ProductService {

  private final ProductRepository repository;

  public ProductServiceImpl(ProductRepository repository) {
    this.repository = repository;
  }

  @Override
  public Iterable&lt;ProductEntity&gt; getAllProducts() {
    return repository.findAll();
  }

  @Override
  public Optional&lt;ProductEntity&gt; getProduct(String id) {
    return repository
        .findById(UUID.fromString(id));
  }
}

</div><p id="-c0nkc2_489">ShipmentService.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.service;">

package com.infosiatec.modern.api.service;

import com.infosiatec.modern.api.entity.ShipmentEntity;
import jakarta.validation.constraints.Min;

public interface ShipmentService {
  Iterable&lt;ShipmentEntity&gt; getShipmentByOrderId(@Min(value = 1L, message = &quot;Invalid product ID.&quot;)  String id);
}

</div><p id="-c0nkc2_492">ShipmentServiceImpl.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.service;">

package com.infosiatec.modern.api.service;

import com.infosiatec.modern.api.entity.ShipmentEntity;
import com.infosiatec.modern.api.repository.ShipmentRepository;
import jakarta.validation.constraints.Min;
import java.util.List;
import java.util.UUID;
import org.springframework.stereotype.Service;

@Service
public class ShipmentServiceImpl implements ShipmentService {

  private final ShipmentRepository repository;

  public ShipmentServiceImpl(ShipmentRepository repository) {
    this.repository = repository;
  }

  @Override
  public Iterable&lt;ShipmentEntity&gt; getShipmentByOrderId(
      @Min(value = 1L, message = &quot;Invalid shipment ID.&quot;) String id) {
    return repository.findAllById(List.of(UUID.fromString(id)));
  }
}

</div><p id="-c0nkc2_495">UserService.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.service;">

package com.infosiatec.modern.api.service;

import com.infosiatec.modern.api.entity.AddressEntity;
import com.infosiatec.modern.api.entity.CardEntity;
import com.infosiatec.modern.api.entity.UserEntity;
import java.util.Optional;

public interface UserService {
  void deleteCustomerById(String id);
  Optional&lt;Iterable&lt;AddressEntity&gt;&gt; getAddressesByCustomerId(String id);
  Iterable&lt;UserEntity&gt; getAllCustomers();
  Optional&lt;CardEntity&gt; getCardByCustomerId(String id);
  Optional&lt;UserEntity&gt; getCustomerById(String id);
}

</div><p id="-c0nkc2_498">UserServiceImpl.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.service;">

package com.infosiatec.modern.api.service;

import com.infosiatec.modern.api.entity.AddressEntity;
import com.infosiatec.modern.api.entity.CardEntity;
import com.infosiatec.modern.api.entity.UserEntity;
import com.infosiatec.modern.api.repository.UserRepository;
import java.util.Optional;
import java.util.UUID;
import org.springframework.stereotype.Service;

@Service
public class UserServiceImpl implements UserService {

  private final UserRepository repository;

  public UserServiceImpl(UserRepository repository) {
    this.repository = repository;
  }

  @Override
  public void deleteCustomerById(String id) {
    repository.deleteById(UUID.fromString(id));
  }

  @Override
  public Optional&lt;Iterable&lt;AddressEntity&gt;&gt; getAddressesByCustomerId(String id) {
    return repository.findById(UUID.fromString(id)).map(UserEntity::getAddresses);
  }

  @Override
  public Iterable&lt;UserEntity&gt; getAllCustomers() {
    return repository.findAll();
  }

  @Override
  public Optional&lt;CardEntity&gt; getCardByCustomerId(String id) {
    return Optional.of(repository.findById(UUID.fromString(id)).map(UserEntity::getCard).get().get(0));
  }

  @Override
  public Optional&lt;UserEntity&gt; getCustomerById(String id) {
    return repository.findById(UUID.fromString(id));
  }
}

</div></section><section class="chapter"><h2 id="4-4-hypermedia" data-toc="4-4-hypermedia">4.4 Hypermedia 구현</h2><p id="-c0nkc2_501">1장에서 하이퍼미디어와 HATEOAS에 대해서 배웠습니다. 스프링에서는 <span id="-c0nkc2_502"><b><font style="color:#ff7f50">org.springframework.boot:spring-boot-starter-hateoas</font></b></span> 의존성을 추가하여 HATEOAS를 지원 제공합니다.</p><p id="-c0nkc2_503">먼저, API 응답의 일부로 반환된 모든 모델이 링크 필드를 포함하는지 확인해야 합니다. 이를 위해 모든 모델에 링크를 추가하는 방법을 알아보겠습니다.</p><div class="code-block" data-lang="java">
import static org.springframework.hateoas.server.mvc.WebMvcLinkBuilder.linkTo;
import static org.springframework.hateoas.server.mvc. WebMvcLinkBuilder.methodOn;

// other code block

responseModel.setSelf(linkTo(methodOn(CartController.class).getItemsByUserId(userId,item)).withSelfRel());
</div><p id="-c0nkc2_505">여기서 responseModel은 API에 의해 반환되는 모델 객체입니다. linkTo 및 methodOn 정적 메서드를 사용하여 설정된 _self라는 필드가 있습니다. linkTo 및 methodOn 메서드는 Spring HATEOAS 라이브러리에서 제공되며 특정 컨트롤러 메서드에 대한 self-link를 생성할 수 있게 합니다.</p><p id="-c0nkc2_506">위 작업은 수동이지만 Spring HATEOAS의 RepresentationModelAssembler 인터페이스를 사용하여 자동으로 수행할 수도 있습니다.</p><ul class="list _bullet" id="-c0nkc2_507"><li class="list__item" id="-c0nkc2_508"><p>RepresentationModel: Model/DTO 클래스에 링크를 추가하는 데 사용됩니다.</p></li><li class="list__item" id="-c0nkc2_509"><p>EntityModel: RepresentationModel을 확장하며 모델 내부를 private 필드로 래핑(wraping)합니다. 모델을 포함, 링크를 추가하는 데 사용됩니다.</p></li><li class="list__item" id="-c0nkc2_510"><p>CollectionModel: CollectionModel은 RepresentationModel도 확장합니다. 모델 컬렉션을 감싸고 링크를 유지하고 저장하는 메서드를 제공합니다.</p></li><li class="list__item" id="-c0nkc2_511"><p>PageModel: PageModel은 CollectionModel을 확장하며 getNextLink() 및 getPreviousLink(), getTotalPages()와 같은 페이지 정보를 추가합니다.</p></li></ul><p id="-c0nkc2_512">구현하는 방법을 간단히 살펴보겠습니다.</p><div class="code-block" data-lang="java">
public class Cart extends RepresentationModel&lt;Cart&gt; implements Serializable {
  
  private static final long serialVersionUID = 1L;
  
  @JsonProperty(&quot;id&quot;)
  private String id;
  
  @JsonProperty(&quot;customerId&quot;)
  @JacksonXmlProperty(localName = &quot;customerId&quot;)
  private String customerId;
  
  @JsonProperty(&quot;items&quot;)
  @JacksonXmlProperty(localName = &quot;items&quot;)
  @Valid
  private List&lt;Item&gt; items = null;
  
  ...생략...
</div><p id="-c0nkc2_514">RepresentationModel을 확장하면 getLink(), hasLink(), add()를 포함한 추가 메서드로 모델을 보강할 수 있습니다.</p><p id="-c0nkc2_515">모든 모델이 OpenAPI Codegen에 의해 생성되고 있음을 기억하세요. 따라서 하이퍼미디어를 지원하는 새로운 모델을 생성하기 위해 OpenAPI Codegen을 설정해야 합니다. config.json 파일을 사용하여 작업할 수 있습니다.</p><div class="code-block" data-lang="json">
{
  // …
  &quot;apiPackage&quot;: &quot;com.infosiatec.modern.api&quot;,
  &quot;invokerPackage&quot;: &quot;com.infosiatec.modern.api&quot;,
  &quot;serializableModel&quot;: true,
  &quot;useTags&quot;: true,
  &quot;useGzipFeature&quot;: true,
  &quot;hateoas&quot;: true,
  &quot;unhandledException&quot;: true,
  // …
}
</div><p id="-c0nkc2_517">hateoas 속성을 추가하고 true로 설정하면 RepresentationModel 클래스를 확장하는 모델이 자동으로 생성됩니다.</p><p id="-c0nkc2_518">이제 링크가 적절한 URL로 자동으로 채워지도록 해야 합니다. 이를 위해 RepresentationModelAssemblerSupport 추상 클래스를 확장할 것이며, 이 클래스는 내부적으로 RepresentationModelAssembler를 구현합니다. <span id="-c0nkc2_519"><b><font style="color:#ff7f50">com.infosiatec.modern.api.hateoas</font></b></span> 다음 코드 블록에 표시된 대로 Cart에 대한 어셈블러를 작성해 봅시다.</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.hateoas;">

package com.infosiatec.modern.api.hateoas;

import static java.util.stream.Collectors.toList;
import static org.springframework.hateoas.server.mvc.WebMvcLinkBuilder.linkTo;
import static org.springframework.hateoas.server.mvc.WebMvcLinkBuilder.methodOn;

import com.infosiatec.modern.api.controller.CartsController;
import com.infosiatec.modern.api.entity.CartEntity;
import com.infosiatec.modern.api.model.Cart;
import com.infosiatec.modern.api.service.ItemService;
import java.util.List;
import java.util.Objects;
import java.util.stream.StreamSupport;
import org.springframework.beans.BeanUtils;
import org.springframework.hateoas.server.mvc.RepresentationModelAssemblerSupport;
import org.springframework.stereotype.Component;

@Component
public class CartRepresentationModelAssembler extends RepresentationModelAssemblerSupport&lt;CartEntity, Cart&gt; {

  private final ItemService itemService;

  /**
   * Creates a new {@link RepresentationModelAssemblerSupport} using the given controller class and
   * resource type.
   */
  public CartRepresentationModelAssembler(ItemService itemService) {
      super(CartsController.class, Cart.class);
      this.itemService = itemService;
  }

  /**
   * Coverts the Card entity to resource
   *
   * @param entity
   */
  @Override
  public Cart toModel(CartEntity entity) {
      String uid = Objects.nonNull(entity.getUser()) ? entity.getUser().getId().toString() : null;
      String cid = Objects.nonNull(entity.getId()) ? entity.getId().toString() : null;
      Cart resource = new Cart();
      BeanUtils.copyProperties(entity, resource);
      resource.id(cid).customerId(uid).items(itemService.toModelList(entity.getItems()));
      resource.add(linkTo(methodOn(CartsController.class).getCartByCustomerId(uid)).withSelfRel());
      resource.add(linkTo(methodOn(CartsController.class).getCartItemsByCustomerId(uid))
          .withRel(&quot;cart-items&quot;));
      return resource;
  }

  /**
   * Coverts the collection of Product entities to list of resources.
   *
   * @param entities
   */
  public List&lt;Cart&gt; toListModel(Iterable&lt;CartEntity&gt; entities) {
      if (Objects.isNull(entities)) {
        return List.of();
      }
      return StreamSupport.stream(entities.spliterator(), false).map(this::toModel)
          .collect(toList());
  }
}

</div><p id="-c0nkc2_522">Cart 어셈블러의 중요한 부분은 RepresentationModelAssemblerSupport를 상속받고 toModel() 메서드를 오버라이드하는 것입니다. 코드를 살펴보면 super() 호출을 통해 CartController.class와 Cart 모델이 전달된다는 것을 알 수 있습니다. 이를 통해 어셈블러가 이전에 공유된 methodOn 메서드에 필요한대로 링크를 적절하게 생성할 수 있습니다. 이렇게 하면 링크를 자동으로 생성할 수 있습니다.</p><p id="-c0nkc2_523">나머지 RepresentationModelAssembler는 아래 코드를 참조하세요.</p><p id="-c0nkc2_524">AddressRepresentationModelAssembler.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.hateoas;">

package com.infosiatec.modern.api.hateoas;

import static java.util.stream.Collectors.toList;
import static org.springframework.hateoas.server.mvc.WebMvcLinkBuilder.linkTo;
import static org.springframework.hateoas.server.mvc.WebMvcLinkBuilder.methodOn;

import com.infosiatec.modern.api.controller.AddressController;
import com.infosiatec.modern.api.entity.AddressEntity;
import com.infosiatec.modern.api.model.Address;
import java.util.List;
import java.util.Objects;
import java.util.stream.StreamSupport;
import org.springframework.beans.BeanUtils;
import org.springframework.hateoas.server.mvc.RepresentationModelAssemblerSupport;
import org.springframework.stereotype.Component;

@Component
public class AddressRepresentationModelAssembler extends
    RepresentationModelAssemblerSupport&lt;AddressEntity, Address&gt; {

  /**
   * Creates a new {@link RepresentationModelAssemblerSupport} using the given controller class and
     * resource type.
     */
  public AddressRepresentationModelAssembler() {
      super(AddressController.class, Address.class);
  }

  /**
   * Coverts the Address entity to resource
     *
     * @param entity
     */
  @Override
  public Address toModel(AddressEntity entity) {
      Address resource = createModelWithId(entity.getId(), entity);
      BeanUtils.copyProperties(entity, resource);
      resource.setId(entity.getId().toString());
      // Self link generated by createModelWithId has missing api path. Therefore, generating additionally.
      // can be removed once fixed.
      resource.add(
          linkTo(methodOn(AddressController.class).getAddressesById(entity.getId().toString()))
              .withSelfRel());
      return resource;
  }

  /**
   * Coverts the collection of Product entities to list of resources.
     *
     * @param entities
     */
  public List&lt;Address&gt; toListModel(Iterable&lt;AddressEntity&gt; entities) {
      if (Objects.isNull(entities)) {
        return List.of();
      }
      return StreamSupport.stream(entities.spliterator(), false).map(this::toModel)
          .collect(toList());
  }
}

</div><p id="-c0nkc2_527">AddressRepresentationModelAssembler.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis=""></div><p id="-c0nkc2_529">CardRepresentationModelAssembler.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.hateoas;">

package com.infosiatec.modern.api.hateoas;

import static java.util.stream.Collectors.toList;
import static org.springframework.hateoas.server.mvc.WebMvcLinkBuilder.linkTo;
import static org.springframework.hateoas.server.mvc.WebMvcLinkBuilder.methodOn;

import com.infosiatec.modern.api.controller.CardController;
import com.infosiatec.modern.api.entity.CardEntity;
import com.infosiatec.modern.api.model.Card;
import java.util.List;
import java.util.Objects;
import java.util.stream.StreamSupport;
import org.springframework.beans.BeanUtils;
import org.springframework.hateoas.server.mvc.RepresentationModelAssemblerSupport;
import org.springframework.stereotype.Component;

@Component
public class CardRepresentationModelAssembler extends
    RepresentationModelAssemblerSupport&lt;CardEntity, Card&gt; {

  /**
   * Creates a new {@link RepresentationModelAssemblerSupport} using the given controller class and
     * resource type.
     */
  public CardRepresentationModelAssembler() {
      super(CardController.class, Card.class);
  }

  /**
   * Coverts the Card entity to resource
     * @param entity
     * @return
     */
  @Override
  public Card toModel(CardEntity entity) {
      String uid = Objects.nonNull(entity.getUser()) ? entity.getUser().getId().toString() : null;
      Card resource = createModelWithId(entity.getId(), entity);
      BeanUtils.copyProperties(entity, resource);
      resource.id(entity.getId().toString()).cardNumber(entity.getNumber())
       .cvv(entity.getCvv()).expires(entity.getExpires()).userId(uid);
      // Self link generated by createModelWithId has missing api path. Therefore, generating additionally.
      // can be removed once fixed.
      resource.add(linkTo(methodOn(CardController.class).getCardById(entity.getId().toString())).withSelfRel());
      return resource;
  }

  /**
   * Coverts the collection of Product entities to list of resources.
     * @param entities
     * @return
     */
  public List&lt;Card&gt; toListModel(Iterable&lt;CardEntity&gt; entities) {
      if (Objects.isNull(entities)) return List.of();
      return StreamSupport.stream(entities.spliterator(), false).map(this::toModel).collect(toList());
  }
}

</div><p id="-c0nkc2_532">OrderRepresentationModelAssembler.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.hateoas;">

package com.infosiatec.modern.api.hateoas;

import static java.util.stream.Collectors.toList;
import static org.springframework.hateoas.server.mvc.WebMvcLinkBuilder.linkTo;
import static org.springframework.hateoas.server.mvc.WebMvcLinkBuilder.methodOn;

import com.infosiatec.modern.api.controller.OrderController;
import com.infosiatec.modern.api.entity.OrderEntity;
import com.infosiatec.modern.api.model.Order;
import com.infosiatec.modern.api.service.ItemService;
import java.time.ZoneOffset;
import java.util.List;
import java.util.Objects;
import java.util.stream.StreamSupport;
import org.springframework.beans.BeanUtils;
import org.springframework.hateoas.server.mvc.RepresentationModelAssemblerSupport;
import org.springframework.stereotype.Component;

@Component
public class OrderRepresentationModelAssembler extends
    RepresentationModelAssemblerSupport&lt;OrderEntity, Order&gt; {

  private final UserRepresentationModelAssembler uAssembler;
  private final AddressRepresentationModelAssembler aAssembler;
  private final CardRepresentationModelAssembler cAssembler;
  private final ShipmentRepresentationModelAssembler sAssembler;
  private final ItemService itemService;

  /**
   * Creates a new {@link RepresentationModelAssemblerSupport} using the given controller class and
     * resource type.
     */
  public OrderRepresentationModelAssembler(UserRepresentationModelAssembler uAssembler,
        AddressRepresentationModelAssembler aAssembler, CardRepresentationModelAssembler cAssembler,
        ShipmentRepresentationModelAssembler sAssembler, ItemService itemService) {
      super(OrderController.class, Order.class);
      this.uAssembler = uAssembler;
      this.aAssembler = aAssembler;
      this.cAssembler = cAssembler;
      this.sAssembler = sAssembler;
      this.itemService = itemService;
  }

  /**
   * Coverts the Order entity to resource
     *
     * @param entity
     */
  @Override
  public Order toModel(OrderEntity entity) {
      System.out.println(&quot;\n\n\nentity = &quot; + entity);
      Order resource = createModelWithId(entity.getId(), entity);
      BeanUtils.copyProperties(entity, resource);
      resource.id(entity.getId().toString())
          .customer(uAssembler.toModel(entity.getUserEntity()))
          .address(aAssembler.toModel(entity.getAddressEntity()))
          .card(cAssembler.toModel(entity.getCardEntity()))
          .items(itemService.toModelList(entity.getItems()))
          .date(entity.getOrderDate().toInstant().atOffset(ZoneOffset.UTC));
      System.out.println(&quot;resource = &quot; + resource);
      // Self link generated by createModelWithId has missing api path. Therefore, generating additionally.
      // can be removed once fixed.
      resource.add(linkTo(methodOn(OrderController.class).getByOrderId(entity.getId().toString()))
          .withSelfRel());
      return resource;
  }

  /**
   * Coverts the collection of Product entities to list of resources.
     *
     * @param entities
     */
  public List&lt;Order&gt; toListModel(Iterable&lt;OrderEntity&gt; entities) {
      if (Objects.isNull(entities)) {
        return List.of();
      }
      return StreamSupport.stream(entities.spliterator(), false).map(this::toModel)
          .collect(toList());
  }
}

</div><p id="-c0nkc2_535">PaymentRepresentationModelAssembler.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.hateoas;">

package com.infosiatec.modern.api.hateoas;

import static java.util.stream.Collectors.toList;
import static org.springframework.hateoas.server.mvc.WebMvcLinkBuilder.linkTo;
import static org.springframework.hateoas.server.mvc.WebMvcLinkBuilder.methodOn;

import com.infosiatec.modern.api.controller.PaymentController;
import com.infosiatec.modern.api.entity.PaymentEntity;
import com.infosiatec.modern.api.model.Payment;
import java.util.List;
import java.util.Objects;
import java.util.stream.StreamSupport;
import org.springframework.beans.BeanUtils;
import org.springframework.hateoas.server.mvc.RepresentationModelAssemblerSupport;
import org.springframework.stereotype.Component;

@Component
public class PaymentRepresentationModelAssembler extends
    RepresentationModelAssemblerSupport&lt;PaymentEntity, Payment&gt; {

  /**
   * Creates a new {@link RepresentationModelAssemblerSupport} using the given controller class and
     * resource type.
     */
  public PaymentRepresentationModelAssembler() {
      super(PaymentController.class, Payment.class);
  }

  /**
   * Coverts the Payment entity to resource
     *
     * @param entity
     */
  @Override
  public Payment toModel(PaymentEntity entity) {
      Payment resource = createModelWithId(entity.getId(), entity);
      BeanUtils.copyProperties(entity, resource);
      resource.setId(entity.getId().toString());
      // Self link generated by createModelWithId has missing api path. Therefore, generating additionally.
      // can be removed once fixed.
      resource.add(linkTo(
          methodOn(PaymentController.class).getOrdersPaymentAuthorization(entity.getId().toString()))
          .withSelfRel());
      return resource;
  }

  /**
   * Coverts the collection of Product entities to list of resources.
     *
     * @param entities
     */
  public List&lt;Payment&gt; toListModel(Iterable&lt;PaymentEntity&gt; entities) {
      if (Objects.isNull(entities)) {
        return List.of();
      }
      return StreamSupport.stream(entities.spliterator(), false).map(this::toModel)
          .collect(toList());
  }

}

</div><p id="-c0nkc2_538">ProductRepresentationModelAssembler.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.hateoas;">

package com.infosiatec.modern.api.hateoas;

import static java.util.stream.Collectors.toList;
import static org.springframework.hateoas.server.mvc.WebMvcLinkBuilder.linkTo;
import static org.springframework.hateoas.server.mvc.WebMvcLinkBuilder.methodOn;

import com.infosiatec.modern.api.controller.ProductController;
import com.infosiatec.modern.api.entity.ProductEntity;
import com.infosiatec.modern.api.model.Product;
import com.infosiatec.modern.api.model.Tag;
import java.util.List;
import java.util.Objects;
import java.util.stream.StreamSupport;
import org.springframework.beans.BeanUtils;
import org.springframework.hateoas.server.mvc.RepresentationModelAssemblerSupport;
import org.springframework.stereotype.Component;

@Component
public class ProductRepresentationModelAssembler extends
    RepresentationModelAssemblerSupport&lt;ProductEntity, Product&gt; {

  /**
   * Creates a new {@link RepresentationModelAssemblerSupport} using the given controller class and
     * resource type.
     */
  public ProductRepresentationModelAssembler() {
      super(ProductController.class, Product.class);
  }

  /**
   * Coverts the Product entity to resource
     *
     * @param entity
     */
  @Override
  public Product toModel(ProductEntity entity) {
      Product resource = createModelWithId(entity.getId(), entity);
      BeanUtils.copyProperties(entity, resource);
      resource.setId(entity.getId().toString());
      resource.setTag(
          entity.getTags().stream().map(t -&gt; new Tag().id(t.getId().toString()).name(t.getName()))
              .collect(toList()));
      // Self link generated by createModelWithId has missing api path. Therefore, generating additionally.
      // can be removed once fixed.
      resource.add(linkTo(methodOn(ProductController.class).getProduct(entity.getId().toString()))
          .withSelfRel());
      resource.add(linkTo(methodOn(ProductController.class).queryProducts(null, null, 1, 10))
          .withRel(&quot;products&quot;));
      return resource;
  }

  /**
   * Coverts the collection of Product entities to list of resources.
     *
     * @param entities
     */
  public List&lt;Product&gt; toListModel(Iterable&lt;ProductEntity&gt; entities) {
      if (Objects.isNull(entities)) {
        return List.of();
      }
      return StreamSupport.stream(entities.spliterator(), false).map(this::toModel)
          .collect(toList());
  }
}

</div><p id="-c0nkc2_541">ShipmentRepresentationModelAssembler.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.hateoas;">

package com.infosiatec.modern.api.hateoas;

import static java.util.stream.Collectors.toList;
import static org.springframework.hateoas.server.mvc.WebMvcLinkBuilder.linkTo;
import static org.springframework.hateoas.server.mvc.WebMvcLinkBuilder.methodOn;

import com.infosiatec.modern.api.controller.ShipmentController;
import com.infosiatec.modern.api.entity.ShipmentEntity;
import com.infosiatec.modern.api.model.Shipment;
import java.util.List;
import java.util.Objects;
import java.util.stream.StreamSupport;
import org.springframework.beans.BeanUtils;
import org.springframework.hateoas.server.mvc.RepresentationModelAssemblerSupport;
import org.springframework.stereotype.Component;

@Component
public class ShipmentRepresentationModelAssembler extends
    RepresentationModelAssemblerSupport&lt;ShipmentEntity, Shipment&gt; {

  /**
   * Creates a new {@link RepresentationModelAssemblerSupport} using the given controller class and
     * resource type.
     */
  public ShipmentRepresentationModelAssembler() {
      super(ShipmentController.class, Shipment.class);
  }

  /**
   * Coverts the Shipment entity to resource
     * @param entity
     * @return
     */
  @Override
  public Shipment toModel(ShipmentEntity entity) {
      Shipment resource = createModelWithId(entity.getId(), entity);
      BeanUtils.copyProperties(entity, resource);
      resource.setId(entity.getId().toString());
      // Self link generated by createModelWithId has missing api path. Therefore, generating additionally.
      // can be removed once fixed.
      resource.add(linkTo(methodOn(ShipmentController.class).getShipmentByOrderId(entity.getId().toString())).withRel(&quot;byOrderId&quot;));
      return resource;
  }

  /**
   * Coverts the collection of Product entities to list of resources.
     * @param entities
     * @return
     */
  public List&lt;Shipment&gt; toListModel(Iterable&lt;ShipmentEntity&gt; entities) {
      if (Objects.isNull(entities)) return List.of();
      return StreamSupport.stream(entities.spliterator(), false).map(this::toModel).collect(toList());
  }
}

</div><p id="-c0nkc2_544">UserRepresentationModelAssembler.java</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="package com.infosiatec.modern.api.hateoas;">

package com.infosiatec.modern.api.hateoas;

import static java.util.stream.Collectors.toList;
import static org.springframework.hateoas.server.mvc.WebMvcLinkBuilder.linkTo;
import static org.springframework.hateoas.server.mvc.WebMvcLinkBuilder.methodOn;

import com.infosiatec.modern.api.controller.CustomerController;
import com.infosiatec.modern.api.entity.UserEntity;
import com.infosiatec.modern.api.model.User;
import java.util.List;
import java.util.Objects;
import java.util.stream.StreamSupport;
import org.springframework.beans.BeanUtils;
import org.springframework.hateoas.server.mvc.RepresentationModelAssemblerSupport;
import org.springframework.stereotype.Component;

@Component
public class UserRepresentationModelAssembler extends
    RepresentationModelAssemblerSupport&lt;UserEntity, User&gt; {

  /**
   * Creates a new {@link RepresentationModelAssemblerSupport} using the given controller class and
     * resource type.
     */
  public UserRepresentationModelAssembler() {
      super(CustomerController.class, User.class);
  }

  /**
   * Coverts the User entity to resource
     *
     * @param entity
     */
  @Override
  public User toModel(UserEntity entity) {
      User resource = createModelWithId(entity.getId(), entity);
      BeanUtils.copyProperties(entity, resource);
      resource.setId(entity.getId().toString());
      // Self link generated by createModelWithId has missing api path. Therefore, generating additionally.
      // can be removed once fixed.
      resource.add(
          linkTo(methodOn(CustomerController.class).getCustomerById(entity.getId().toString()))
              .withSelfRel());
      resource.add(
          linkTo(methodOn(CustomerController.class).getAllCustomers()).withRel(&quot;customers&quot;));
      resource
          .add(
              linkTo(methodOn(CustomerController.class)
                  .getAddressesByCustomerId(entity.getId().toString())).withRel(&quot;self_addresses&quot;));
      return resource;
  }

  /**
   * Coverts the collection of Product entities to list of resources.
     *
     * @param entities
     */
  public List&lt;User&gt; toListModel(Iterable&lt;UserEntity&gt; entities) {
      if (Objects.isNull(entities)) {
        return List.of();
      }
      return StreamSupport.stream(entities.spliterator(), false).map(this::toModel)
          .collect(toList());
  }

}

</div></section><section class="chapter"><h2 id="4-5-hateoas-service-controller" data-toc="4-5-hateoas-service-controller">4.5 HATEOAS와 Service를 통한 Controller 강화</h2><p id="-c0nkc2_547">이제 HATEOAS를 사용하여 API 응답에 링크를 추가하는 방법을 알았습니다. 이제 이를 사용하여 컨트롤러를 강화하는 방법을 살펴보겠습니다.</p><div class="code-block" data-lang="java">

@RestControllerpublic class CartsController implements CartApi {

    private CartService service;
    private final CartRepresentationModelAssembler assembler;

    public CartsController(CartService service, CartRepresentationModelAssembler assembler) {
        this.service = service;
        this.assembler = assembler;
    }
...생략...
}

</div><p id="-c0nkc2_550">CartService 및 CartRepresentationModelAssembler가 생성자를 통해 주입되는 것을 볼 수 있습니다. Spring 컨테이너는 이러한 종속성을 런타임에 주입합니다. 그후 다음 코드에 표시된대로 사용할 수 있습니다.</p><div class="code-block" data-lang="java">

@Override
public ResponseEntity&lt;Cart&gt; getCartByCustomerId(String customerId) {
    return ok(assembler.toModel(service.getCartByCustomerId(customerId)));
}

</div><p id="-c0nkc2_553">고객 ID를 Service에 넘겨주고(내부적으로는 Repository 통해 검색) 조회된 Cart 엔티티는 Spring HATEOAS의 RepresentationModelAssemblerSupport 클래스에서 제공되는 하이퍼미디어 링크를 포함하는 모델로 변환됩니다. ResponseEntity의 ok() 정적 메서드는 200 OK 상태를 포함하는 반환된 모델을 래핑하는 데 사용됩니다.</p></section><section class="chapter"><h2 id="4-6-api-etag" data-toc="4-6-api-etag">4.6 API에 ETag 추가하기 (필수 아님)</h2><p id="-c0nkc2_554">ETag는 HTTP 응답 헤더에 포함되는 엔터티 태그입니다. 이는 클라이언트가 서버로부터 받은 리소스의 버전을 식별하는 데 사용됩니다. 클라이언트는 이전에 받은 ETag를 서버에 전달하여 리소스가 변경되었는지 확인할 수 있습니다. 서버는 ETag를 사용하여 클라이언트에게 리소스가 변경되었는지 알려줍니다.</p><p id="-c0nkc2_555">일단 Etag를 스프링에 적용하기 전에 curl 명령으로 제품 정보 조회 API를 호출해봅시다.</p><div class="code-collapse" data-lang="bash" data-is-expanded="false" data-synopsis="❯ curl -v --location --request GET 'http://localhost:38080/api/v1/products/6d62d909-f957-430e-8689-b5129c0bb75e' –-header 'Content-Type: application/json' --header 'Accept: application/json'">

❯ curl -v --location --request GET 'http://localhost:38080/api/v1/products/6d62d909-f957-430e-8689-b5129c0bb75e' –-header 'Content-Type: application/json' --header 'Accept: application/json'
&gt; GET /api/v1/products/6d62d909-f957-430e-8689-b5129c0bb75e HTTP/1.1
&gt; Host: localhost:38080
&gt; User-Agent: curl/8.6.0
&gt; Accept: application/json
&gt;
&lt; HTTP/1.1 200
&lt; Content-Type: application/json
&lt; Transfer-Encoding: chunked
&lt; Date: Tue, 18 Jun 2024 04:59:03 GMT
&lt;
{
  &quot;_links&quot;:
    {
      &quot;self&quot;:
        [
          {
            &quot;href&quot;: &quot;http://localhost:38080/6d62d909-f957-430e-8689-b5129c0bb75e&quot;,
          },
          {
            &quot;href&quot;: &quot;http://localhost:38080/api/v1/products/6d62d909-f957-430e-8689-b5129c0bb75e&quot;,
          },
        ],
...생략...

</div><p id="-c0nkc2_557">응답에 Etag 정보가 없는 것을 확인할 수 있습니다. <span id="-c0nkc2_558"><b><font style="color:#ff7f50">com.infosiatec.modern.api.config</font></b></span> 패키지를 생성한 후 AppConfig 클래스를 추가합니다.</p><div class="code-block" data-lang="java">

package com.infosiatec.modern.api.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.filter.ShallowEtagHeaderFilter;

@Configuration
public class AppConfig {

  @Bean
  public ShallowEtagHeaderFilter shallowEtagHeaderFilter() {
    return new ShallowEtagHeaderFilter();
  }
}

</div><p id="-c0nkc2_561">단순히 ShallowEtagHeaderFilter 설정을 추가하는 것만으로 Etag를 사용할 수 있습니다. 이제 다시 curl 명령을 사용하여 API를 호출해봅시다.</p><div class="code-collapse" data-lang="bash" data-is-expanded="false" data-synopsis="❯ curl -v --location --request GET 'http://localhost:38080/api/v1/products/6d62d909-f957-430e-8689-b5129c0bb75e' –-header 'Content-Type: application/json' --header 'Accept: application/json'">

❯ curl -v --location --request GET 'http://localhost:38080/api/v1/products/6d62d909-f957-430e-8689-b5129c0bb75e' –-header 'Content-Type: application/json' --header 'Accept: application/json'
&gt; GET /api/v1/products/6d62d909-f957-430e-8689-b5129c0bb75e HTTP/1.1
&gt; Host: localhost:38080
&gt; User-Agent: curl/8.6.0
&gt; Accept: application/json
&gt;
&lt; HTTP/1.1 200
&lt; ETag: &quot;03569cd9ec69a44d031cda295f3596c20&quot;
&lt; Content-Type: application/json
&lt; Content-Length: 634
&lt; Date: Tue, 18 Jun 2024 05:20:58 GMT
&lt;
{
  &quot;_links&quot;:
    {
      &quot;self&quot;:
        [
          {
            &quot;href&quot;: &quot;http://localhost:38080/6d62d909-f957-430e-8689-b5129c0bb75e&quot;,
          },
          {
            &quot;href&quot;: &quot;http://localhost:38080/api/v1/products/6d62d909-f957-430e-8689-b5129c0bb75e&quot;,
          },
        ],
...생략...

</div><p id="-c0nkc2_563">Etag가 생긴것을 알 수 있습니다. 이제 클라이언트는 이전에 받은 Etag를 서버에 전달하여 리소스가 변경되었는지 확인할 수 있습니다. ETag 헤더에서 값을 복사하여 If-None-Match 헤더로 전송하고 If-None-Match 헤더를 사용하여 동일한 요청을 다시 보내면 서버는 리소스가 변경되지 않았음을 알려줍니다.</p><div class="code-collapse" data-lang="bash" data-is-expanded="false" data-synopsis="❯ curl -v --location --request GET 'http://localhost:38080/api/v1/products/6d62d909-f957-430e-8689-b5129c0bb75e' --header 'Content-Type: application/json' --header 'Accept: application/json' --header 'If-None-Match: &quot;03569cd9ec69a44d031cda295f3596c20&quot;'">

❯ curl -v --location --request GET 'http://localhost:38080/api/v1/products/6d62d909-f957-430e-8689-b5129c0bb75e' --header 'Content-Type: application/json' --header 'Accept: application/json' --header 'If-None-Match: &quot;03569cd9ec69a44d031cda295f3596c20&quot;'
&gt; GET /api/v1/products/6d62d909-f957-430e-8689-b5129c0bb75e HTTP/1.1
&gt; Host: localhost:38080
&gt; User-Agent: curl/8.6.0
&gt; Content-Type: application/json
&gt; Accept: application/json
&gt; If-None-Match: &quot;03569cd9ec69a44d031cda295f3596c20&quot;
&gt;
&lt; HTTP/1.1 304
&lt; ETag: &quot;03569cd9ec69a44d031cda295f3596c20&quot;
&lt; Date: Tue, 18 Jun 2024 05:27:55 GMT
&lt;

</div><p id="-c0nkc2_565">데이터베이스의 엔티티에 변경 사항이 없으므로 동일한 엔티티를 포함하고 있습니다. 따라서 200 OK 응답을 보내는 대신 304(변경되지 않음) 응답을 보냅니다.</p><p id="-c0nkc2_566">스프링은 응답에 기록된 캐시된 내용으로부터 MD5 해시를 계산합니다. 다음 요청이 If-None-Match 헤더를 포함하여 도착하면, 다시 한번 응답에 기록된 캐시된 내용으로부터 MD5 해시를 생성하고 이 두 해시를 비교합니다. 두 해시가 동일하면 304 NOT MODIFIED 응답을 전송합니다. 이렇게 함으로써 대역폭을 절약할 수 있지만, 동일한 CPU 계산이 필요합니다.</p><p id="-c0nkc2_567">HTTP 캐시 제어(org.springframework.http.CacheControl) 클래스를 사용하여 각 변경 시 업데이트되는 버전 또는 유사한 속성을 사용하여 불필요한 CPU 계산을 피하고 더 나은 ETag 처리를 위해 다음과 같이 설정할 수 있습니다.</p><div class="code-collapse" data-lang="java" data-is-expanded="false" data-synopsis="return ResponseEntity.ok().cacheControl(CacheControl.maxAge(5, TimeUnit.DAYS))">

return ResponseEntity.ok().cacheControl(CacheControl.maxAge(5, TimeUnit.DAYS))
       .eTag(prodcut.getModifiedDateInEpoch())
       .body(product);

</div><p id="-c0nkc2_570">그래서 Etag는 왜 쓸까요? <br> 응답에 ETag를 추가하면 UI 앱이 페이지/객체 새로 고침이 필요한지 또는 이벤트를 트리거해야 하는지를 결정할 수 있게 해줍니다. 특히 애플리케이션에서 데이터가 자주 변경되는 경우, 실시간 스코어나 주식 시세를 제공하는 경우와 같이요.</p></section><section class="chapter"><h2 id="4-7-api" data-toc="4-7-api">4.7 API 테스트하기</h2><p id="-c0nkc2_572">Imsomnia 또는 Postman과 같은 API 테스트 도구를 사용하여 API를 테스트할 수 있습니다. 이러한 도구를 사용하면 API를 테스트하고 결과를 확인할 수 있습니다. HTTP Archive 파일을 제공하겠습니다. 파일명은 api-collection.har로 합니다. 이 파일을 사용하여 API를 테스트할 수 있습니다.</p><div class="code-collapse" data-lang="json" data-is-expanded="false" data-synopsis="{">

{
  &quot;log&quot;: {
    &quot;version&quot;: &quot;1.2&quot;,
    &quot;creator&quot;: {
      &quot;name&quot;: &quot;Insomnia REST Client&quot;,
      &quot;version&quot;: &quot;insomnia.desktop.app:v2022.4.2&quot;
    },
    &quot;entries&quot;: [
      {
        &quot;startedDateTime&quot;: &quot;2022-11-07T03:12:02.794Z&quot;,
        &quot;time&quot;: 8.283999999999999,
        &quot;request&quot;: {
          &quot;method&quot;: &quot;GET&quot;,
          &quot;url&quot;: &quot;http://localhost:8080/api/v1/carts/a1b9b31d-e73c-4112-af7c-b68530f38222&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/xml&quot;
            },
            {
              &quot;name&quot;: &quot;Accept&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            }
          ],
          &quot;queryString&quot;: [],
          &quot;postData&quot;: {
            &quot;mimeType&quot;: &quot;&quot;,
            &quot;text&quot;: &quot;&quot;,
            &quot;params&quot;: []
          },
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1,
          &quot;settingEncodeUrl&quot;: true
        },
        &quot;response&quot;: {
          &quot;status&quot;: 200,
          &quot;statusText&quot;: &quot;&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;ETag&quot;,
              &quot;value&quot;: &quot;\&quot;0fb7247cc67fc24b8b91193cc448670b3\&quot;&quot;
            },
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Content-Length&quot;,
              &quot;value&quot;: &quot;389&quot;
            },
            {
              &quot;name&quot;: &quot;Date&quot;,
              &quot;value&quot;: &quot;Fri, 04 Nov 2022 13:58:39 GMT&quot;
            }
          ],
          &quot;content&quot;: {
            &quot;size&quot;: 389,
            &quot;mimeType&quot;: &quot;application/json&quot;,
            &quot;text&quot;: &quot;{\&quot;_links\&quot;:{\&quot;self\&quot;:{\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/carts/a1b9b31d-e73c-4112-af7c-b68530f38222\&quot;},\&quot;cart-items\&quot;:{\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/carts/a1b9b31d-e73c-4112-af7c-b68530f38222/items\&quot;}},\&quot;id\&quot;:\&quot;cc65710d-0127-4933-9832-75598230af12\&quot;,\&quot;customerId\&quot;:\&quot;a1b9b31d-e73c-4112-af7c-b68530f38222\&quot;,\&quot;items\&quot;:[{\&quot;id\&quot;:\&quot;3395a43e-2d88-40de-b95f-e00e1502085b\&quot;,\&quot;quantity\&quot;:1,\&quot;unitPrice\&quot;:18.0000}]}&quot;
          },
          &quot;redirectURL&quot;: &quot;&quot;,
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1
        },
        &quot;cache&quot;: {},
        &quot;timings&quot;: {
          &quot;blocked&quot;: -1,
          &quot;dns&quot;: -1,
          &quot;connect&quot;: -1,
          &quot;send&quot;: 0,
          &quot;wait&quot;: 8.283999999999999,
          &quot;receive&quot;: 0,
          &quot;ssl&quot;: -1
        },
        &quot;comment&quot;: &quot;/carts/{customerId}&quot;
      },
      {
        &quot;startedDateTime&quot;: &quot;2022-11-07T03:12:02.794Z&quot;,
        &quot;time&quot;: 92.171,
        &quot;request&quot;: {
          &quot;method&quot;: &quot;DELETE&quot;,
          &quot;url&quot;: &quot;http://localhost:8080/api/v1/carts/a1b9b31d-e73c-4112-af7c-b68530f38222&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/xml&quot;
            },
            {
              &quot;name&quot;: &quot;Accept&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            }
          ],
          &quot;queryString&quot;: [],
          &quot;postData&quot;: {
            &quot;mimeType&quot;: &quot;&quot;,
            &quot;text&quot;: &quot;&quot;,
            &quot;params&quot;: []
          },
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1,
          &quot;settingEncodeUrl&quot;: true
        },
        &quot;response&quot;: {
          &quot;status&quot;: 202,
          &quot;statusText&quot;: &quot;&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;Content-Length&quot;,
              &quot;value&quot;: &quot;0&quot;
            },
            {
              &quot;name&quot;: &quot;Date&quot;,
              &quot;value&quot;: &quot;Mon, 07 Nov 2022 03:06:53 GMT&quot;
            }
          ],
          &quot;content&quot;: {
            &quot;size&quot;: 0,
            &quot;mimeType&quot;: &quot;&quot;,
            &quot;text&quot;: &quot;&quot;
          },
          &quot;redirectURL&quot;: &quot;&quot;,
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1
        },
        &quot;cache&quot;: {},
        &quot;timings&quot;: {
          &quot;blocked&quot;: -1,
          &quot;dns&quot;: -1,
          &quot;connect&quot;: -1,
          &quot;send&quot;: 0,
          &quot;wait&quot;: 92.171,
          &quot;receive&quot;: 0,
          &quot;ssl&quot;: -1
        },
        &quot;comment&quot;: &quot;/carts/{customerId}&quot;
      },
      {
        &quot;startedDateTime&quot;: &quot;2022-11-07T03:12:02.794Z&quot;,
        &quot;time&quot;: 57.679,
        &quot;request&quot;: {
          &quot;method&quot;: &quot;DELETE&quot;,
          &quot;url&quot;: &quot;http://localhost:8080/api/v1/carts/a1b9b31d-e73c-4112-af7c-b68530f38222/items/3395a43e-2d88-40de-b95f-e00e1502085b&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/xml&quot;
            },
            {
              &quot;name&quot;: &quot;Accept&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            }
          ],
          &quot;queryString&quot;: [],
          &quot;postData&quot;: {
            &quot;mimeType&quot;: &quot;&quot;,
            &quot;text&quot;: &quot;&quot;,
            &quot;params&quot;: []
          },
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1,
          &quot;settingEncodeUrl&quot;: true
        },
        &quot;response&quot;: {
          &quot;status&quot;: 202,
          &quot;statusText&quot;: &quot;&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;Content-Length&quot;,
              &quot;value&quot;: &quot;0&quot;
            },
            {
              &quot;name&quot;: &quot;Date&quot;,
              &quot;value&quot;: &quot;Mon, 07 Nov 2022 02:55:51 GMT&quot;
            }
          ],
          &quot;content&quot;: {
            &quot;size&quot;: 0,
            &quot;mimeType&quot;: &quot;&quot;,
            &quot;text&quot;: &quot;&quot;
          },
          &quot;redirectURL&quot;: &quot;&quot;,
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1
        },
        &quot;cache&quot;: {},
        &quot;timings&quot;: {
          &quot;blocked&quot;: -1,
          &quot;dns&quot;: -1,
          &quot;connect&quot;: -1,
          &quot;send&quot;: 0,
          &quot;wait&quot;: 57.679,
          &quot;receive&quot;: 0,
          &quot;ssl&quot;: -1
        },
        &quot;comment&quot;: &quot;/carts/{customerId}/items/{itemId}&quot;
      },
      {
        &quot;startedDateTime&quot;: &quot;2022-11-07T03:12:02.794Z&quot;,
        &quot;time&quot;: 28.944000000000003,
        &quot;request&quot;: {
          &quot;method&quot;: &quot;GET&quot;,
          &quot;url&quot;: &quot;http://localhost:8080/api/v1/carts/a1b9b31d-e73c-4112-af7c-b68530f38222/items/d3588630-ad8e-49df-bbd7-3167f7efb246&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/xml&quot;
            },
            {
              &quot;name&quot;: &quot;Accept&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            }
          ],
          &quot;queryString&quot;: [],
          &quot;postData&quot;: {
            &quot;mimeType&quot;: &quot;&quot;,
            &quot;text&quot;: &quot;&quot;,
            &quot;params&quot;: []
          },
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1,
          &quot;settingEncodeUrl&quot;: true
        },
        &quot;response&quot;: {
          &quot;status&quot;: 404,
          &quot;statusText&quot;: &quot;&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Content-Length&quot;,
              &quot;value&quot;: &quot;299&quot;
            },
            {
              &quot;name&quot;: &quot;Date&quot;,
              &quot;value&quot;: &quot;Mon, 07 Nov 2022 03:06:56 GMT&quot;
            }
          ],
          &quot;content&quot;: {
            &quot;size&quot;: 299,
            &quot;mimeType&quot;: &quot;application/json&quot;,
            &quot;text&quot;: &quot;{\&quot;errorCode\&quot;:\&quot;PACKT-0011\&quot;,\&quot;message\&quot;:\&quot;Requested item not found  - d3588630-ad8e-49df-bbd7-3167f7efb246\&quot;,\&quot;status\&quot;:404,\&quot;url\&quot;:\&quot;http://localhost:8080/api/v1/carts/a1b9b31d-e73c-4112-af7c-b68530f38222/items/d3588630-ad8e-49df-bbd7-3167f7efb246\&quot;,\&quot;reqMethod\&quot;:\&quot;GET\&quot;,\&quot;timestamp\&quot;:\&quot;2022-11-07T03:06:56.695696Z\&quot;}&quot;
          },
          &quot;redirectURL&quot;: &quot;&quot;,
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1
        },
        &quot;cache&quot;: {},
        &quot;timings&quot;: {
          &quot;blocked&quot;: -1,
          &quot;dns&quot;: -1,
          &quot;connect&quot;: -1,
          &quot;send&quot;: 0,
          &quot;wait&quot;: 28.944000000000003,
          &quot;receive&quot;: 0,
          &quot;ssl&quot;: -1
        },
        &quot;comment&quot;: &quot;/carts/{customerId}/items/{itemId}&quot;
      },
      {
        &quot;startedDateTime&quot;: &quot;2022-11-07T03:12:02.794Z&quot;,
        &quot;time&quot;: 7.7860000000000005,
        &quot;request&quot;: {
          &quot;method&quot;: &quot;GET&quot;,
          &quot;url&quot;: &quot;http://localhost:8080/api/v1/carts/a1b9b31d-e73c-4112-af7c-b68530f38222/items&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/xml&quot;
            },
            {
              &quot;name&quot;: &quot;Accept&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            }
          ],
          &quot;queryString&quot;: [],
          &quot;postData&quot;: {
            &quot;mimeType&quot;: &quot;&quot;,
            &quot;text&quot;: &quot;&quot;,
            &quot;params&quot;: []
          },
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1,
          &quot;settingEncodeUrl&quot;: true
        },
        &quot;response&quot;: {
          &quot;status&quot;: 200,
          &quot;statusText&quot;: &quot;&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;ETag&quot;,
              &quot;value&quot;: &quot;\&quot;08af436ed2b449b1b2ad6648c803bcaff\&quot;&quot;
            },
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Content-Length&quot;,
              &quot;value&quot;: &quot;91&quot;
            },
            {
              &quot;name&quot;: &quot;Date&quot;,
              &quot;value&quot;: &quot;Mon, 07 Nov 2022 03:07:39 GMT&quot;
            }
          ],
          &quot;content&quot;: {
            &quot;size&quot;: 91,
            &quot;mimeType&quot;: &quot;application/json&quot;,
            &quot;text&quot;: &quot;[{\&quot;links\&quot;:[],\&quot;id\&quot;:\&quot;3395a43e-2d88-40de-b95f-e00e1502085b\&quot;,\&quot;quantity\&quot;:9,\&quot;unitPrice\&quot;:18.0000}]&quot;
          },
          &quot;redirectURL&quot;: &quot;&quot;,
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1
        },
        &quot;cache&quot;: {},
        &quot;timings&quot;: {
          &quot;blocked&quot;: -1,
          &quot;dns&quot;: -1,
          &quot;connect&quot;: -1,
          &quot;send&quot;: 0,
          &quot;wait&quot;: 7.7860000000000005,
          &quot;receive&quot;: 0,
          &quot;ssl&quot;: -1
        },
        &quot;comment&quot;: &quot;/carts/{customerId}/items&quot;
      },
      {
        &quot;startedDateTime&quot;: &quot;2022-11-07T03:12:02.794Z&quot;,
        &quot;time&quot;: 8.758999999999999,
        &quot;request&quot;: {
          &quot;method&quot;: &quot;POST&quot;,
          &quot;url&quot;: &quot;http://localhost:8080/api/v1/carts/a1b9b31d-e73c-4112-af7c-b68530f38222/items&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Accept&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            }
          ],
          &quot;queryString&quot;: [],
          &quot;postData&quot;: {
            &quot;mimeType&quot;: &quot;application/json&quot;,
            &quot;text&quot;: &quot;{\n    \&quot;id\&quot;: \&quot;3395a43e-2d88-40de-b95f-e00e1502085b\&quot;,\n    \&quot;quantity\&quot;: 1,\n    \&quot;unitPrice\&quot;: 18.00\n}&quot;,
            &quot;params&quot;: []
          },
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1,
          &quot;settingEncodeUrl&quot;: true
        },
        &quot;response&quot;: {
          &quot;status&quot;: 406,
          &quot;statusText&quot;: &quot;&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Content-Length&quot;,
              &quot;value&quot;: &quot;301&quot;
            },
            {
              &quot;name&quot;: &quot;Date&quot;,
              &quot;value&quot;: &quot;Mon, 07 Nov 2022 03:07:29 GMT&quot;
            }
          ],
          &quot;content&quot;: {
            &quot;size&quot;: 301,
            &quot;mimeType&quot;: &quot;application/json&quot;,
            &quot;text&quot;: &quot;{\&quot;errorCode\&quot;:\&quot;PACKT-0010\&quot;,\&quot;message\&quot;:\&quot;Already exists. Item with Id (3395a43e-2d88-40de-b95f-e00e1502085b) already exists. You can update it.\&quot;,\&quot;status\&quot;:406,\&quot;url\&quot;:\&quot;http://localhost:8080/api/v1/carts/a1b9b31d-e73c-4112-af7c-b68530f38222/items\&quot;,\&quot;reqMethod\&quot;:\&quot;POST\&quot;,\&quot;timestamp\&quot;:\&quot;2022-11-07T03:07:29.328633Z\&quot;}&quot;
          },
          &quot;redirectURL&quot;: &quot;&quot;,
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1
        },
        &quot;cache&quot;: {},
        &quot;timings&quot;: {
          &quot;blocked&quot;: -1,
          &quot;dns&quot;: -1,
          &quot;connect&quot;: -1,
          &quot;send&quot;: 0,
          &quot;wait&quot;: 8.758999999999999,
          &quot;receive&quot;: 0,
          &quot;ssl&quot;: -1
        },
        &quot;comment&quot;: &quot;/carts/{customerId}/items&quot;
      },
      {
        &quot;startedDateTime&quot;: &quot;2022-11-07T03:12:02.794Z&quot;,
        &quot;time&quot;: 18.227,
        &quot;request&quot;: {
          &quot;method&quot;: &quot;PUT&quot;,
          &quot;url&quot;: &quot;http://localhost:8080/api/v1/carts/a1b9b31d-e73c-4112-af7c-b68530f38222/items&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Accept&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            }
          ],
          &quot;queryString&quot;: [],
          &quot;postData&quot;: {
            &quot;mimeType&quot;: &quot;application/json&quot;,
            &quot;text&quot;: &quot;{\n    \&quot;id\&quot;: \&quot;3395a43e-2d88-40de-b95f-e00e1502085b\&quot;,\n    \&quot;quantity\&quot;: 9,\n    \&quot;unitPrice\&quot;: 18.00\n}&quot;,
            &quot;params&quot;: []
          },
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1,
          &quot;settingEncodeUrl&quot;: true
        },
        &quot;response&quot;: {
          &quot;status&quot;: 200,
          &quot;statusText&quot;: &quot;&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Content-Length&quot;,
              &quot;value&quot;: &quot;91&quot;
            },
            {
              &quot;name&quot;: &quot;Date&quot;,
              &quot;value&quot;: &quot;Mon, 07 Nov 2022 03:07:24 GMT&quot;
            }
          ],
          &quot;content&quot;: {
            &quot;size&quot;: 91,
            &quot;mimeType&quot;: &quot;application/json&quot;,
            &quot;text&quot;: &quot;[{\&quot;links\&quot;:[],\&quot;id\&quot;:\&quot;3395a43e-2d88-40de-b95f-e00e1502085b\&quot;,\&quot;quantity\&quot;:9,\&quot;unitPrice\&quot;:18.0000}]&quot;
          },
          &quot;redirectURL&quot;: &quot;&quot;,
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1
        },
        &quot;cache&quot;: {},
        &quot;timings&quot;: {
          &quot;blocked&quot;: -1,
          &quot;dns&quot;: -1,
          &quot;connect&quot;: -1,
          &quot;send&quot;: 0,
          &quot;wait&quot;: 18.227,
          &quot;receive&quot;: 0,
          &quot;ssl&quot;: -1
        },
        &quot;comment&quot;: &quot;/carts/{customerId}/items&quot;
      },
      {
        &quot;startedDateTime&quot;: &quot;2022-11-07T03:12:02.794Z&quot;,
        &quot;time&quot;: 128.68699999999998,
        &quot;request&quot;: {
          &quot;method&quot;: &quot;GET&quot;,
          &quot;url&quot;: &quot;http://localhost:8080/api/v1/products/6d62d909-f957-430e-8689-b5129c0bb75e&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Accept&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;If-None-Match&quot;,
              &quot;value&quot;: &quot;\&quot;0a54ae579d2f1e6a7050d6775e602a9ab&quot;
            }
          ],
          &quot;queryString&quot;: [],
          &quot;postData&quot;: {
            &quot;mimeType&quot;: &quot;application/json&quot;,
            &quot;text&quot;: &quot;{\n    \&quot;id\&quot;: \&quot;1\&quot;,\n    \&quot;quantity\&quot;: 1,\n    \&quot;unitPrice\&quot;: 2.5\n}&quot;,
            &quot;params&quot;: []
          },
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1,
          &quot;settingEncodeUrl&quot;: true
        },
        &quot;response&quot;: {
          &quot;status&quot;: 200,
          &quot;statusText&quot;: &quot;&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;ETag&quot;,
              &quot;value&quot;: &quot;\&quot;0bf2045ba79f991663b2f023e75b8e291\&quot;&quot;
            },
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Content-Length&quot;,
              &quot;value&quot;: &quot;631&quot;
            },
            {
              &quot;name&quot;: &quot;Date&quot;,
              &quot;value&quot;: &quot;Mon, 07 Nov 2022 03:07:43 GMT&quot;
            }
          ],
          &quot;content&quot;: {
            &quot;size&quot;: 631,
            &quot;mimeType&quot;: &quot;application/json&quot;,
            &quot;text&quot;: &quot;{\&quot;_links\&quot;:{\&quot;self\&quot;:[{\&quot;href\&quot;:\&quot;http://localhost:8080/6d62d909-f957-430e-8689-b5129c0bb75e\&quot;},{\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/products/6d62d909-f957-430e-8689-b5129c0bb75e\&quot;}],\&quot;products\&quot;:{\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/products?page=1&amp;size=10{&amp;tag,name}\&quot;,\&quot;templated\&quot;:true}},\&quot;id\&quot;:\&quot;6d62d909-f957-430e-8689-b5129c0bb75e\&quot;,\&quot;name\&quot;:\&quot;Antifragile\&quot;,\&quot;description\&quot;:\&quot;Antifragile - Things that gains from disorder. By Nassim Nicholas Taleb\&quot;,\&quot;imageUrl\&quot;:\&quot;/images/Antifragile.jpg\&quot;,\&quot;price\&quot;:17.1500,\&quot;count\&quot;:33,\&quot;tag\&quot;:[{\&quot;id\&quot;:\&quot;00000000-b5c6-4896-987c-f30f3678f602\&quot;,\&quot;name\&quot;:\&quot;psychology\&quot;},{\&quot;id\&quot;:\&quot;00000000-b5c6-4896-987c-f30f3678f601\&quot;,\&quot;name\&quot;:\&quot;book\&quot;}]}&quot;
          },
          &quot;redirectURL&quot;: &quot;&quot;,
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1
        },
        &quot;cache&quot;: {},
        &quot;timings&quot;: {
          &quot;blocked&quot;: -1,
          &quot;dns&quot;: -1,
          &quot;connect&quot;: -1,
          &quot;send&quot;: 0,
          &quot;wait&quot;: 128.68699999999998,
          &quot;receive&quot;: 0,
          &quot;ssl&quot;: -1
        },
        &quot;comment&quot;: &quot;/products/{id}&quot;
      },
      {
        &quot;startedDateTime&quot;: &quot;2022-11-07T03:12:02.794Z&quot;,
        &quot;time&quot;: 55.948,
        &quot;request&quot;: {
          &quot;method&quot;: &quot;GET&quot;,
          &quot;url&quot;: &quot;http://localhost:8080/api/v1/products&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Accept&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            }
          ],
          &quot;queryString&quot;: [],
          &quot;postData&quot;: {
            &quot;mimeType&quot;: &quot;&quot;,
            &quot;text&quot;: &quot;&quot;,
            &quot;params&quot;: []
          },
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1,
          &quot;settingEncodeUrl&quot;: true
        },
        &quot;response&quot;: {
          &quot;status&quot;: 200,
          &quot;statusText&quot;: &quot;&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;ETag&quot;,
              &quot;value&quot;: &quot;\&quot;0ab45c79d17397de69b8583f244ce7f38\&quot;&quot;
            },
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Content-Length&quot;,
              &quot;value&quot;: &quot;7031&quot;
            },
            {
              &quot;name&quot;: &quot;Date&quot;,
              &quot;value&quot;: &quot;Mon, 07 Nov 2022 03:07:47 GMT&quot;
            }
          ],
          &quot;content&quot;: {
            &quot;size&quot;: 7031,
            &quot;mimeType&quot;: &quot;application/json&quot;,
            &quot;text&quot;: &quot;[{\&quot;links\&quot;:[{\&quot;rel\&quot;:\&quot;self\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/6d62d909-f957-430e-8689-b5129c0bb75e\&quot;},{\&quot;rel\&quot;:\&quot;self\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/products/6d62d909-f957-430e-8689-b5129c0bb75e\&quot;},{\&quot;rel\&quot;:\&quot;products\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/products?page=1&amp;size=10{&amp;tag,name}\&quot;}],\&quot;id\&quot;:\&quot;6d62d909-f957-430e-8689-b5129c0bb75e\&quot;,\&quot;name\&quot;:\&quot;Antifragile\&quot;,\&quot;description\&quot;:\&quot;Antifragile - Things that gains from disorder. By Nassim Nicholas Taleb\&quot;,\&quot;imageUrl\&quot;:\&quot;/images/Antifragile.jpg\&quot;,\&quot;price\&quot;:17.1500,\&quot;count\&quot;:33,\&quot;tag\&quot;:[{\&quot;links\&quot;:[],\&quot;id\&quot;:\&quot;00000000-b5c6-4896-987c-f30f3678f602\&quot;,\&quot;name\&quot;:\&quot;psychology\&quot;},{\&quot;links\&quot;:[],\&quot;id\&quot;:\&quot;00000000-b5c6-4896-987c-f30f3678f601\&quot;,\&quot;name\&quot;:\&quot;book\&quot;}]},{\&quot;links\&quot;:[{\&quot;rel\&quot;:\&quot;self\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/a0a4f044-b040-410d-8ead-4de0446aec7e\&quot;},{\&quot;rel\&quot;:\&quot;self\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/products/a0a4f044-b040-410d-8ead-4de0446aec7e\&quot;},{\&quot;rel\&quot;:\&quot;products\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/products?page=1&amp;size=10{&amp;tag,name}\&quot;}],\&quot;id\&quot;:\&quot;a0a4f044-b040-410d-8ead-4de0446aec7e\&quot;,\&quot;name\&quot;:\&quot;Sapiens\&quot;,\&quot;description\&quot;:\&quot;Sapiens - A brief history of mankind. By Yuval Noah Harari\&quot;,\&quot;imageUrl\&quot;:\&quot;/images/Sapiens.jpeg\&quot;,\&quot;price\&quot;:7.9900,\&quot;count\&quot;:115,\&quot;tag\&quot;:[{\&quot;links\&quot;:[],\&quot;id\&quot;:\&quot;00000000-b5c6-4896-987c-f30f3678f608\&quot;,\&quot;name\&quot;:\&quot;history\&quot;},{\&quot;links\&quot;:[],\&quot;id\&quot;:\&quot;00000000-b5c6-4896-987c-f30f3678f601\&quot;,\&quot;name\&quot;:\&quot;book\&quot;}]},{\&quot;links\&quot;:[{\&quot;rel\&quot;:\&quot;self\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/808a2de1-1aaa-4c25-a9b9-6612e8f29a38\&quot;},{\&quot;rel\&quot;:\&quot;self\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/products/808a2de1-1aaa-4c25-a9b9-6612e8f29a38\&quot;},{\&quot;rel\&quot;:\&quot;products\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/products?page=1&amp;size=10{&amp;tag,name}\&quot;}],\&quot;id\&quot;:\&quot;808a2de1-1aaa-4c25-a9b9-6612e8f29a38\&quot;,\&quot;name\&quot;:\&quot;Thinking Fast and Slow\&quot;,\&quot;description\&quot;:\&quot;Thinking Fast and Slow. By winner of Nobel Prize - Danniel Kahneman\&quot;,\&quot;imageUrl\&quot;:\&quot;/images/ThinkingFast.jpeg\&quot;,\&quot;price\&quot;:17.3200,\&quot;count\&quot;:738,\&quot;tag\&quot;:[{\&quot;links\&quot;:[],\&quot;id\&quot;:\&quot;00000000-b5c6-4896-987c-f30f3678f602\&quot;,\&quot;name\&quot;:\&quot;psychology\&quot;},{\&quot;links\&quot;:[],\&quot;id\&quot;:\&quot;00000000-b5c6-4896-987c-f30f3678f601\&quot;,\&quot;name\&quot;:\&quot;book\&quot;},{\&quot;links\&quot;:[],\&quot;id\&quot;:\&quot;00000000-b5c6-4896-987c-f30f3678f607\&quot;,\&quot;name\&quot;:\&quot;lessions\&quot;},{\&quot;links\&quot;:[],\&quot;id\&quot;:\&quot;00000000-b5c6-4896-987c-f30f3678f611\&quot;,\&quot;name\&quot;:\&quot;decision\&quot;}]},{\&quot;links\&quot;:[{\&quot;rel\&quot;:\&quot;self\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/510a0d7e-8e83-4193-b483-e27e09ddc34d\&quot;},{\&quot;rel\&quot;:\&quot;self\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/products/510a0d7e-8e83-4193-b483-e27e09ddc34d\&quot;},{\&quot;rel\&quot;:\&quot;products\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/products?page=1&amp;size=10{&amp;tag,name}\&quot;}],\&quot;id\&quot;:\&quot;510a0d7e-8e83-4193-b483-e27e09ddc34d\&quot;,\&quot;name\&quot;:\&quot;How to Fail at Almost Everything and Still Win Big\&quot;,\&quot;description\&quot;:\&quot;How to Fail at Almost Everything and Still Win Big - Kind of Story of My Life. By Scott Adams\&quot;,\&quot;imageUrl\&quot;:\&quot;/images/HowToFail.jpeg\&quot;,\&quot;price\&quot;:15.0000,\&quot;count\&quot;:820,\&quot;tag\&quot;:[{\&quot;links\&quot;:[],\&quot;id\&quot;:\&quot;00000000-b5c6-4896-987c-f30f3678f602\&quot;,\&quot;name\&quot;:\&quot;psychology\&quot;},{\&quot;links\&quot;:[],\&quot;id\&quot;:\&quot;00000000-b5c6-4896-987c-f30f3678f601\&quot;,\&quot;name\&quot;:\&quot;book\&quot;},{\&quot;links\&quot;:[],\&quot;id\&quot;:\&quot;00000000-b5c6-4896-987c-f30f3678f610\&quot;,\&quot;name\&quot;:\&quot;journey\&quot;}]},{\&quot;links\&quot;:[{\&quot;rel\&quot;:\&quot;self\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/03fef6ac-1896-4ce8-bd69-b798f85c6e0b\&quot;},{\&quot;rel\&quot;:\&quot;self\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/products/03fef6ac-1896-4ce8-bd69-b798f85c6e0b\&quot;},{\&quot;rel\&quot;:\&quot;products\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/products?page=1&amp;size=10{&amp;tag,name}\&quot;}],\&quot;id\&quot;:\&quot;03fef6ac-1896-4ce8-bd69-b798f85c6e0b\&quot;,\&quot;name\&quot;:\&quot;Influence\&quot;,\&quot;description\&quot;:\&quot;Influence - Psychology of Persuasion. By Robert B. Cialdini Ph.D.\&quot;,\&quot;imageUrl\&quot;:\&quot;/images/Influence.jpeg\&quot;,\&quot;price\&quot;:99.9900,\&quot;count\&quot;:1,\&quot;tag\&quot;:[{\&quot;links\&quot;:[],\&quot;id\&quot;:\&quot;00000000-b5c6-4896-987c-f30f3678f602\&quot;,\&quot;name\&quot;:\&quot;psychology\&quot;},{\&quot;links\&quot;:[],\&quot;id\&quot;:\&quot;00000000-b5c6-4896-987c-f30f3678f603\&quot;,\&quot;name\&quot;:\&quot;influence\&quot;}]},{\&quot;links\&quot;:[{\&quot;rel\&quot;:\&quot;self\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/d3588630-ad8e-49df-bbd7-3167f7efb246\&quot;},{\&quot;rel\&quot;:\&quot;self\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/products/d3588630-ad8e-49df-bbd7-3167f7efb246\&quot;},{\&quot;rel\&quot;:\&quot;products\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/products?page=1&amp;size=10{&amp;tag,name}\&quot;}],\&quot;id\&quot;:\&quot;d3588630-ad8e-49df-bbd7-3167f7efb246\&quot;,\&quot;name\&quot;:\&quot;Poor Charlie's Almanack\&quot;,\&quot;description\&quot;:\&quot;Poor Charlie's Almanack - Wits and Wisdom of Charles T. Munger. By Peter Kauffman\&quot;,\&quot;imageUrl\&quot;:\&quot;/images/PoorCharlie.jpeg\&quot;,\&quot;price\&quot;:10.9900,\&quot;count\&quot;:801,\&quot;tag\&quot;:[{\&quot;links\&quot;:[],\&quot;id\&quot;:\&quot;00000000-b5c6-4896-987c-f30f3678f604\&quot;,\&quot;name\&quot;:\&quot;wisdom\&quot;},{\&quot;links\&quot;:[],\&quot;id\&quot;:\&quot;00000000-b5c6-4896-987c-f30f3678f607\&quot;,\&quot;name\&quot;:\&quot;lessions\&quot;}]},{\&quot;links\&quot;:[{\&quot;rel\&quot;:\&quot;self\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/819e1fbf-8b7e-4f6d-811f-693534916a8b\&quot;},{\&quot;rel\&quot;:\&quot;self\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/products/819e1fbf-8b7e-4f6d-811f-693534916a8b\&quot;},{\&quot;rel\&quot;:\&quot;products\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/products?page=1&amp;size=10{&amp;tag,name}\&quot;}],\&quot;id\&quot;:\&quot;819e1fbf-8b7e-4f6d-811f-693534916a8b\&quot;,\&quot;name\&quot;:\&quot;Hackers &amp; Painters\&quot;,\&quot;description\&quot;:\&quot;Hackers &amp; Painters - Big Ideas from Computer Age. By Paul Graham\&quot;,\&quot;imageUrl\&quot;:\&quot;/images/Hackers.jpg\&quot;,\&quot;price\&quot;:14.0000,\&quot;count\&quot;:808,\&quot;tag\&quot;:[{\&quot;links\&quot;:[],\&quot;id\&quot;:\&quot;00000000-b5c6-4896-987c-f30f3678f605\&quot;,\&quot;name\&quot;:\&quot;startup\&quot;},{\&quot;links\&quot;:[],\&quot;id\&quot;:\&quot;00000000-b5c6-4896-987c-f30f3678f606\&quot;,\&quot;name\&quot;:\&quot;investing\&quot;},{\&quot;links\&quot;:[],\&quot;id\&quot;:\&quot;00000000-b5c6-4896-987c-f30f3678f607\&quot;,\&quot;name\&quot;:\&quot;lessions\&quot;}]},{\&quot;links\&quot;:[{\&quot;rel\&quot;:\&quot;self\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/3395a42e-2d88-40de-b95f-e00e1502085b\&quot;},{\&quot;rel\&quot;:\&quot;self\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/products/3395a42e-2d88-40de-b95f-e00e1502085b\&quot;},{\&quot;rel\&quot;:\&quot;products\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/products?page=1&amp;size=10{&amp;tag,name}\&quot;}],\&quot;id\&quot;:\&quot;3395a42e-2d88-40de-b95f-e00e1502085b\&quot;,\&quot;name\&quot;:\&quot;Seeking Wisdom\&quot;,\&quot;description\&quot;:\&quot;Seeking Wisdom - From Darwin To Mungar. By Peter Bevelin\&quot;,\&quot;imageUrl\&quot;:\&quot;/images/Seeking.jpg\&quot;,\&quot;price\&quot;:12.0000,\&quot;count\&quot;:127,\&quot;tag\&quot;:[{\&quot;links\&quot;:[],\&quot;id\&quot;:\&quot;00000000-b5c6-4896-987c-f30f3678f604\&quot;,\&quot;name\&quot;:\&quot;wisdom\&quot;},{\&quot;links\&quot;:[],\&quot;id\&quot;:\&quot;00000000-b5c6-4896-987c-f30f3678f607\&quot;,\&quot;name\&quot;:\&quot;lessions\&quot;}]},{\&quot;links\&quot;:[{\&quot;rel\&quot;:\&quot;self\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/3395a43e-2d88-40de-b95f-e00e1502085b\&quot;},{\&quot;rel\&quot;:\&quot;self\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/products/3395a43e-2d88-40de-b95f-e00e1502085b\&quot;},{\&quot;rel\&quot;:\&quot;products\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/products?page=1&amp;size=10{&amp;tag,name}\&quot;}],\&quot;id\&quot;:\&quot;3395a43e-2d88-40de-b95f-e00e1502085b\&quot;,\&quot;name\&quot;:\&quot;Thinking In Bets\&quot;,\&quot;description\&quot;:\&quot;Thinking In Bets - Making Smarter Decision. When you don't have all the facts. By Annie Duke\&quot;,\&quot;imageUrl\&quot;:\&quot;/images/ThinkingIn.jpg\&quot;,\&quot;price\&quot;:18.0000,\&quot;count\&quot;:438,\&quot;tag\&quot;:[{\&quot;links\&quot;:[],\&quot;id\&quot;:\&quot;00000000-b5c6-4896-987c-f30f3678f611\&quot;,\&quot;name\&quot;:\&quot;decision\&quot;},{\&quot;links\&quot;:[],\&quot;id\&quot;:\&quot;00000000-b5c6-4896-987c-f30f3678f609\&quot;,\&quot;name\&quot;:\&quot;howto\&quot;}]},{\&quot;links\&quot;:[{\&quot;rel\&quot;:\&quot;self\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/837ab141-399e-4c1f-9abc-bace40296bac\&quot;},{\&quot;rel\&quot;:\&quot;self\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/products/837ab141-399e-4c1f-9abc-bace40296bac\&quot;},{\&quot;rel\&quot;:\&quot;products\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/products?page=1&amp;size=10{&amp;tag,name}\&quot;}],\&quot;id\&quot;:\&quot;837ab141-399e-4c1f-9abc-bace40296bac\&quot;,\&quot;name\&quot;:\&quot;Zero to One\&quot;,\&quot;description\&quot;:\&quot;Zero to One - Notes on Startups, Or How to build future. Peter Theil\&quot;,\&quot;imageUrl\&quot;:\&quot;/images/ZeroToOne.jpg\&quot;,\&quot;price\&quot;:15.0000,\&quot;count\&quot;:175,\&quot;tag\&quot;:[{\&quot;links\&quot;:[],\&quot;id\&quot;:\&quot;00000000-b5c6-4896-987c-f30f3678f609\&quot;,\&quot;name\&quot;:\&quot;howto\&quot;},{\&quot;links\&quot;:[],\&quot;id\&quot;:\&quot;00000000-b5c6-4896-987c-f30f3678f605\&quot;,\&quot;name\&quot;:\&quot;startup\&quot;},{\&quot;links\&quot;:[],\&quot;id\&quot;:\&quot;00000000-b5c6-4896-987c-f30f3678f601\&quot;,\&quot;name\&quot;:\&quot;book\&quot;}]}]&quot;
          },
          &quot;redirectURL&quot;: &quot;&quot;,
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1
        },
        &quot;cache&quot;: {},
        &quot;timings&quot;: {
          &quot;blocked&quot;: -1,
          &quot;dns&quot;: -1,
          &quot;connect&quot;: -1,
          &quot;send&quot;: 0,
          &quot;wait&quot;: 55.948,
          &quot;receive&quot;: 0,
          &quot;ssl&quot;: -1
        },
        &quot;comment&quot;: &quot;/products&quot;
      },
      {
        &quot;startedDateTime&quot;: &quot;2022-11-07T03:12:02.794Z&quot;,
        &quot;time&quot;: 17.185,
        &quot;request&quot;: {
          &quot;method&quot;: &quot;GET&quot;,
          &quot;url&quot;: &quot;http://localhost:8080/api/v1/addresses&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Accept&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;If-None-Match&quot;,
              &quot;value&quot;: &quot;098e97de3b61db55286f5f2812785116f&quot;
            }
          ],
          &quot;queryString&quot;: [],
          &quot;postData&quot;: {
            &quot;mimeType&quot;: &quot;&quot;,
            &quot;text&quot;: &quot;&quot;,
            &quot;params&quot;: []
          },
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1,
          &quot;settingEncodeUrl&quot;: true
        },
        &quot;response&quot;: {
          &quot;status&quot;: 200,
          &quot;statusText&quot;: &quot;&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;ETag&quot;,
              &quot;value&quot;: &quot;\&quot;0e55eaa2dcc02df4cc582f5666e661f67\&quot;&quot;
            },
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Content-Length&quot;,
              &quot;value&quot;: &quot;401&quot;
            },
            {
              &quot;name&quot;: &quot;Date&quot;,
              &quot;value&quot;: &quot;Mon, 07 Nov 2022 03:07:52 GMT&quot;
            }
          ],
          &quot;content&quot;: {
            &quot;size&quot;: 401,
            &quot;mimeType&quot;: &quot;application/json&quot;,
            &quot;text&quot;: &quot;[{\&quot;links\&quot;:[{\&quot;rel\&quot;:\&quot;self\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/a731fda1-aaad-42ea-bdbc-a27eeebe2cc0\&quot;},{\&quot;rel\&quot;:\&quot;self\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/addresses/a731fda1-aaad-42ea-bdbc-a27eeebe2cc0\&quot;}],\&quot;id\&quot;:\&quot;a731fda1-aaad-42ea-bdbc-a27eeebe2cc0\&quot;,\&quot;number\&quot;:\&quot;9I-999\&quot;,\&quot;residency\&quot;:\&quot;Fraser Suites Le Claridge\&quot;,\&quot;street\&quot;:\&quot;Champs-Elysees\&quot;,\&quot;city\&quot;:\&quot;Paris\&quot;,\&quot;state\&quot;:\&quot;Île-de-France\&quot;,\&quot;country\&quot;:\&quot;France\&quot;,\&quot;pincode\&quot;:\&quot;75008\&quot;}]&quot;
          },
          &quot;redirectURL&quot;: &quot;&quot;,
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1
        },
        &quot;cache&quot;: {},
        &quot;timings&quot;: {
          &quot;blocked&quot;: -1,
          &quot;dns&quot;: -1,
          &quot;connect&quot;: -1,
          &quot;send&quot;: 0,
          &quot;wait&quot;: 17.185,
          &quot;receive&quot;: 0,
          &quot;ssl&quot;: -1
        },
        &quot;comment&quot;: &quot;/addresses&quot;
      },
      {
        &quot;startedDateTime&quot;: &quot;2022-11-07T03:12:02.794Z&quot;,
        &quot;time&quot;: 8.989,
        &quot;request&quot;: {
          &quot;method&quot;: &quot;GET&quot;,
          &quot;url&quot;: &quot;http://localhost:8080/api/v1/addresses/a731fda1-aaad-42ea-bdbc-a27eeebe2cc0&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Accept&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;If-None-Match&quot;,
              &quot;value&quot;: &quot;098e97de3b61db55286f5f2812785116f&quot;
            }
          ],
          &quot;queryString&quot;: [],
          &quot;postData&quot;: {
            &quot;mimeType&quot;: &quot;&quot;,
            &quot;text&quot;: &quot;&quot;,
            &quot;params&quot;: []
          },
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1,
          &quot;settingEncodeUrl&quot;: true
        },
        &quot;response&quot;: {
          &quot;status&quot;: 200,
          &quot;statusText&quot;: &quot;&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;ETag&quot;,
              &quot;value&quot;: &quot;\&quot;006f3540abe31c1ac28f492b99d3ce8cb\&quot;&quot;
            },
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Content-Length&quot;,
              &quot;value&quot;: &quot;383&quot;
            },
            {
              &quot;name&quot;: &quot;Date&quot;,
              &quot;value&quot;: &quot;Mon, 07 Nov 2022 03:07:57 GMT&quot;
            }
          ],
          &quot;content&quot;: {
            &quot;size&quot;: 383,
            &quot;mimeType&quot;: &quot;application/json&quot;,
            &quot;text&quot;: &quot;{\&quot;_links\&quot;:{\&quot;self\&quot;:[{\&quot;href\&quot;:\&quot;http://localhost:8080/a731fda1-aaad-42ea-bdbc-a27eeebe2cc0\&quot;},{\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/addresses/a731fda1-aaad-42ea-bdbc-a27eeebe2cc0\&quot;}]},\&quot;id\&quot;:\&quot;a731fda1-aaad-42ea-bdbc-a27eeebe2cc0\&quot;,\&quot;number\&quot;:\&quot;9I-999\&quot;,\&quot;residency\&quot;:\&quot;Fraser Suites Le Claridge\&quot;,\&quot;street\&quot;:\&quot;Champs-Elysees\&quot;,\&quot;city\&quot;:\&quot;Paris\&quot;,\&quot;state\&quot;:\&quot;Île-de-France\&quot;,\&quot;country\&quot;:\&quot;France\&quot;,\&quot;pincode\&quot;:\&quot;75008\&quot;}&quot;
          },
          &quot;redirectURL&quot;: &quot;&quot;,
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1
        },
        &quot;cache&quot;: {},
        &quot;timings&quot;: {
          &quot;blocked&quot;: -1,
          &quot;dns&quot;: -1,
          &quot;connect&quot;: -1,
          &quot;send&quot;: 0,
          &quot;wait&quot;: 8.989,
          &quot;receive&quot;: 0,
          &quot;ssl&quot;: -1
        },
        &quot;comment&quot;: &quot;/addresses/{id}&quot;
      },
      {
        &quot;startedDateTime&quot;: &quot;2022-11-07T03:12:02.794Z&quot;,
        &quot;time&quot;: 0,
        &quot;request&quot;: {
          &quot;method&quot;: &quot;POST&quot;,
          &quot;url&quot;: &quot;http://localhost:8080/api/v1/addresses&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Accept&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;If-None-Match&quot;,
              &quot;value&quot;: &quot;098e97de3b61db55286f5f2812785116f&quot;
            }
          ],
          &quot;queryString&quot;: [],
          &quot;postData&quot;: {
            &quot;mimeType&quot;: &quot;application/json&quot;,
            &quot;text&quot;: &quot;{\r\n    \&quot;number\&quot;: \&quot;9I-999\&quot;,\r\n    \&quot;residency\&quot;: \&quot;Fraser Suites Le Claridge\&quot;,\r\n    \&quot;street\&quot;: \&quot;Champs-Elysees\&quot;,\r\n    \&quot;city\&quot;: \&quot;Paris\&quot;,\r\n    \&quot;state\&quot;: \&quot;Île-de-France\&quot;,\r\n    \&quot;country\&quot;: \&quot;France\&quot;,\r\n    \&quot;pincode\&quot;: \&quot;75008\&quot;\r\n}&quot;,
            &quot;params&quot;: []
          },
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1,
          &quot;settingEncodeUrl&quot;: true
        },
        &quot;response&quot;: {
          &quot;status&quot;: 0,
          &quot;statusText&quot;: &quot;&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [],
          &quot;content&quot;: {
            &quot;size&quot;: 0,
            &quot;mimeType&quot;: &quot;&quot;
          },
          &quot;redirectURL&quot;: &quot;&quot;,
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1
        },
        &quot;cache&quot;: {},
        &quot;timings&quot;: {
          &quot;blocked&quot;: -1,
          &quot;dns&quot;: -1,
          &quot;connect&quot;: -1,
          &quot;send&quot;: 0,
          &quot;wait&quot;: 0,
          &quot;receive&quot;: 0,
          &quot;ssl&quot;: -1
        },
        &quot;comment&quot;: &quot;/addresses&quot;
      },
      {
        &quot;startedDateTime&quot;: &quot;2022-11-07T03:12:02.794Z&quot;,
        &quot;time&quot;: 0,
        &quot;request&quot;: {
          &quot;method&quot;: &quot;DELETE&quot;,
          &quot;url&quot;: &quot;http://localhost:8080/api/v1/addresses/1d76676d-9d87-4a5a-8b42-1ca044a361b0&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Accept&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;If-None-Match&quot;,
              &quot;value&quot;: &quot;098e97de3b61db55286f5f2812785116f&quot;
            }
          ],
          &quot;queryString&quot;: [],
          &quot;postData&quot;: {
            &quot;mimeType&quot;: &quot;&quot;,
            &quot;text&quot;: &quot;&quot;,
            &quot;params&quot;: []
          },
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1,
          &quot;settingEncodeUrl&quot;: true
        },
        &quot;response&quot;: {
          &quot;status&quot;: 0,
          &quot;statusText&quot;: &quot;&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [],
          &quot;content&quot;: {
            &quot;size&quot;: 0,
            &quot;mimeType&quot;: &quot;&quot;
          },
          &quot;redirectURL&quot;: &quot;&quot;,
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1
        },
        &quot;cache&quot;: {},
        &quot;timings&quot;: {
          &quot;blocked&quot;: -1,
          &quot;dns&quot;: -1,
          &quot;connect&quot;: -1,
          &quot;send&quot;: 0,
          &quot;wait&quot;: 0,
          &quot;receive&quot;: 0,
          &quot;ssl&quot;: -1
        },
        &quot;comment&quot;: &quot;/addresses/{id}&quot;
      },
      {
        &quot;startedDateTime&quot;: &quot;2022-11-07T03:12:02.794Z&quot;,
        &quot;time&quot;: 17.641000000000002,
        &quot;request&quot;: {
          &quot;method&quot;: &quot;GET&quot;,
          &quot;url&quot;: &quot;http://localhost:8080/api/v1/cards&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Accept&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;If-None-Match&quot;,
              &quot;value&quot;: &quot;098e97de3b61db55286f5f2812785116f&quot;
            }
          ],
          &quot;queryString&quot;: [],
          &quot;postData&quot;: {
            &quot;mimeType&quot;: &quot;&quot;,
            &quot;text&quot;: &quot;&quot;,
            &quot;params&quot;: []
          },
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1,
          &quot;settingEncodeUrl&quot;: true
        },
        &quot;response&quot;: {
          &quot;status&quot;: 200,
          &quot;statusText&quot;: &quot;&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;ETag&quot;,
              &quot;value&quot;: &quot;\&quot;0d4c4022a295b7eb29d408a59be16d7f8\&quot;&quot;
            },
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Content-Length&quot;,
              &quot;value&quot;: &quot;346&quot;
            },
            {
              &quot;name&quot;: &quot;Date&quot;,
              &quot;value&quot;: &quot;Mon, 07 Nov 2022 03:08:10 GMT&quot;
            }
          ],
          &quot;content&quot;: {
            &quot;size&quot;: 346,
            &quot;mimeType&quot;: &quot;application/json&quot;,
            &quot;text&quot;: &quot;[{\&quot;links\&quot;:[{\&quot;rel\&quot;:\&quot;self\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/618ffaff-cbcd-48d4-8848-a15601e6725b\&quot;},{\&quot;rel\&quot;:\&quot;self\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/cards/618ffaff-cbcd-48d4-8848-a15601e6725b\&quot;}],\&quot;id\&quot;:\&quot;618ffaff-cbcd-48d4-8848-a15601e6725b\&quot;,\&quot;cardNumber\&quot;:\&quot;999-999-999-999\&quot;,\&quot;expires\&quot;:\&quot;12/28\&quot;,\&quot;cvv\&quot;:\&quot;0000\&quot;,\&quot;userId\&quot;:\&quot;a1b9b31d-e73c-4112-af7c-b68530f38222\&quot;}]&quot;
          },
          &quot;redirectURL&quot;: &quot;&quot;,
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1
        },
        &quot;cache&quot;: {},
        &quot;timings&quot;: {
          &quot;blocked&quot;: -1,
          &quot;dns&quot;: -1,
          &quot;connect&quot;: -1,
          &quot;send&quot;: 0,
          &quot;wait&quot;: 17.641000000000002,
          &quot;receive&quot;: 0,
          &quot;ssl&quot;: -1
        },
        &quot;comment&quot;: &quot;/cards&quot;
      },
      {
        &quot;startedDateTime&quot;: &quot;2022-11-07T03:12:02.794Z&quot;,
        &quot;time&quot;: 0,
        &quot;request&quot;: {
          &quot;method&quot;: &quot;GET&quot;,
          &quot;url&quot;: &quot;http://localhost:8080/api/v1/cards/618ffaff-cbcd-48d4-8848-a15601e6725b&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Accept&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;If-None-Match&quot;,
              &quot;value&quot;: &quot;098e97de3b61db55286f5f2812785116f&quot;
            }
          ],
          &quot;queryString&quot;: [],
          &quot;postData&quot;: {
            &quot;mimeType&quot;: &quot;&quot;,
            &quot;text&quot;: &quot;&quot;,
            &quot;params&quot;: []
          },
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1,
          &quot;settingEncodeUrl&quot;: true
        },
        &quot;response&quot;: {
          &quot;status&quot;: 0,
          &quot;statusText&quot;: &quot;&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [],
          &quot;content&quot;: {
            &quot;size&quot;: 0,
            &quot;mimeType&quot;: &quot;&quot;
          },
          &quot;redirectURL&quot;: &quot;&quot;,
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1
        },
        &quot;cache&quot;: {},
        &quot;timings&quot;: {
          &quot;blocked&quot;: -1,
          &quot;dns&quot;: -1,
          &quot;connect&quot;: -1,
          &quot;send&quot;: 0,
          &quot;wait&quot;: 0,
          &quot;receive&quot;: 0,
          &quot;ssl&quot;: -1
        },
        &quot;comment&quot;: &quot;/cards/{id}&quot;
      },
      {
        &quot;startedDateTime&quot;: &quot;2022-11-07T03:12:02.794Z&quot;,
        &quot;time&quot;: 0,
        &quot;request&quot;: {
          &quot;method&quot;: &quot;DELETE&quot;,
          &quot;url&quot;: &quot;http://localhost:8080/api/v1/cards/eda3de5c-8c01-4e49-a4f4-ae91584ea4d4&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Accept&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;If-None-Match&quot;,
              &quot;value&quot;: &quot;098e97de3b61db55286f5f2812785116f&quot;
            }
          ],
          &quot;queryString&quot;: [],
          &quot;postData&quot;: {
            &quot;mimeType&quot;: &quot;&quot;,
            &quot;text&quot;: &quot;&quot;,
            &quot;params&quot;: []
          },
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1,
          &quot;settingEncodeUrl&quot;: true
        },
        &quot;response&quot;: {
          &quot;status&quot;: 0,
          &quot;statusText&quot;: &quot;&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [],
          &quot;content&quot;: {
            &quot;size&quot;: 0,
            &quot;mimeType&quot;: &quot;&quot;
          },
          &quot;redirectURL&quot;: &quot;&quot;,
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1
        },
        &quot;cache&quot;: {},
        &quot;timings&quot;: {
          &quot;blocked&quot;: -1,
          &quot;dns&quot;: -1,
          &quot;connect&quot;: -1,
          &quot;send&quot;: 0,
          &quot;wait&quot;: 0,
          &quot;receive&quot;: 0,
          &quot;ssl&quot;: -1
        },
        &quot;comment&quot;: &quot;/cards/{id}&quot;
      },
      {
        &quot;startedDateTime&quot;: &quot;2022-11-07T03:12:02.794Z&quot;,
        &quot;time&quot;: 0,
        &quot;request&quot;: {
          &quot;method&quot;: &quot;POST&quot;,
          &quot;url&quot;: &quot;http://localhost:8080/api/v1/cards&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Accept&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;If-None-Match&quot;,
              &quot;value&quot;: &quot;098e97de3b61db55286f5f2812785116f&quot;
            }
          ],
          &quot;queryString&quot;: [],
          &quot;postData&quot;: {
            &quot;mimeType&quot;: &quot;application/json&quot;,
            &quot;text&quot;: &quot;{\r\n    \&quot;cardNumber\&quot;: \&quot;999-999-999-999\&quot;,\r\n    \&quot;expires\&quot;: \&quot;12/28\&quot;,\r\n    \&quot;cvv\&quot;: \&quot;000\&quot;,\r\n    \&quot;userId\&quot;: \&quot;a1b9b31d-e73c-4112-af7c-b68530f38223\&quot;\r\n}&quot;,
            &quot;params&quot;: []
          },
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1,
          &quot;settingEncodeUrl&quot;: true
        },
        &quot;response&quot;: {
          &quot;status&quot;: 0,
          &quot;statusText&quot;: &quot;&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [],
          &quot;content&quot;: {
            &quot;size&quot;: 0,
            &quot;mimeType&quot;: &quot;&quot;
          },
          &quot;redirectURL&quot;: &quot;&quot;,
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1
        },
        &quot;cache&quot;: {},
        &quot;timings&quot;: {
          &quot;blocked&quot;: -1,
          &quot;dns&quot;: -1,
          &quot;connect&quot;: -1,
          &quot;send&quot;: 0,
          &quot;wait&quot;: 0,
          &quot;receive&quot;: 0,
          &quot;ssl&quot;: -1
        },
        &quot;comment&quot;: &quot;/cards&quot;
      },
      {
        &quot;startedDateTime&quot;: &quot;2022-11-07T03:12:02.794Z&quot;,
        &quot;time&quot;: 0,
        &quot;request&quot;: {
          &quot;method&quot;: &quot;GET&quot;,
          &quot;url&quot;: &quot;http://localhost:8080/api/v1/customers/a1b9b31d-e73c-4112-af7c-b68530f38222&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Accept&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;If-None-Match&quot;,
              &quot;value&quot;: &quot;098e97de3b61db55286f5f2812785116f&quot;
            }
          ],
          &quot;queryString&quot;: [],
          &quot;postData&quot;: {
            &quot;mimeType&quot;: &quot;&quot;,
            &quot;text&quot;: &quot;&quot;,
            &quot;params&quot;: []
          },
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1,
          &quot;settingEncodeUrl&quot;: true
        },
        &quot;response&quot;: {
          &quot;status&quot;: 0,
          &quot;statusText&quot;: &quot;&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [],
          &quot;content&quot;: {
            &quot;size&quot;: 0,
            &quot;mimeType&quot;: &quot;&quot;
          },
          &quot;redirectURL&quot;: &quot;&quot;,
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1
        },
        &quot;cache&quot;: {},
        &quot;timings&quot;: {
          &quot;blocked&quot;: -1,
          &quot;dns&quot;: -1,
          &quot;connect&quot;: -1,
          &quot;send&quot;: 0,
          &quot;wait&quot;: 0,
          &quot;receive&quot;: 0,
          &quot;ssl&quot;: -1
        },
        &quot;comment&quot;: &quot;/customers/{id}&quot;
      },
      {
        &quot;startedDateTime&quot;: &quot;2022-11-07T03:12:02.794Z&quot;,
        &quot;time&quot;: 0,
        &quot;request&quot;: {
          &quot;method&quot;: &quot;DELETE&quot;,
          &quot;url&quot;: &quot;http://localhost:8080/api/v1/customers/a1b9b31d-e73c-4112-af7c-b68530f38223&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Accept&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;If-None-Match&quot;,
              &quot;value&quot;: &quot;098e97de3b61db55286f5f2812785116f&quot;
            }
          ],
          &quot;queryString&quot;: [],
          &quot;postData&quot;: {
            &quot;mimeType&quot;: &quot;&quot;,
            &quot;text&quot;: &quot;&quot;,
            &quot;params&quot;: []
          },
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1,
          &quot;settingEncodeUrl&quot;: true
        },
        &quot;response&quot;: {
          &quot;status&quot;: 0,
          &quot;statusText&quot;: &quot;&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [],
          &quot;content&quot;: {
            &quot;size&quot;: 0,
            &quot;mimeType&quot;: &quot;&quot;
          },
          &quot;redirectURL&quot;: &quot;&quot;,
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1
        },
        &quot;cache&quot;: {},
        &quot;timings&quot;: {
          &quot;blocked&quot;: -1,
          &quot;dns&quot;: -1,
          &quot;connect&quot;: -1,
          &quot;send&quot;: 0,
          &quot;wait&quot;: 0,
          &quot;receive&quot;: 0,
          &quot;ssl&quot;: -1
        },
        &quot;comment&quot;: &quot;/customers/{id}&quot;
      },
      {
        &quot;startedDateTime&quot;: &quot;2022-11-07T03:12:02.794Z&quot;,
        &quot;time&quot;: 0,
        &quot;request&quot;: {
          &quot;method&quot;: &quot;GET&quot;,
          &quot;url&quot;: &quot;http://localhost:8080/api/v1/customers&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Accept&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;If-None-Match&quot;,
              &quot;value&quot;: &quot;098e97de3b61db55286f5f2812785116f&quot;
            }
          ],
          &quot;queryString&quot;: [],
          &quot;postData&quot;: {
            &quot;mimeType&quot;: &quot;&quot;,
            &quot;text&quot;: &quot;&quot;,
            &quot;params&quot;: []
          },
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1,
          &quot;settingEncodeUrl&quot;: true
        },
        &quot;response&quot;: {
          &quot;status&quot;: 0,
          &quot;statusText&quot;: &quot;&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [],
          &quot;content&quot;: {
            &quot;size&quot;: 0,
            &quot;mimeType&quot;: &quot;&quot;
          },
          &quot;redirectURL&quot;: &quot;&quot;,
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1
        },
        &quot;cache&quot;: {},
        &quot;timings&quot;: {
          &quot;blocked&quot;: -1,
          &quot;dns&quot;: -1,
          &quot;connect&quot;: -1,
          &quot;send&quot;: 0,
          &quot;wait&quot;: 0,
          &quot;receive&quot;: 0,
          &quot;ssl&quot;: -1
        },
        &quot;comment&quot;: &quot;/customers&quot;
      },
      {
        &quot;startedDateTime&quot;: &quot;2022-11-07T03:12:02.794Z&quot;,
        &quot;time&quot;: 0,
        &quot;request&quot;: {
          &quot;method&quot;: &quot;GET&quot;,
          &quot;url&quot;: &quot;http://localhost:8080/api/v1/customers/a1b9b31d-e73c-4112-af7c-b68530f38222/addresses&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Accept&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;If-None-Match&quot;,
              &quot;value&quot;: &quot;098e97de3b61db55286f5f2812785116f&quot;
            }
          ],
          &quot;queryString&quot;: [],
          &quot;postData&quot;: {
            &quot;mimeType&quot;: &quot;&quot;,
            &quot;text&quot;: &quot;&quot;,
            &quot;params&quot;: []
          },
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1,
          &quot;settingEncodeUrl&quot;: true
        },
        &quot;response&quot;: {
          &quot;status&quot;: 0,
          &quot;statusText&quot;: &quot;&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [],
          &quot;content&quot;: {
            &quot;size&quot;: 0,
            &quot;mimeType&quot;: &quot;&quot;
          },
          &quot;redirectURL&quot;: &quot;&quot;,
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1
        },
        &quot;cache&quot;: {},
        &quot;timings&quot;: {
          &quot;blocked&quot;: -1,
          &quot;dns&quot;: -1,
          &quot;connect&quot;: -1,
          &quot;send&quot;: 0,
          &quot;wait&quot;: 0,
          &quot;receive&quot;: 0,
          &quot;ssl&quot;: -1
        },
        &quot;comment&quot;: &quot;/customers/{id}/addresses&quot;
      },
      {
        &quot;startedDateTime&quot;: &quot;2022-11-07T03:12:02.794Z&quot;,
        &quot;time&quot;: 0,
        &quot;request&quot;: {
          &quot;method&quot;: &quot;GET&quot;,
          &quot;url&quot;: &quot;http://localhost:8080/api/v1/customers/a1b9b31d-e73c-4112-af7c-b68530f38222/cards&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Accept&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;If-None-Match&quot;,
              &quot;value&quot;: &quot;098e97de3b61db55286f5f2812785116f&quot;
            }
          ],
          &quot;queryString&quot;: [],
          &quot;postData&quot;: {
            &quot;mimeType&quot;: &quot;&quot;,
            &quot;text&quot;: &quot;&quot;,
            &quot;params&quot;: []
          },
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1,
          &quot;settingEncodeUrl&quot;: true
        },
        &quot;response&quot;: {
          &quot;status&quot;: 0,
          &quot;statusText&quot;: &quot;&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [],
          &quot;content&quot;: {
            &quot;size&quot;: 0,
            &quot;mimeType&quot;: &quot;&quot;
          },
          &quot;redirectURL&quot;: &quot;&quot;,
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1
        },
        &quot;cache&quot;: {},
        &quot;timings&quot;: {
          &quot;blocked&quot;: -1,
          &quot;dns&quot;: -1,
          &quot;connect&quot;: -1,
          &quot;send&quot;: 0,
          &quot;wait&quot;: 0,
          &quot;receive&quot;: 0,
          &quot;ssl&quot;: -1
        },
        &quot;comment&quot;: &quot;/customers/{id}/cards&quot;
      },
      {
        &quot;startedDateTime&quot;: &quot;2022-11-07T03:12:02.794Z&quot;,
        &quot;time&quot;: 21.412,
        &quot;request&quot;: {
          &quot;method&quot;: &quot;GET&quot;,
          &quot;url&quot;: &quot;http://localhost:8080/api/v1/shipping/a1b9b31d-e73c-4112-af7c-b68530f38222&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Accept&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;If-None-Match&quot;,
              &quot;value&quot;: &quot;098e97de3b61db55286f5f2812785116f&quot;
            }
          ],
          &quot;queryString&quot;: [],
          &quot;postData&quot;: {
            &quot;mimeType&quot;: &quot;&quot;,
            &quot;text&quot;: &quot;&quot;,
            &quot;params&quot;: []
          },
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1,
          &quot;settingEncodeUrl&quot;: true
        },
        &quot;response&quot;: {
          &quot;status&quot;: 200,
          &quot;statusText&quot;: &quot;&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;ETag&quot;,
              &quot;value&quot;: &quot;\&quot;0d751713988987e9331980363e24189ce\&quot;&quot;
            },
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Content-Length&quot;,
              &quot;value&quot;: &quot;2&quot;
            },
            {
              &quot;name&quot;: &quot;Date&quot;,
              &quot;value&quot;: &quot;Mon, 07 Nov 2022 03:08:14 GMT&quot;
            }
          ],
          &quot;content&quot;: {
            &quot;size&quot;: 2,
            &quot;mimeType&quot;: &quot;application/json&quot;,
            &quot;text&quot;: &quot;[]&quot;
          },
          &quot;redirectURL&quot;: &quot;&quot;,
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1
        },
        &quot;cache&quot;: {},
        &quot;timings&quot;: {
          &quot;blocked&quot;: -1,
          &quot;dns&quot;: -1,
          &quot;connect&quot;: -1,
          &quot;send&quot;: 0,
          &quot;wait&quot;: 21.412,
          &quot;receive&quot;: 0,
          &quot;ssl&quot;: -1
        },
        &quot;comment&quot;: &quot;/shipping&quot;
      },
      {
        &quot;startedDateTime&quot;: &quot;2022-11-07T03:12:02.794Z&quot;,
        &quot;time&quot;: 92.538,
        &quot;request&quot;: {
          &quot;method&quot;: &quot;GET&quot;,
          &quot;url&quot;: &quot;http://localhost:8080/api/v1/orders/0a59ba9f-629e-4445-8129-b9bce1985d6a&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Accept&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;If-None-Match&quot;,
              &quot;value&quot;: &quot;098e97de3b61db55286f5f2812785116f&quot;
            }
          ],
          &quot;queryString&quot;: [],
          &quot;postData&quot;: {
            &quot;mimeType&quot;: &quot;&quot;,
            &quot;text&quot;: &quot;&quot;,
            &quot;params&quot;: []
          },
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1,
          &quot;settingEncodeUrl&quot;: true
        },
        &quot;response&quot;: {
          &quot;status&quot;: 200,
          &quot;statusText&quot;: &quot;&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;ETag&quot;,
              &quot;value&quot;: &quot;\&quot;0a01812eca885d252956ce2f2570d6a67\&quot;&quot;
            },
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Content-Length&quot;,
              &quot;value&quot;: &quot;1768&quot;
            },
            {
              &quot;name&quot;: &quot;Date&quot;,
              &quot;value&quot;: &quot;Mon, 07 Nov 2022 03:08:19 GMT&quot;
            }
          ],
          &quot;content&quot;: {
            &quot;size&quot;: 1768,
            &quot;mimeType&quot;: &quot;application/json&quot;,
            &quot;text&quot;: &quot;{\&quot;_links\&quot;:{\&quot;self\&quot;:[{\&quot;href\&quot;:\&quot;http://localhost:8080/0a59ba9f-629e-4445-8129-b9bce1985d6a\&quot;},{\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/orders/0a59ba9f-629e-4445-8129-b9bce1985d6a\&quot;}]},\&quot;id\&quot;:\&quot;0a59ba9f-629e-4445-8129-b9bce1985d6a\&quot;,\&quot;customer\&quot;:{\&quot;_links\&quot;:{\&quot;self\&quot;:[{\&quot;href\&quot;:\&quot;http://localhost:8080/a1b9b31d-e73c-4112-af7c-b68530f38222\&quot;},{\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/customers/a1b9b31d-e73c-4112-af7c-b68530f38222\&quot;}],\&quot;customers\&quot;:{\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/customers\&quot;},\&quot;self_addresses\&quot;:{\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/customers/a1b9b31d-e73c-4112-af7c-b68530f38222/addresses\&quot;}},\&quot;id\&quot;:\&quot;a1b9b31d-e73c-4112-af7c-b68530f38222\&quot;,\&quot;username\&quot;:\&quot;test\&quot;,\&quot;firstName\&quot;:\&quot;Test\&quot;,\&quot;lastName\&quot;:\&quot;User\&quot;,\&quot;email\&quot;:\&quot;test@user.com\&quot;,\&quot;password\&quot;:\&quot;pwd\&quot;,\&quot;phone\&quot;:\&quot;234234234\&quot;,\&quot;userStatus\&quot;:\&quot;ACTIVE\&quot;},\&quot;address\&quot;:{\&quot;_links\&quot;:{\&quot;self\&quot;:[{\&quot;href\&quot;:\&quot;http://localhost:8080/a731fda1-aaad-42ea-bdbc-a27eeebe2cc0\&quot;},{\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/addresses/a731fda1-aaad-42ea-bdbc-a27eeebe2cc0\&quot;}]},\&quot;id\&quot;:\&quot;a731fda1-aaad-42ea-bdbc-a27eeebe2cc0\&quot;,\&quot;number\&quot;:\&quot;9I-999\&quot;,\&quot;residency\&quot;:\&quot;Fraser Suites Le Claridge\&quot;,\&quot;street\&quot;:\&quot;Champs-Elysees\&quot;,\&quot;city\&quot;:\&quot;Paris\&quot;,\&quot;state\&quot;:\&quot;Île-de-France\&quot;,\&quot;country\&quot;:\&quot;France\&quot;,\&quot;pincode\&quot;:\&quot;75008\&quot;},\&quot;card\&quot;:{\&quot;_links\&quot;:{\&quot;self\&quot;:[{\&quot;href\&quot;:\&quot;http://localhost:8080/618ffaff-cbcd-48d4-8848-a15601e6725b\&quot;},{\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/cards/618ffaff-cbcd-48d4-8848-a15601e6725b\&quot;}]},\&quot;id\&quot;:\&quot;618ffaff-cbcd-48d4-8848-a15601e6725b\&quot;,\&quot;cardNumber\&quot;:\&quot;999-999-999-999\&quot;,\&quot;expires\&quot;:\&quot;12/28\&quot;,\&quot;cvv\&quot;:\&quot;0000\&quot;,\&quot;userId\&quot;:\&quot;a1b9b31d-e73c-4112-af7c-b68530f38222\&quot;},\&quot;date\&quot;:\&quot;2022-11-07T03:05:11.042815Z\&quot;,\&quot;items\&quot;:[{\&quot;id\&quot;:\&quot;6d62d909-f957-430e-8689-b5129c0bb75e\&quot;,\&quot;quantity\&quot;:1,\&quot;unitPrice\&quot;:17.1500},{\&quot;id\&quot;:\&quot;3395a42e-2d88-40de-b95f-e00e1502085b\&quot;,\&quot;quantity\&quot;:1,\&quot;unitPrice\&quot;:20.9900}],\&quot;total\&quot;:38.1400,\&quot;payment\&quot;:null,\&quot;shipment\&quot;:null,\&quot;status\&quot;:\&quot;CREATED\&quot;}&quot;
          },
          &quot;redirectURL&quot;: &quot;&quot;,
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1
        },
        &quot;cache&quot;: {},
        &quot;timings&quot;: {
          &quot;blocked&quot;: -1,
          &quot;dns&quot;: -1,
          &quot;connect&quot;: -1,
          &quot;send&quot;: 0,
          &quot;wait&quot;: 92.538,
          &quot;receive&quot;: 0,
          &quot;ssl&quot;: -1
        },
        &quot;comment&quot;: &quot;/orders/{id}&quot;
      },
      {
        &quot;startedDateTime&quot;: &quot;2022-11-07T03:12:02.794Z&quot;,
        &quot;time&quot;: 25.038,
        &quot;request&quot;: {
          &quot;method&quot;: &quot;GET&quot;,
          &quot;url&quot;: &quot;http://localhost:8080/api/v1/orders?customerId=a1b9b31d-e73c-4112-af7c-b68530f38222&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Accept&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;If-None-Match&quot;,
              &quot;value&quot;: &quot;098e97de3b61db55286f5f2812785116f&quot;
            }
          ],
          &quot;queryString&quot;: [],
          &quot;postData&quot;: {
            &quot;mimeType&quot;: &quot;&quot;,
            &quot;text&quot;: &quot;&quot;,
            &quot;params&quot;: []
          },
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1,
          &quot;settingEncodeUrl&quot;: true
        },
        &quot;response&quot;: {
          &quot;status&quot;: 200,
          &quot;statusText&quot;: &quot;&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;ETag&quot;,
              &quot;value&quot;: &quot;\&quot;03173b9bc8ce26ecd1264aba6bf357855\&quot;&quot;
            },
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Content-Length&quot;,
              &quot;value&quot;: &quot;1868&quot;
            },
            {
              &quot;name&quot;: &quot;Date&quot;,
              &quot;value&quot;: &quot;Mon, 07 Nov 2022 03:08:26 GMT&quot;
            }
          ],
          &quot;content&quot;: {
            &quot;size&quot;: 1868,
            &quot;mimeType&quot;: &quot;application/json&quot;,
            &quot;text&quot;: &quot;[{\&quot;links\&quot;:[{\&quot;rel\&quot;:\&quot;self\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/0a59ba9f-629e-4445-8129-b9bce1985d6a\&quot;},{\&quot;rel\&quot;:\&quot;self\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/orders/0a59ba9f-629e-4445-8129-b9bce1985d6a\&quot;}],\&quot;id\&quot;:\&quot;0a59ba9f-629e-4445-8129-b9bce1985d6a\&quot;,\&quot;customer\&quot;:{\&quot;links\&quot;:[{\&quot;rel\&quot;:\&quot;self\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/a1b9b31d-e73c-4112-af7c-b68530f38222\&quot;},{\&quot;rel\&quot;:\&quot;self\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/customers/a1b9b31d-e73c-4112-af7c-b68530f38222\&quot;},{\&quot;rel\&quot;:\&quot;customers\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/customers\&quot;},{\&quot;rel\&quot;:\&quot;self_addresses\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/customers/a1b9b31d-e73c-4112-af7c-b68530f38222/addresses\&quot;}],\&quot;id\&quot;:\&quot;a1b9b31d-e73c-4112-af7c-b68530f38222\&quot;,\&quot;username\&quot;:\&quot;test\&quot;,\&quot;firstName\&quot;:\&quot;Test\&quot;,\&quot;lastName\&quot;:\&quot;User\&quot;,\&quot;email\&quot;:\&quot;test@user.com\&quot;,\&quot;password\&quot;:\&quot;pwd\&quot;,\&quot;phone\&quot;:\&quot;234234234\&quot;,\&quot;userStatus\&quot;:\&quot;ACTIVE\&quot;},\&quot;address\&quot;:{\&quot;links\&quot;:[{\&quot;rel\&quot;:\&quot;self\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/a731fda1-aaad-42ea-bdbc-a27eeebe2cc0\&quot;},{\&quot;rel\&quot;:\&quot;self\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/addresses/a731fda1-aaad-42ea-bdbc-a27eeebe2cc0\&quot;}],\&quot;id\&quot;:\&quot;a731fda1-aaad-42ea-bdbc-a27eeebe2cc0\&quot;,\&quot;number\&quot;:\&quot;9I-999\&quot;,\&quot;residency\&quot;:\&quot;Fraser Suites Le Claridge\&quot;,\&quot;street\&quot;:\&quot;Champs-Elysees\&quot;,\&quot;city\&quot;:\&quot;Paris\&quot;,\&quot;state\&quot;:\&quot;Île-de-France\&quot;,\&quot;country\&quot;:\&quot;France\&quot;,\&quot;pincode\&quot;:\&quot;75008\&quot;},\&quot;card\&quot;:{\&quot;links\&quot;:[{\&quot;rel\&quot;:\&quot;self\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/618ffaff-cbcd-48d4-8848-a15601e6725b\&quot;},{\&quot;rel\&quot;:\&quot;self\&quot;,\&quot;href\&quot;:\&quot;http://localhost:8080/api/v1/cards/618ffaff-cbcd-48d4-8848-a15601e6725b\&quot;}],\&quot;id\&quot;:\&quot;618ffaff-cbcd-48d4-8848-a15601e6725b\&quot;,\&quot;cardNumber\&quot;:\&quot;999-999-999-999\&quot;,\&quot;expires\&quot;:\&quot;12/28\&quot;,\&quot;cvv\&quot;:\&quot;0000\&quot;,\&quot;userId\&quot;:\&quot;a1b9b31d-e73c-4112-af7c-b68530f38222\&quot;},\&quot;date\&quot;:\&quot;2022-11-07T03:05:11.042815Z\&quot;,\&quot;items\&quot;:[{\&quot;links\&quot;:[],\&quot;id\&quot;:\&quot;6d62d909-f957-430e-8689-b5129c0bb75e\&quot;,\&quot;quantity\&quot;:1,\&quot;unitPrice\&quot;:17.1500},{\&quot;links\&quot;:[],\&quot;id\&quot;:\&quot;3395a42e-2d88-40de-b95f-e00e1502085b\&quot;,\&quot;quantity\&quot;:1,\&quot;unitPrice\&quot;:20.9900}],\&quot;total\&quot;:38.1400,\&quot;payment\&quot;:null,\&quot;shipment\&quot;:null,\&quot;status\&quot;:\&quot;CREATED\&quot;}]&quot;
          },
          &quot;redirectURL&quot;: &quot;&quot;,
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1
        },
        &quot;cache&quot;: {},
        &quot;timings&quot;: {
          &quot;blocked&quot;: -1,
          &quot;dns&quot;: -1,
          &quot;connect&quot;: -1,
          &quot;send&quot;: 0,
          &quot;wait&quot;: 25.038,
          &quot;receive&quot;: 0,
          &quot;ssl&quot;: -1
        },
        &quot;comment&quot;: &quot;/orders - get order by customer Id (queryparam)&quot;
      },
      {
        &quot;startedDateTime&quot;: &quot;2022-11-07T03:12:02.794Z&quot;,
        &quot;time&quot;: 0,
        &quot;request&quot;: {
          &quot;method&quot;: &quot;POST&quot;,
          &quot;url&quot;: &quot;http://localhost:8080/api/v1/orders&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [
            {
              &quot;name&quot;: &quot;Content-Type&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;Accept&quot;,
              &quot;value&quot;: &quot;application/json&quot;
            },
            {
              &quot;name&quot;: &quot;If-None-Match&quot;,
              &quot;value&quot;: &quot;098e97de3b61db55286f5f2812785116f&quot;
            }
          ],
          &quot;queryString&quot;: [],
          &quot;postData&quot;: {
            &quot;mimeType&quot;: &quot;application/json&quot;,
            &quot;text&quot;: &quot;{\r\n    \&quot;customerId\&quot;: \&quot;a1b9b31d-e73c-4112-af7c-b68530f38222\&quot;,\r\n    \&quot;address\&quot;: {\r\n        \&quot;id\&quot;: \&quot;a731fda1-aaad-42ea-bdbc-a27eeebe2cc0\&quot;\r\n    },\r\n    \&quot;card\&quot;: {\r\n        \&quot;id\&quot;: \&quot;618ffaff-cbcd-48d4-8848-a15601e6725b\&quot;\r\n    }\r\n}&quot;,
            &quot;params&quot;: []
          },
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1,
          &quot;settingEncodeUrl&quot;: true
        },
        &quot;response&quot;: {
          &quot;status&quot;: 0,
          &quot;statusText&quot;: &quot;&quot;,
          &quot;httpVersion&quot;: &quot;HTTP/1.1&quot;,
          &quot;cookies&quot;: [],
          &quot;headers&quot;: [],
          &quot;content&quot;: {
            &quot;size&quot;: 0,
            &quot;mimeType&quot;: &quot;&quot;
          },
          &quot;redirectURL&quot;: &quot;&quot;,
          &quot;headersSize&quot;: -1,
          &quot;bodySize&quot;: -1
        },
        &quot;cache&quot;: {},
        &quot;timings&quot;: {
          &quot;blocked&quot;: -1,
          &quot;dns&quot;: -1,
          &quot;connect&quot;: -1,
          &quot;send&quot;: 0,
          &quot;wait&quot;: 0,
          &quot;receive&quot;: 0,
          &quot;ssl&quot;: -1
        },
        &quot;comment&quot;: &quot;/orders&quot;
      }
    ]
  }
}

</div><p id="-c0nkc2_575">Postman에서 har 파일을 import 하면 아래와 같이 API 호출을 할 수 있습니다. <figure id="-c0nkc2_576"><img alt="postman.png" src="images/postman.png" title="postman.png" width="1921" height="1055"></figure></p></section><div class="last-modified">Last modified: 20 6월 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="chapter03.html" class="navigation-links__prev">Chapter 3 - API 명세 및 구현</a><a href="chapter05.html" class="navigation-links__next">Chapter 5 - 비동기 API 디자인 (필수 아님)</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b267/app.js"></script></body></html>